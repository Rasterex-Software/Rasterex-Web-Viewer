!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("UIExtension"),require("UIExtension").PDFViewCtrl.commons,require("UIExtension").__ui_lib__):"function"==typeof define&&define.amd?define(["UIExtension",["UIExtension","PDFViewCtrl","commons"],["UIExtension","__ui_lib__"]],t):"object"==typeof exports?exports.XFAUIXAddon=t(require("UIExtension"),require("UIExtension").PDFViewCtrl.commons,require("UIExtension").__ui_lib__):e.XFAUIXAddon=t(e.UIExtension,e.UIExtension.PDFViewCtrl.commons,e.UIExtension.__ui_lib__)}(self,((e,t,n)=>(()=>{var r={594:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return'<contextmenu>\r\n<contextmenu-item name="fv--xfa-signature-contextmenu-sign" @controller="xfa:SignController">signDocument.sign</contextmenu-item>\r\n<contextmenu-separator></contextmenu-separator>\r\n<contextmenu-item name="fv--xfa-signature-contextmenu-show-properties" @controller="xfa:ShowPropertiesController">signDocument.showSignProperty</contextmenu-item>\r\n</contextmenu>','<contextmenu>\r\n<contextmenu-item name="fv--xfa-signature-contextmenu-sign" @controller="xfa:SignController">signDocument.sign</contextmenu-item>\r\n<contextmenu-separator></contextmenu-separator>\r\n<contextmenu-item name="fv--xfa-signature-contextmenu-show-properties" @controller="xfa:ShowPropertiesController">signDocument.showSignProperty</contextmenu-item>\r\n</contextmenu>'}},971:e=>{e.exports=null},585:(e,t,n)=>{"use strict";
/*! art-template@runtime | https://github.com/aui/art-template */var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},i=Object.create(r),o=/["&'<>]/;function a(e){return"string"!=typeof e&&(e=null==e?"":"function"==typeof e?a(e.call(e)):JSON.stringify(e)),e}i.$escape=function(e){return function(e){var t=""+e,n=o.exec(t);if(!n)return e;var r="",i=void 0,a=void 0,s=void 0;for(i=n.index,a=0;i<t.length;i++){switch(t.charCodeAt(i)){case 34:s="&#34;";break;case 38:s="&#38;";break;case 39:s="&#39;";break;case 60:s="&#60;";break;case 62:s="&#62;";break;default:continue}a!==i&&(r+=t.substring(a,i)),a=i+1,r+=s}return a!==i?r+t.substring(a,i):r}(a(e))},i.$each=function(e,t){if(Array.isArray(e))for(var n=0,r=e.length;n<r;n++)t(e[n],n);else for(var i in e)t(e[i],i)},e.exports=i},779:(e,t,n)=>{"use strict";e.exports=n(585)},616:t=>{"use strict";t.exports=e},732:e=>{"use strict";e.exports=t},399:e=>{"use strict";e.exports=n}},i={};function o(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return r[e](n,n.exports,o),n.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var a={};return(()=>{"use strict";function e(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(i,o){var a=t.apply(n,r);function s(t){e(a,i,o,s,c,"next",t)}function c(t){e(a,i,o,s,c,"throw",t)}s(void 0)}))}}function n(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):n(e,t)}function r(e,t){if(!n(e,t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?g(e):t;var n}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v(this,n)}}o.d(a,{default:()=>_e});function y(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;var b=o(616),x=(b.PDFUI,b.UIXAddon),w=(b.SeniorComponentFactory,b.modular),k=(b.ServiceScope,b.Directive,b.Controller,b.Component,b.ContainerComponent,b.UIEvents),C=b.vendors.Hammer,E=b.PDFViewCtrl,S=(E.PDFViewer,E.ViewerEvents,E.DeviceInfo,E.BrowserInfo,E.shared),D=(S.Disposable,S.Store,S.ValueStore,S.debounce,S.observeResize,S.throttle,S.Draggable,S.browser,S.DebounceAsyncTaskExecutor,S.ThrottleAsyncTaskExecutor,S.QueuedAsyncTaskExecutor,S.BuiltinIntersectionObserver,S.download,E.Log.LoggerFactory,1),I=2,A=4,P=5,T=6,U=13,R=1,F=1,M=2,O=4,_=8,N=0,j=1,L=2,B=3,V=4,W=0,X=1,H="xfa-press-widget-point",q="show-signature-dialog",$="show-signature-property-dialog",K=o(971),z=o.n(K);function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var G=o(732);!function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(r(this,e),"function"==typeof t.transformRect){var c=t;t=c.a,n=c.b,i=c.c,o=c.d,a=c.e,s=c.f}else if(Array.isArray(t)){var u=t;t=u[0],n=u[1],i=u[2],o=u[3],a=u[4],s=u[5]}this.a=t,this.b=n,this.c=i,this.d=o,this.e=a,this.f=s}s(e,[{key:"set",value:function(e,t,n,r,i,o){this.a=e,this.b=t,this.c=n,this.d=r,this.e=i,this.f=o}},{key:"reset",value:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}},{key:"reverse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=t.a*t.d-t.b*t.c;if(0==n)return t;var r=-n;return new e(t.d/n,t.b/r,t.c/r,t.a/n,(t.c*t.f-t.d*t.e)/n,(t.a*t.f-t.b*t.e)/r)}},{key:"setReverse",value:function(e){var t=this.reverse(e);this.set(t.a,t.b,t.c,t.d,t.e,t.f)}},{key:"rotate",value:function(t,n){var r,i=Math.cos(t),o=Math.sin(t),a=new e(i,o,-o,i,0,0);r=n?e.Concat2mt(a,this):e.Concat2mt(this,a),this.set(r.a,r.b,r.c,r.d,r.e,r.f)}},{key:"rotateAt",value:function(e,t,n,r){this.translate(e,t,r),this.rotate(n,r),this.translate(-e,-t,r)}},{key:"translate",value:function(e,t,n){n?(this.e+=e*this.a+t*this.c,this.f+=t*this.d+e*this.b):(this.e+=e,this.f+=t)}},{key:"concat",value:function(t,r,i,o,a,s,c){var u,d;n(t,e)?(u=t,c=r):u=new e(t,r,i,o,a,s),d=c?e.Concat2mt(u,this):e.Concat2mt(this,u),this.set(d.a,d.b,d.c,d.d,d.e,d.f)}},{key:"is90Rotated",value:function(){var e=1e3*this.a;e<0&&(e*=-1);var t=1e3*this.d;t<0&&(t*=-1);var n=this.b;n<0&&(n*=-1);var r=this.c;return r<0&&(r*=-1),e<n&&t<r}},{key:"isScaled",value:function(){var e=1e3*this.b;e<0&&(e*=-1);var t=1e3*this.c;t<0&&(t*=-1);var n=this.a;n<0&&(n*=-1);var r=this.d;return r<0&&(r*=-1),e<n&&t<r}},{key:"getA",value:function(){return this.a}},{key:"getB",value:function(){return this.b}},{key:"getC",value:function(){return this.c}},{key:"getD",value:function(){return this.d}},{key:"getE",value:function(){return this.e}},{key:"getF",value:function(){return this.f}},{key:"scale",value:function(e,t,n){this.a*=e,this.d*=t,n?(this.b*=e,this.c*=t):(this.b*=t,this.c*=e,this.e*=e,this.f*=t)}},{key:"transformXDistance",value:function(e){var t=this.a*e,n=this.b*e;return Math.sqrt(t*t+n*n)}},{key:"transformYDistance",value:function(e){var t=this.c*e,n=this.d*e;return Math.sqrt(t*t+n*n)}},{key:"transformDistance",value:function(e,t){var n=this.a*e+this.c*t,r=this.b*e+this.d*t;return Math.sqrt(n*n+r*r)}},{key:"transformPoint",value:function(e,t){return[this.a*e+this.c*t+this.e,this.b*e+this.d*t+this.f]}},{key:"transformRect",value:function(e,t,n,r){for(var i,o=[e,e,n,n],a=[t,r,t,r],s=0;s<4;s++)i=this.transformPoint(o[s],a[s]),o[s]=i[0],a[s]=i[1];for(var c=[o[0],o[0],a[0],a[0]],u=1;u<4;u++)c[0]>o[u]&&(c[0]=o[u]),c[1]<o[u]&&(c[1]=o[u]),c[2]>a[u]&&(c[2]=a[u]),c[3]<a[u]&&(c[3]=a[u]);return[c[0],c[2],c[1],c[3]]}},{key:"getXUnit",value:function(){var e=this.a,t=this.b;return 0===t?Math.abs(e):0===e?Math.abs(t):Math.sqrt(e*e+t*t)}},{key:"getYUnit",value:function(){var e=this.c,t=this.d;return 0===e?Math.abs(t):0===t?Math.abs(e):Math.sqrt(e*e+t*t)}},{key:"getUnitRect",value:function(){return this.transformRect(0,0,1,1)}},{key:"matchRect",value:function(e,t){var n=t[0]-t[2];this.a=Math.abs(n)<.001?1:(e[0]-e[2])/n,n=t[3]-t[1],this.d=Math.abs(n)<.001?1:(e[3]-e[1])/n,this.e=e[0]-t[0]*this.a,this.f=e[3]-t[3]*this.d,this.b=0,this.c=0}},{key:"getAngle",value:function(){return Math.atan2(this.b,this.a)}},{key:"toArray",value:function(){return[this.a,this.b,this.c,this.d,this.e,this.f]}}],[{key:"Concat2mt",value:function(t,n){return new e(t.a*n.a+t.b*n.c,t.a*n.b+t.b*n.d,t.c*n.a+t.d*n.c,t.c*n.b+t.d*n.d,t.e*n.a+t.f*n.c+n.e,t.e*n.b+t.f*n.d+n.f)}}])}();var J,Q=function(){function e(t){r(this,e),Y(this,"values",void 0),Y(this,"cols",void 0),(0,G.assertThat)(Array.isArray(t),"Illegal Matrix values, it should be an array! But actual: "+t),(0,G.assertThat)(16===t.length,"Incorrect matrix values size, it must be 16!"),this.values=t,this.cols=Math.sqrt(t.length)}return s(e,[{key:"multiVec4",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return[this.getAt(0,0)*e+this.getAt(0,1)*t+this.getAt(0,2)*n+this.getAt(0,3)*r,this.getAt(1,0)*e+this.getAt(1,1)*t+this.getAt(1,2)*n+this.getAt(1,3)*r,this.getAt(2,0)*e+this.getAt(2,1)*t+this.getAt(2,2)*n+this.getAt(2,3)*r,this.getAt(3,0)*e+this.getAt(3,1)*t+this.getAt(3,2)*n+this.getAt(3,3)*r]}},{key:"getAt",value:function(e,t){var n=e*this.cols+t;return(0,G.assertThat)(n<this.values.length,"Cannot access value at (".concat(e,",").concat(t,"), it out bound of this matrix!")),this.values[n]}}]),e}(),Z=(function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;r(this,e),Y(this,"a",void 0),Y(this,"b",void 0),Y(this,"c",void 0),Y(this,"d",void 0),this.a=t,this.b=n,this.c=i,this.d=o}s(e,[{key:"transform",value:function(t){var n=f(t.multiVec4(this.a,this.b,this.c,this.d),4);return new e(n[0],n[1],n[2],n[3])}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return this.transform(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return new Q([e,0,0,0,0,t,0,0,0,0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,0,0,0,0,1])}(e,t,n))}},{key:"rotateZ",value:function(e){return this.transform(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)/180*Math.PI,t=Math.cos(e),n=Math.sin(e);return new Q([t,n,0,0,-n,t,0,0,0,0,1,0,0,0,0,1])}(e))}},{key:"translate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.transform(function(e){return new Q([1,0,0,e,0,1,0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,0,0,1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,0,0,0,1])}(e,t,n))}}])}(),72);function ee(e){return function(){if(!J){var e=(0,G.getDPI)();J=[e.x,e.y]}return J}()[e]}function te(e){return e*ee(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)/Z}function ne(e){return e*Z/ee(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}function re(e,t){return ie.apply(this,arguments)}function ie(){return(ie=t((function(e,t){var n,r,i,o,a,s;return y(this,(function(c){switch(c.label){case 0:return n=t.getScale(),r=t.getRotation(),(i=t.page)?[3,2]:[4,t.getPDFPage()];case 1:i=c.sent(),c.label=2;case 2:return o=i.info,a=o.width,s=o.height,0===r||(90===r?e={left:s-e.bottom,top:e.left,right:s-e.top,bottom:e.right}:180===r?e={left:a-e.right,top:s-e.bottom,right:a-e.left,bottom:s-e.top}:270===r&&(e={left:e.top,top:a-e.right,right:e.bottom,bottom:a-e.left})),[2,{left:te(e.left)*n,top:te(e.top)*n,right:te(e.right)*n,bottom:te(e.bottom)*n}]}}))}))).apply(this,arguments)}function oe(e,t){return ae.apply(this,arguments)}function ae(){return(ae=t((function(e,t){var n,r,i,o,a,s,c;return y(this,(function(u){switch(u.label){case 0:return n=t.getScale(),r=t.getRotation(),(i=t.page)?[3,2]:[4,t.getPDFPage()];case 1:i=u.sent(),u.label=2;case 2:return o=i.info,a=o.width,s=o.height,c=[ne(e[0])/n,ne(e[1])/n],0===r?[2,c]:90===r?[2,[c[1],s-c[0]]]:180===r?[2,[a-c[0],s-c[1]]]:270===r?[2,[a-c[1],c[0]]]:[2]}}))}))).apply(this,arguments)}function se(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.x,e.clientY-n.y]}function ce(e){var t=0;return e.altKey&&(t|=O),e.ctrlKey&&(t|=M),e.shiftKey&&(t|=F),e.metaKey&&(t|=_),t}var ue={left:0,center:1,right:2},de=1,le=2,fe=3,he="editDiv",pe=function(){function e(){r(this,e)}return s(e,null,[{key:"formatHtmlStr",value:function(e){var t=e,n={split:"split",remove:"remove",removeSelf:"removeTag"};[{startStr:"\x3c!--StartFragment--\x3e",endStr:"\x3c!--EndFragment--\x3e",operate:n.split},{startStr:"\x3c!--[if",endStr:"<![endif]--\x3e",operate:n.remove},{startStr:"<![if",endStr:"<![endif]>",operate:n.remove},{startStr:"<o:p>",endStr:"</o:p>",operate:n.remove},{startStr:"<w:Sdt",endStr:"</w:Sdt>",operate:n.removeTag},{startStr:"<w:sdtPr>",endStr:"</w:sdtPr>",operate:n.remove}].forEach((function(e){for(var r=t.indexOf(e.startStr);r>-1;){switch(e.operate){case n.split:var i=t.indexOf(e.endStr);t=t.slice(r+e.startStr.length,i>-1?i:t.length);break;case n.remove:var o=t.indexOf(e.endStr),a=t.substring(0,r),s=t.substring(o+e.endStr.length);t=a+s;break;case n.removeTag:var c=t.substring(r),u=c.indexOf(">");t=(t=t.substring(0,r)+c.substring(u+1)).split(e.endStr).join("")}r=t.indexOf(e.startStr)}}));var r=document.createElement("div");return r.contentEditable=!0,r.id=he,r.style.display="none",document.body.appendChild(r),r.innerHTML=t.replaceAll("\n","").replaceAll("\r",""),this.addTagClassName(r)}},{key:"getFont",value:function(e){var t=e[0],n=new RegExp("^\\s*".concat(t,"\\b")),r=["-apple-system","system-ui"," BlinkMacSystemFont"," Segoe UI"," Roboto"," Oxygen"," Ubuntu"," Fira Sans"," Droid Sans"," Helvetica Neue"," sans-serif"].some((function(e){return n.test(e)}));return r?(G.DeviceInfo.isWindows?t="DengXian Light":G.DeviceInfo.isMacOS||G.DeviceInfo.isIOS?t="PingFangSC":G.DeviceInfo.isAndroid?t="Roboto":G.DeviceInfo.isLinux&&(t="Noto Sans"),t):t}},{key:"formatRichText",value:function(e){var t=this,n=this.formatHtmlStr(e),r=document.getElementById("".concat(he)),i=n.map((function(e){var n,i,o,a,s=r.getElementsByClassName("".concat(e))[0],c=getComputedStyle(s),u=c.fontFamily.replaceAll('"',"").split(","),d=t.getFont(u);return{content:s.textContent,richTextStyle:{font:{name:d},textSize:parseInt(c.fontSize),textAlignment:ue[c.textAlign],textColor:(0,G.colorConvertor)(c.color,"int"),isBold:(o=c.fontWeight,a=parseFloat(o),isNaN(a)?o.includes("bold"):a>400),isItalic:(i=c.fontStyle,i.includes("italic")||i.includes("oblique")),isUnderline:c.textDecoration.includes("underline"),isStrikethrough:c.textDecoration.includes("line-through"),cornerMarkStyle:(n=c.verticalAlign,{sub:fe,super:le}[n]||de)}}}));return r.remove(),i}},{key:"addTagClassName",value:function(e){var t=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=e.childNodes.length;(["block","flex"].includes(getComputedStyle(e).display)&&e.nextElementSibling&&(e.innerHTML+="\n"),i>0)&&Array.from(e.childNodes).forEach((function(i){if("#text"===i.nodeName){var o=document.createElement("span");o.innerHTML="".concat(i.textContent),o.style.textDecoration="".concat(n.underline?"underline":""," ").concat(n.lineThrough?"line-through":""),o.style.verticalAlign=n.verticalAlign;var a="foxitwebsdk-".concat(Date.now(),"-").concat(parseInt(1e3*Math.random()));r.push(a),o.classList.add(a),e.replaceChild(o,i)}else{var s=getComputedStyle(i).textDecoration,c={};s.includes("underline")&&(c.underline=!0),s.includes("line-through")&&(c.lineThrough=!0);var u=getComputedStyle(i).verticalAlign;["sub","super"].includes(u)&&(c.verticalAlign=u),t.addTagClassName(i,r,Object.assign({},n,c))}}));return r}}]),e}(),ge="fv__ui-xfa-input",ve=function(){function e(i,o,a){var s,c=this;r(this,e),Y(this,"pdfUI",void 0),Y(this,"pdfDoc",void 0),Y(this,"provider",void 0),Y(this,"pageIndex",void 0),Y(this,"dom",void 0),this.pdfUI=i,this.pdfDoc=o,this.provider=a,document.body.insertAdjacentHTML("beforeend","<input class='".concat(ge,"'/>")),this.dom=document.getElementsByClassName(ge)[0];var u=!1;this.dom.addEventListener("compositionstart",(function(e){u=!0})),this.dom.addEventListener("compositionend",(function(e){u=!1,c.pdfDoc.api.triggerXFAWidgetEvent(c.pdfDoc.id,c.pageIndex,{type:"OnChar",inputChar:e.data,keyCode:s,flags:ce(e)})})),this.dom.addEventListener("input",(function(e){u||"insertFromPaste"===e.inputType||c.pdfDoc.api.triggerXFAWidgetEvent(c.pdfDoc.id,c.pageIndex,{type:"OnChar",inputChar:e.data,flags:ce(e)})})),this.dom.addEventListener("paste",(function(e){!u&&n(e,ClipboardEvent)&&(0,G.getClipboardData)(e).then((function(t){if(t&&0!==t.length){var n="";if("string"===t[0].type)for(var r=0;r<t.length;r++)n+=t[r].value;else if("html"===t[0].type){var i=pe.formatRichText(t[0].value);if(0===i.length)return;for(var o=0;o<i.length;o++)n+=i[o].content}0!==n.length&&c.pdfDoc.api.triggerXFAWidgetEvent(c.pdfDoc.id,c.pageIndex,{type:"OnChar",inputChar:n,flags:ce(e)})}}))}));var d,l=this;this.dom.addEventListener("keydown",(d=t((function(e){var t;return y(this,(function(n){switch(n.label){case 0:return[4,l.pdfDoc.api.triggerXFAWidgetEvent(l.pdfDoc.id,l.pageIndex,{type:"OnKeyDown",keyCode:e.keyCode,flags:ce(e)})];case 1:return n.sent(),8!==e.keyCode&&13!==e.keyCode?[3,3]:(t=l.convertToFWLVitrualKeyCode(e.keyCode,!1),[4,l.pdfDoc.api.triggerXFAWidgetEvent(l.pdfDoc.id,l.pageIndex,{type:"OnChar",keyCode:t,flags:ce(e)})]);case 2:n.sent(),n.label=3;case 3:return s=e.keyCode,[2]}}))})),function(e){return d.apply(this,arguments)})),this.dom.addEventListener("keyup",(function(e){c.pdfDoc.api.triggerXFAWidgetEvent(c.pdfDoc.id,c.pageIndex,{type:"OnKeyUp",keyCode:e.keyCode,flags:ce(e)})}))}return s(e,[{key:"showAt",value:function(e,t){this.dom.style.cssText+="\n            z-index: 99999;\n            left: ".concat(e,"px;\n            top: ").concat(t,"px;\n        ")}},{key:"hide",value:function(){this.dom.style.cssText+="\n            z-index: -1;\n            left: unset;\n            top: unset;\n        "}},{key:"focus",value:function(e){var t=this,n=function(){t.pageIndex=e,t.dom.focus()};G.isHuaweiBrowser?setTimeout((function(){n()}),100):n()}},{key:"blur",value:function(){this.pageIndex=void 0,this.dom.blur()}},{key:"setValue",value:function(e){this.dom.value=e}},{key:"destroy",value:function(){this.dom.remove()}},{key:"hasFocus",value:function(){return document.activeElement===this.dom}},{key:"setEditable",value:function(e){this.dom.toggleAttribute("readonly",!e)}},{key:"convertToFWLVitrualKeyCode",value:function(e,t){if(t)return e;var n=e;switch(e){case 35:n=16777233;break;case 36:n=16777232;break;case 37:n=16777234;break;case 39:n=16777236;break;case 38:n=16777235;break;case 40:n=16777237;break;case 46:n=16777223}return n}}]),e}();const me={annotationUpdated:"annotation-updated",annotationIDUpdated:"annotation-id-updated",annotationAppearanceUpdated:"annotation-appearance-updated",annotationReplyAdd:"annotation-reply-add",annotationReplyAdded:"annotation-reply-add",annotationReviewStateAnnotAdd:"annotation-review-state-annot-add",annotationReviewStateAnnotAdded:"annotation-review-state-annot-add",annotationMarkedStateAnnotAdd:"annotation-marked-state-annot-add",annotationMarkedStateAnnotAdded:"annotation-marked-state-annot-add",annotationStatesCleared:"annotation-states-cleared",annotationRemoved:"annotation-removed",annotationMovedPosition:"annotation-moved-position",annotationPositionMoved:"annotation-moved-position",annotationOrderChanged:"annotation-order-changed",annotationAdded:"annotation-add",annotationAdd:"annotation-add",moveAnnotsToPages:"moveAnnotsToPages",annotationImported:"annotation-imported",annotationImportedEx:"annotation-imported-ex",annotationLoaded:"annotation-loaded",actionUpdated:"action-updated",actionAdd:"action-add",actionAdded:"action-add",actionRemove:"action-remove",actionRemoved:"action-remove",layerVisibleChange:"layer-visible-change",layerVisibleChanged:"layer-visible-change",layerRemoved:"layer-removed",layerMerged:"layer-merged",layerAdded:"layer-added",bookmarkAdded:"bookmark-added",structureBookmarkAdded:"structure-bookmark-added",bookmarkUpdated:"bookmark-updated",bookmarkRemoved:"bookmark-removed",stateAnnotNameUpdated:"state-annot-name-updated",pageInfoChange:"page-info-change",pageInfoChanged:"page-info-change",pageRotationChange:"page-rotation-change",beforePageRotationChanged:"before-page-rotation-changed",pageRotationChanged:"page-rotation-change",imageAdded:"image-added",watermarkAdded:"watermark-added",watermarkRemoved:"watermark-removed",graphicsUpdated:"graphics-updated",permissionChanged:"permission-changed",docPasswordChanged:"doc-password-changed",drmEncryptSuccess:"drm-encrypt-success",drmEncryptSucceeded:"drm-encrypt-success",drmEncryptFailed:"drm-encrypt-failed",removePwdAndPerm:"remove-password-and-permission",pwdAndPermRemoved:"remove-password-and-permission",securityTypeChanged:"security-type-changed",pageMoved:"page-moved",pageRemoved:"page-removed",pageAdded:"page-added",insertPages:"import-pages",pagesInserted:"import-pages",importPages:"import-pages",documentAttachmentAdd:"document-attachment-add",docAttachmentAdded:"document-attachment-add",documentAttachmentModify:"document-attachment-modify",docAttachmentModified:"document-attachment-modify",documentAttachmentRemove:"document-attachment-remove",docAttachmentRemoved:"document-attachment-remove",applyRedaction:"apply-redaction",redactionApplied:"apply-redaction",removeReviewState:"remove-review-state",reviewStateRemoved:"remove-review-state",removeMarkedState:"remove-marked-state",markedStateRemoved:"remove-marked-state",formValueChanged:"form-value-changed",metaDataChanged:"meta-data-changed",docModified:"doc-modified",flattened:"flattened",headerFooterUpdated:"headerFooterUpdated",headerFooterAdded:"headerFooterAdded",COChange:"COChange",COChanged:"COChange",pagesReversed:"pages-reversed",pagesMoved:"pages-moved",pagesRemoved:"pages-removed",pagesRotated:"pages-rotated",pageMeasureScaleRatioChanged:" page-measure-scale-ratio-changed",obtainsPageFromEngine:"obtains-page-from-engine",pagesBoxChange:"pages-box-changed",pagesBoxChanged:"pages-box-changed",pagesLabelChange:"pages-label-change",pagesLabelChanged:"pages-label-change",pagesLabelNeedUpdate:"pages-label-need-change",pagesLabelNeedUpdated:"pages-label-need-change",pagesReplace:"pages-replace",pagesReplaced:"pages-replace",recognitionForm:"recognition-form",removeEmbeddedPageThumbnail:"remove-embedded-page-thumbnail",embeddedPageThumbnailRemoved:"remove-embedded-page-thumbnail",objectStartEdit:"object-start-edit",objectEndEdit:"object-end-edit",objectSelectionChanged:"object-selection-changed",objectAdded:"object-added",objectPropertyChanged:"object-property-changed",objectContentChanged:"object-content-changed",paragraphContentChanged:"paragraph-text-changed",paragraphTextOnActivate:"paragraph-text-on-activate",paragraphTextOnDeactivate:"paragraph-text-on-deactivate",paragraphTextEnterEdit:"paragraph-text-enter-edit",paragraphTextExitEdit:"paragraph-text-exit-edit",paragraphTextOnChar:"paragraph-text-on-char",findSuccess:"find-success",replaceSuccess:"replace-success",replaceAllSuccess:"replace-all-success",articleThreadAdded:"article-thread-added",articleThreadUpdated:"article-thread-updated",articleThreadRemoved:"article-thread-removed",articleBeadAdded:"article-bead-added",articleBeadRemoved:"article-bead-removed",articleBeadUpdated:"article-bead-updated",articleEnterReadMode:"article-enter-read-mode",articleOutReadMode:"article-out-read-mode",invalidRect:"invalidRect",xfaContentChanged:"xfa-content-changed",formReloaded:"formReloaded",formFieldImported:"form-field-imported"};var ye;!function(e){e[e.Arc=3]="Arc",e[e.Barcode=0]="Barcode",e[e.CheckButton=2]="CheckButton",e[e.ChoiceList=7]="ChoiceList",e[e.DateTimeEdit=4]="DateTimeEdit",e[e.ExclGroup=15]="ExclGroup",e[e.Image=16]="Image",e[e.ImageEdit=8]="ImageEdit",e[e.Line=9]="Line",e[e.NumericEdit=5]="NumericEdit",e[e.PasswordEdit=10]="PasswordEdit",e[e.PushButton=1]="PushButton",e[e.RadioButton=11]="RadioButton",e[e.Rectangle=12]="Rectangle",e[e.Signature=6]="Signature",e[e.TextEdit=13]="TextEdit",e[e.Unknown=14]="Unknown"}(ye||(ye={}));var be=function(){function e(t){r(this,e),Y(this,"xfaWidget",void 0),Y(this,"verifiedResult",void 0),Y(this,"isXfaField",void 0),this.xfaWidget=t,this.isXfaField=!0}return s(e,[{key:"isSigned",value:function(){return this.xfaWidget.isSigned}},{key:"getByteRange",value:function(){return this.xfaWidget.byteRange}},{key:"getFilter",value:function(){return this.xfaWidget.filter}},{key:"getSubfilter",value:function(){return this.xfaWidget.subfilter}},{key:"getSigner",value:function(){return this.xfaWidget.signer}},{key:"getFullName",value:function(){return this.xfaWidget.fullName}},{key:"getIndex",value:function(){return this.xfaWidget.index}},{key:"getWidget",value:function(){return this.xfaWidget}},{key:"getSignInfo",value:function(){if(!this.isSigned())return Promise.resolve({});var e=this.xfaWidget,t=e.filter,n=e.subfilter,r=e.apFlag,i=e.signer,o=e.location,a=e.reason,s=e.DN,c=e.text,u=e.fieldName,d=e.signTime,l=e.contact;return{filter:t,subfilter:n,rect:e.rect,flag:r,signer:i,reason:a,email:l,distinguishName:s,location:o,textValue:c,fieldName:u,signTime:d}}}]),e}(),xe=b.vendors,we=xe.saveAs,ke=xe.jQuery,Ce=b.internals,Ee=Ce.SignaturePropertiesDialog,Se=Ce.SignVerifiedComponent,De=(Ce.SignVerifiedComponentForOnline,function(){function e(t,n,i){var o=this;r(this,e),Y(this,"pdfUI",void 0),Y(this,"pdfDoc",void 0),Y(this,"addon",void 0),Y(this,"workflow",void 0),Y(this,"displayCaretInterval",void 0),Y(this,"showCaret",!0),Y(this,"input",void 0),Y(this,"currFocus",void 0),Y(this,"throttleExecutor",void 0),Y(this,"notifyContentChanged",void 0),Y(this,"nIndexs",[]),Y(this,"verifySignatureMap",void 0),Y(this,"pressPoint",void 0),this.pdfUI=t,this.pdfDoc=n,this.addon=i,this.notifyContentChanged=!1,this.throttleExecutor=new G.ThrottleAsyncTaskExecutor(100,!0),this.workflow=function(e){o[e.type]&&o[e.type](e.msg)},n.api.registerWorkflow("xfa",this.workflow),this.input=new ve(this.pdfUI,this.pdfDoc,this);var a,s=function(){var e=t.i18n.t("xfa:gsdkStrings",{returnObjects:!0});n.api.setXFAString({path:"jr"},e)};s(),t.eventEmitter.on("languageChangeFinished",s),this.pdfUI.addDestroyHook(this.pdfUI.addViewerEventListener((Y(a={},H,(function(e){o.pressPoint=e})),Y(a,q,(function(e){e.isSigned?o.Verify(e):o.Sign(e)})),Y(a,$,(function(e){o.verifySignature(e.xfaWidget).then((function(e){o.loadSignedDialog(e)}))})),a)))}return s(e,[{key:"DisplayCaret",value:function(e){var n=this;return t((function(){var t,r,i,o,a,s,c,u,d,l,f;return y(this,(function(h){switch(h.label){case 0:return t=e.pageIndex,r=e.isVisible,i=e.rect,[4,n.pdfUI.getPDFPageRender(t)];case 1:return o=h.sent(),a=o.$handler[0],(s=a.getElementsByClassName("fv__ui-xfa-caret")[0])||(a.insertAdjacentHTML("beforeend","<div class='fv__ui-xfa-caret'></div>"),s=a.getElementsByClassName("fv__ui-xfa-caret")[0]),r?[4,re(i,o)]:[3,3];case 2:return c=h.sent(),u=a.getBoundingClientRect(),s.style.cssText="\n                display: unset;\n                left: ".concat(c.left/u.width*100,"%;\n                top: ").concat(c.top/u.height*100,"%;\n                width: ").concat((c.right-c.left)/u.width*100,"%;\n                height: ").concat((c.bottom-c.top)/u.height*100,"%;\n            "),n.input.focus(t),(G.isMobile||G.isTablet)&&(d=c.left+u.left,l=c.top+u.top,f=n.input,window.addEventListener("touchend",(function e(){setTimeout((function(){f.hide()}),500),window.removeEventListener("touchend",e,!0)}),!0),f.showAt(d,l)),n.displayCaretInterval?[2]:(n.displayCaretInterval=window.setInterval((function(){n.showCaret?s.style.cssText+=s.style.cssText.replace("display: unset;","display: none;"):s.style.cssText+=s.style.cssText.replace("display: none;","display: unset;"),n.showCaret=!n.showCaret}),500),[3,4]);case 3:s.style.cssText="",n.input.blur(),clearInterval(n.displayCaretInterval),n.displayCaretInterval=0,h.label=4;case 4:return[2]}}))}))()}},{key:"InvalidateRect",value:function(e){var n=this;return t((function(){var r;return y(this,(function(i){return r=e.pageIndex,e.rect,e.flag,n.nIndexs.includes(r)||n.nIndexs.push(r),n.throttleExecutor.exec(t((function(){return y(this,(function(e){switch(e.label){case 0:return[4,n.pdfUI.getPDFViewer()];case 1:return e.sent().redraw(1,0),n.notifyContentChanged&&(n.nIndexs.forEach((r=t((function(e){return y(this,(function(t){return n.pdfDoc.engine.eventEmitter.emit(me.xfaContentChanged,e),[2]}))})),function(e){return r.apply(this,arguments)})),n.notifyContentChanged=!1,n.nIndexs=[]),[2]}var r}))}))),[2]}))}))()}},{key:"SetFocus",value:function(e){var t=e.pageIndex,n=e.xfaWidget,r=e.bRelayout;if(this.currFocus=n,this.input.setValue(""),n)switch(n.type){case ye.NumericEdit:case ye.PasswordEdit:case ye.TextEdit:case ye.DateTimeEdit:case ye.Barcode:this.input.setEditable(!0);break;default:this.input.setEditable(!1)}else this.input.setEditable(!1);!r&&n&&this.goToPage({pageIndex:t,left:n.rect.left,top:n.rect.top,right:n.rect.right,bottom:n.rect.bottom})}},{key:"Sign",value:function(e){var t=this,n=e.pageIndex,r=e.xfaWidget;if(r){var i=r.fieldName,o=r.index;this.loadSignPropertyDialog().show(null,(function(e,r){return e&&t.signDocument(Object.assign({},e,{pageIndex:n,fieldName:i,widgetIndex:o}),r,t.pdfUI)}))}}},{key:"Verify",value:function(e){var t=this,n=e.xfaWidget;n&&this.verifySignature(n).then((function(e){t.loadVerifiedDialog().show(e)}))}},{key:"loadSignPropertyDialog",value:function(){return this.pdfUI.signPropertyDialog||(this.pdfUI.signPropertyDialog=new Ee(this.pdfUI)),this.pdfUI.signPropertyDialog}},{key:"verifySignature",value:function(e){var t=this,n=this.pdfUI,r=new be(e),i="".concat(r.getFullName(),"_").concat(r.getIndex()),o=this.verifySignatureMap&&this.verifySignatureMap.has(i)?this.verifySignatureMap.get(i):null,a=Promise.resolve(o);return o||(a=n.getCurrentPDFDoc().then((function(e){return e.verifySignature(r,(function(e,t,r,i){return n.verifyHandler(e,t,r).then((function(e){return e=1024&(e=+e)?4:8,i&&(e|=4&e?134217728:268435456),e}))}))}))),a.then((function(e){return t.verifySignatureMap||(t.verifySignatureMap=new Map),t.verifySignatureMap.set(i,e),r.verifiedResult=e,r}))}},{key:"loadVerifiedDialog",value:function(){return this.pdfUI.signVerifiedDialog||(this.pdfUI.signVerifiedDialog=new Se(this.pdfUI)),this.pdfUI.signVerifiedDialog}},{key:"loadSignedDialog",value:function(e){var t=this;this.pdfUI.signedPropertyDialog?this.pdfUI.showSignedPropertyDialog(e):this.pdfUI.getComponentByName("signed-property-dialog").then((function(n){t.pdfUI.showSignedPropertyDialog(e)}))}},{key:"signDocument",value:function(e,t,n){if(e){var r="";n.getCurrentPDFDoc().then((function(n){(r=n.getFileName()||"").length<1&&(r="untitled.pdf");var i=JSON.parse(JSON.stringify(e));return n.sign(i,e.sign,t)})).then((function(e){var t=n.customs,i=t.autoDownloadAfterSign,o=t.getSignedDocument;return(void 0===i||i)&&we(new Blob([e],{type:"application/octet-stream"}),r.replace(".pdf","_signed.pdf")),"function"==typeof o&&o(e),n.openPDFByFile(e,{fileName:r})}))}}},{key:"ShowMemu",value:function(e){var n=this;return t((function(){var t,r;return y(this,(function(i){switch(i.label){case 0:return t=n.pdfUI,e.xfaWidget?[4,n.getSignatureContextmenu(e)]:[3,2];case 1:return r=i.sent(),[3,4];case 2:return[4,t.getComponentByName("fv--page-contextmenu")];case 3:r=i.sent(),i.label=4;case 4:return[2,n.pressPoint&&r.showAt(n.pressPoint.x,n.pressPoint.y)]}}))}))()}},{key:"getSignatureContextmenu",value:function(e){var n=this;return t((function(){var t,r,i;return y(this,(function(o){switch(o.label){case 0:return t=n.pdfUI,r=e.xfaWidget,[4,t.getComponentByName("fv--xfa-signature-contextmenu")];case 1:return(i=o.sent()).setCurrentTarget(r),i.info=e,n.handleSignatureContextMenu(i),[2,i]}}))}))()}},{key:"handleSignatureContextMenu",value:function(e){var t=e.$container.$children;e.info.isSigned?t.forEach((function(e){return ke(e.element).show()})):t.forEach((function(e){var t=ke(e.element);"fv--xfa-signature-contextmenu-sign"==t.attr("name")?t.show():t.hide()}))}},{key:"goToPage",value:function(e){var n=this;return t((function(){var t,r,i,o,a,s,c,u,d,l,f,h,p,g,v,m,b,x,w,k,C,E;return y(this,(function(y){switch(y.label){case 0:return t=e.pageIndex,r=e.left,i=e.top,o=e.right,a=e.bottom,[4,n.pdfUI.getPDFPageRender(t)];case 1:return(s=y.sent())?(c=s.pdfViewer,u=function(e,t){var n=e.left>t.left?e.left:t.left,r=e.right<t.right?e.right:t.right,i=e.bottom<t.bottom?e.bottom:t.bottom,o=e.top>t.top?e.top:t.top;if(!(n>=r||i<=o))return{left:n,right:r,bottom:i,top:o}},d=function(e){var t,n;e.left>e.right&&(t=[e.right,e.left],e.left=t[0],e.right=t[1]);e.top<e.bottom&&(n=[e.bottom,e.top],e.top=n[0],e.bottom=n[1])},l=function(e){var t,n;e.left>e.right&&(t=[e.right,e.left],e.left=t[0],e.right=t[1]);e.top>e.bottom&&(n=[e.bottom,e.top],e.top=n[0],e.bottom=n[1])},d(f={left:r,top:i,right:o,bottom:a}),[4,re(f,s)]):[2];case 2:return h=y.sent(),l(h),p=Math.abs(h.right-h.left),g=Math.abs(h.bottom-h.top),v=s.$ui[0].getBoundingClientRect(),m=h.left+v.left,b=h.top+v.top,x={left:m,top:b,right:m+p,bottom:b+g},w=c.$ui[0].parentElement.getBoundingClientRect(),k={left:w.left,top:w.top,right:w.right,bottom:w.bottom},C=u(k,x),E=c.getPDFDocRender().getCurrentPageIndex(),!C&&E===t||C&&C.left===x.left&&C.top===x.top&&C.right===x.right&&C.bottom===x.bottom?[2]:(c.goToPage(t,h.top,h.left,!1),[2])}}))}))()}},{key:"SetChangeMark",value:function(){this.notifyContentChanged=!0,this.pdfDoc.setDocModified()}},{key:"Print",value:function(e){}},{key:"SubmitData",value:function(e){var t=e.target,n=e.format,r=(e.textEncoding,e.content);if(!!t&&["mailto:","ftp","file://"].some((function(e){return t.startsWith(e)}))){var i=this.pdfUI.i18n.t("ui_:dialog.actionDialog.selectAction.submit"),o=this.pdfUI.i18n.t("alert.browserRestriction-actionTriggered-websdk");this.pdfUI.alert({message:'"'.concat(i,'" ').concat(o),level:"warning"})}else{var a;switch(n){case N:case j:case L:case B:case V:a=r}var s=new XMLHttpRequest;s.open("GET",t),s.send(a),s.onloadend=function(){}}}},{key:"PageViewEvent",value:function(e){var n=this;return t((function(){var t,r,i;return y(this,(function(o){return t=e.pageIndex,r=e.pageViewEventType,i=e.pageJson,r===W?n.pdfDoc.insertXfaPage(i):r===X&&n.pdfDoc.removeXfaPage(t),[2]}))}))()}},{key:"WidgetEvent",value:function(e){return t((function(){return y(this,(function(e){return[2]}))}))()}},{key:"destroy",value:function(){this.pdfDoc.api.unregisterWorkflow("xfa",this.workflow),this.input.destroy(),this.verifySignatureMap&&this.verifySignatureMap.clear(),this.verifySignatureMap=null}}]),e}()),Ie=w.module("xfa",[]);function Ae(e,t,n){return Ae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n||e):i.value}},Ae(e,t,n||e)}var Pe=o(399),Te=b.vendors.jQuery,Ue=function(e){u(n,e);var t=m(n);function n(){var e;return r(this,n),Y(g(e=t.apply(this,arguments)),"pdfUI",void 0),e}return s(n,[{key:"mounted",value:function(){var e=this;Ae(p(n.prototype),"mounted",this).call(this),this.component.parent.on(Pe.COMPONENT_EVENTS.SHOWN,(function(){var t=e.component.parent.info.isSigned?"verifySign.verify":"signDocument.sign";Te(e.component.element).find(".fv__ui-button-text").html(e.pdfUI.i18n.t(t))}))}},{key:"handle",value:function(){var e=this.component.parent;this.pdfUI.eventEmitter.emit(q,e.info)}}],[{key:"getName",value:function(){return"SignController"}}]),n}(Pe.Controller);Ie.registerController(Ue);var Re=function(e){u(n,e);var t=m(n);function n(){var e;return r(this,n),Y(g(e=t.apply(this,arguments)),"pdfUI",void 0),e}return s(n,[{key:"handle",value:function(){var e=this.component.parent;this.pdfUI.eventEmitter.emit($,e.info)}}],[{key:"getName",value:function(){return"ShowPropertiesController"}}]),n}(Pe.Controller);Ie.registerController(Re);var Fe=o(594),Me=o.n(Fe);Ie.registerPreConfiguredComponent("contextmenu",{template:Me()()});var Oe=UIExtension.PDFViewCtrl.Consts.PDFDocPermission,_e=function(e){u(i,e);var n=m(i);function i(){var e;return r(this,i),(e=n.call(this)).pdfUI=null,e.pdfDoc=null,e.provider=null,e.destroyHooks=[],e.pageEvents={},e.mousemoveTimer=null,e.isCheckOnly=!1,e}return s(i,[{key:"init",value:function(e){var n=this;this.pdfUI=e;var r,i=this;e.getPDFDocRender().then((r=t((function(t){var n,r,o;return y(this,(function(a){switch(a.label){case 0:return t?(n=t.doc,i.pdfDoc=n,n.isDynamicXFA()?[4,i.isCheckOnlyDoc()]:[3,2]):[2];case 1:for(i.isCheckOnly=a.sent(),i.provider=new De(e,n,i),r=0;r<n.getPageCount();r++)(o=t.getPDFPageRender(r)).isRendered&&i.initPageEvent(o);a.label=2;case 2:return[2]}}))})),function(e){return r.apply(this,arguments)}));var o=this,a=this;this.destroyHooks.push(this.pdfUI.addViewerEventListener([k.openFileSuccess],function(){var n=t((function(t){return y(this,(function(n){switch(n.label){case 0:return o.pdfDoc=t,t.isDynamicXFA()?[4,o.isCheckOnlyDoc()]:[2];case 1:return o.isCheckOnly=n.sent(),o.provider=new De(e,t,o),[2]}}))}));return function(e){return n.apply(this,arguments)}}()),this.pdfUI.addViewerEventListener([k.willCloseDocument],(function(){n.pdfDoc.isDynamicXFA()&&(Object.entries(n.pageEvents).forEach((function(e){var t=f(e,2);t[0];t[1].destroy()})),n.pageEvents={},n.cleanMousemoveTimer(),n.provider.destroy(),n.provider=null,n.pdfDoc=null)})),this.pdfUI.addViewerEventListener([k.renderPageSuccess],function(){var e=t((function(e){var t;return y(this,(function(n){switch(n.label){case 0:return a.pdfDoc||(a.pdfDoc=e.doc),a.pdfDoc.isDynamicXFA()?(t=a.pageEvents[e.index])?t.handlerDom===e.$handler[0]?[3,2]:(t.destroy(),delete a.pageEvents[e.index],[4,a.initPageEvent(e)]):[3,3]:[2];case 1:n.sent(),n.label=2;case 2:return[3,5];case 3:return[4,a.initPageEvent(e)];case 4:n.sent(),n.label=5;case 5:return[2]}}))}));return function(t){return e.apply(this,arguments)}}()))}},{key:"initPageEvent",value:function(e){var n=this;return t((function(){var r,i,o,a,s,c,u,d,l;return y(this,(function(f){switch(f.label){case 0:return r=e.$handler[0],i=!1,(o=new C.Manager(r)).add(new C.Tap({event:"singletap"})),o.add(new C.Pan({threshold:1})),o.on("hammer.input",(p=t((function(t){var o,a,s;return y(this,(function(u){switch(u.label){case 0:return o=t.srcEvent.type,e.page?"pointerdown"!=o&&"pointerup"!=o?[3,5]:(a="pointerdown"==o?"OnLButtonDown":"OnLButtonUp",G.isTouchDevice?t.eventType!==C.INPUT_START?[3,2]:[4,c(t.srcEvent)]:[3,3]):[2];case 1:return u.sent(),i=!1,[3,3];case 2:if(i)return[2];u.label=3;case 3:return[4,oe(se(t.srcEvent,r),e)];case 4:return s=u.sent(),n.pdfDoc.api.triggerXFAWidgetEvent(n.pdfDoc.id,e.index,{type:a,point:s,flags:ce(t.srcEvent),permission:n.docPermission}),"pointerup"==o&&n.pdfUI.eventEmitter.emit("can-scroll",!0),[3,6];case 5:t.eventType===C.INPUT_MOVE&&t.srcEvent.target.getAttribute("class").includes("fv__ui-xfa")&&n.pdfUI.eventEmitter.emit("can-scroll",!1),u.label=6;case 6:return[2]}}))})),function(e){return p.apply(this,arguments)})),o.on("panend",(function(t){n.provider.currFocus&&n.provider.input.focus(e.index)})),a=function(){var o=t((function(t){var o,a;return y(this,(function(s){switch(s.label){case 0:return t.preventDefault(),t.stopPropagation(),i=!0,[4,oe(se(t,r),e)];case 1:return o=s.sent(),a={x:t.clientX,y:t.clientY},n.pdfUI.eventEmitter.emit(H,a),[4,n.pdfDoc.api.triggerXFAWidgetEvent(n.pdfDoc.id,e.index,{type:"Contextmenu",point:o,flags:ce(t),permission:n.docPermission})];case 2:return s.sent(),!G.isTouchDevice&&n.provider.currFocus?[2,n.provider.input.focus(e.index)]:[2]}}))}));return function(e){return o.apply(this,arguments)}}(),n.destroyHooks.push(n.pdfUI.addViewerEventListener([k.pressPage],(function(e){G.isTouchDevice&&(e.srcEvent.preventDefault(),e.srcEvent.stopPropagation(),a(e.srcEvent))}))),s=function(e){e.preventDefault(),e.stopPropagation()},r.addEventListener("contextmenu",a),r.addEventListener("touchstart",s),c=function(){var i=t((function(t,i){var o,a,s,c,u,d;return y(this,(function(l){switch(l.label){case 0:return clearTimeout(n.toolTipTimeout),n.hideTooltip(r),[4,oe(se(t,r),e)];case 1:return o=l.sent(),[4,n.pdfDoc.api.triggerXFAWidgetEvent(n.pdfDoc.id,e.index,{type:"OnMouseMove",point:o,flags:ce(t),permission:n.docPermission})];case 2:if(a=l.sent(),s="",a){if(c=a.hitTestArea,a.pageIndex,u=a.xfaWidget,d=a.isAccessOpen,s="default",c===R||i){if(n.pdfUI.eventEmitter.emit("can-scroll",!1),!n.isCheckOnly&&d)switch(u.type){case A:case P:case U:s="text";break;case D:case I:s="pointer"}u.type===T&&(s="pointer")}else n.pdfUI.eventEmitter.emit("can-scroll",!0);u.toolTip&&(n.toolTipTimeout=setTimeout((function(){n.showTooltip(t,u,r)}),1e3))}return r.style.cursor=s,[2]}}))}));return function(e,t){return i.apply(this,arguments)}}(),r.addEventListener("mousemove",(function(e){n.cleanMousemoveTimer(),n.mousemoveTimer=setTimeout((function(){var t;n.cleanMousemoveTimer(),c(e,null===(t=n.provider)||void 0===t?void 0:t.currFocus)}),10)})),u=function(){n.hideTooltip(r)},[4,n.pdfUI.getScrollWrap()];case 1:return d=f.sent(),(l=d.getScrollHost()).addEventListener("scroll",u),n.pageEvents[e.index]={handlerDom:r,destroy:function(){o.destroy(),r.removeEventListener("mousemove",c),r.removeEventListener("contextmenu",a),r.removeEventListener("touchstart",s),h(r.querySelectorAll('[class^="fv__ui-xfa-"]')).forEach((function(e){r.removeChild(e)})),l.removeEventListener("scroll",u)}},[2]}var p}))}))()}},{key:"checkPermission",value:function(){var e=this;return t((function(){return y(this,(function(t){switch(t.label){case 0:return[4,e.pdfUI.getPDFDocRender()];case 1:return[2,t.sent().getUserPermission().getValue()]}}))}))()}},{key:"isCheckOnlyDoc",value:function(){var e=this;return t((function(){var t;return y(this,(function(n){switch(n.label){case 0:return[4,e.checkPermission()];case 1:return t=n.sent(),e.docPermission=t,[2,!(t&Oe.AnnotForm||t&Oe.FillForm)]}}))}))()}},{key:"cleanMousemoveTimer",value:function(){this.mousemoveTimer&&(clearTimeout(this.mousemoveTimer),this.mousemoveTimer=null)}},{key:"showTooltip",value:function(e,t,n){var r=n.getElementsByClassName("fv__ui-xfa-tooltip")[0];r||(n.insertAdjacentHTML("beforeend","<div class='fv__ui-xfa-tooltip'></div>"),r=n.getElementsByClassName("fv__ui-xfa-tooltip")[0]),r.style.cssText="\n            display: unset;\n            left: ".concat(e.offsetX,"px;\n            top: ").concat(e.offsetY,"px;\n        "),r.innerText=t.toolTip}},{key:"hideTooltip",value:function(e){var t=e.getElementsByClassName("fv__ui-xfa-tooltip")[0];t&&(t.style.display="none")}},{key:"destroy",value:function(){this.destroyHooks.forEach((function(e){"function"==typeof e&&e()}))}}],[{key:"getName",value:function(){return"xfa"}},{key:"getLoader",value:function(){return z()}}]),i}(x)})(),a=a.default})()));