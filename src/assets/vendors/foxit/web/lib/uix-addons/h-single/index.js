!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("UIExtension"),require("UIExtension").PDFViewCtrl):"function"==typeof define&&define.amd?define(["UIExtension",["UIExtension","PDFViewCtrl"]],t):"object"==typeof exports?exports.HSingleViewModeAddon=t(require("UIExtension"),require("UIExtension").PDFViewCtrl):e.HSingleViewModeAddon=t(e.UIExtension,e.UIExtension.PDFViewCtrl)}(self,((e,t)=>(()=>{var n={622:e=>{e.exports=null},616:t=>{"use strict";t.exports=e},290:e=>{"use strict";e.exports=t}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,i),o.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};return(()=>{"use strict";function e(t,n){return null!=n&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](t):e(t,n)}function t(t,n){if(!e(t,n))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function l(e,t,n){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n||e):i.value}},l(e,t,n||e)}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?u(e):t;var n}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}i.d(o,{default:()=>P});var h=i(616),g=i(622),p=i.n(g),v=i(290),y=PDFViewCtrl.keyboard.BuiltinShortcutCommand,m=function(e){c(i,e);var n=f(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"onKeyPressed",value:function(e){var t=this.getPDFDocRender();switch(e.command){case y.ARROW_LEFT:case y.ARROW_RIGHT:return this.viewMode.start(),!1;case y.JUMP_TO_FIRST_PAGE:return this.executor.exec((function(){return t.goToPage(0,{x:0,y:0})})),!1;case y.JUMP_TO_LAST_PAGE:var n=this.getPageCount(),r=n%2==0?n:n-1;return this.executor.exec((function(){return t.goToPage(r,{x:0,y:0})})),!0;case y.SCROLL_TO_NEXT_VISIBLE_AREA:return this.viewMode.toNext(),!0;case y.SCROLL_TO_PREVIOUS_VISIBLE_AREA:return this.viewMode.toPrev(),!0}return!1}},{key:"onKeyReleased",value:function(e){switch(e.command){case y.ARROW_LEFT:case y.ARROW_RIGHT:return this.viewMode.end(),!0}return!1}}]),i}(PDFViewCtrl.viewMode.ViewModeShortcutHandler),w=v.ViewerEvents,x=v.vendors,R=x.jQuery,b=x.Hammer,I=function(e){c(i,e);var n=f(i);function i(e){var r;return t(this,i),(r=n.call(this,e)).pdfViewer=e.pdfViewer,r.start=r.start.bind(u(r)),r.end=r.end.bind(u(r)),r.mousedown=r.mousedown.bind(u(r)),r.mouseup=r.mouseup.bind(u(r)),r.panning=!1,r.animating=!1,r.panType=null,r.scrollable=!1,r}return r(i,[{key:"getItems",value:function(){return this.docRender.$container.find(".fv__pdf-view-mode-item")}},{key:"disableScroll",value:function(){this.pdfViewer.eventEmitter.emit(w.disableScroll)}},{key:"enableScroll",value:function(){this.pdfViewer.eventEmitter.emit(w.enableScroll)}},{key:"into",value:function(e,t){var n=this;l(s(i.prototype),"into",this).call(this,e,t),this.disableScroll();var r=this.constructor.getName(),o=["<style>",".fv__pdf-viewer,.fv__pdf-viewer-layout,.fv__pdf-viewer-container,.fv__pdf-doc-layout{","height:100%;","}","."+r+"{","display:flex;","width:fit-content;","min-height:100%;","}","."+r+" .fv__pdf-view-mode-item{","display: -webkit-box;","display: -ms-flexbox;","display: -webkit-flex;","display: flex;","-ms-flex-pack: center;","-ms-flex-align: center;","-ms-justify-content: center;","-webkit-justify-content: center;","justify-content: center;","align-items:center;","}","."+r+" .fv__pdf-page-layout.fv__rendering{","min-width:128px;","}","</style>"].join("");this.$style=R(o),this.docRender.pagesRender.$ui.append(this.$style),this.docRender.$container.addClass(this.constructor.getName()),this.docRender.$ui.parents(".fv__ui-pdfviewer").css({"overflow-y":"unset","overflow-x":"scroll"});var a=this.pdfViewer.getStateHandlerManager();this.scrollable="hand"===a.getCurrentStates().getStateName(),this.pdfViewer.eventEmitter.on(w.switchStateHandler,this.switchSH=function(e){n.scrollable="hand"===e.getStateName(),n.disableScroll()});var c=this.docRender.viewerRender.scrollWrap;this.scrollHost=c.getScrollHost(),this.scrollHost.addEventListener("mousedown",this.mousedown),R(window).on("mouseup",this.mouseup),this.pdfViewer.eventEmitter.on(w.fitWidthResizeViewport,this.resize=function(){}),this.pdfViewer.eventEmitter.on(w.zoomToSuccess,this.zoom=function(){var e=n.docRender.getCurrentPageIndex();n.docRender.goToPage(e,{x:0,y:0})});var u=this.hammer=new b.Manager(this.scrollHost,{recognizers:[[b.Pan,{direction:b.DIRECTION_ALL}]]}),d=0,f=0;u.on("panstart",(function(){if(n.scrollable){var e=n.allInVisible();n.leftIn=e.leftIn,n.rightIn=e.rightIn,n.panning=!0}})),u.on("panmove",(function(e){if(n.scrollable&&n.panning&&!n.animating){var t=e.deltaX,r=e.deltaY,i=n.docRender.viewerRender.scrollWrap,o=i.getScrollLeft(),s=n.scrollHost.clientWidth+o,l=(i.getScrollTop(),n.docRender.getCurrentPageIndex()),a=n.getItems(),c=a.get(l).offsetLeft,u=c+a.eq(l).width(),h=d-t,g=f-r;d=t,f=r;var p=u-s,v=c-o;h>=0&&h>p&&(h=p),h<0&&h<v&&(h=v),i.scrollBy(h,g)}})),u.on("panend",(function(){n.scrollable&&(1===n.panType?n.toNext():2===n.panType&&n.toPrev(),n.panning=!1,n.panType=null,d=0,f=0)})),u.on("panleft",(function(){n.scrollable&&n.panning&&n.rightIn&&!n.animating&&(n.panType=1)})),u.on("panright",(function(){n.scrollable&&n.panning&&n.leftIn&&!n.animating&&(n.panType=2)})),this._unwatchScrollEvent=c.addScrollEventListener((function(){clearTimeout(n.scrollEventTimer),n.scrollEventTimer=setTimeout((function(){var e=n.docRender.pagesRender;e&&e.renderVisiblePages().then((function(){n.docRender.setCurrentPageIndex(n.getCurrentPageIndex())}),(function(){}))}),30)}))}},{key:"toNext",value:function(){var e=this.docRender.getCurrentPageIndex();this.animation(e+1,!1)}},{key:"toPrev",value:function(){var e=this.docRender.getCurrentPageIndex();this.animation(e-1,!0)}},{key:"animation",value:function(e,t){var n=this.docRender,r=n.doc.getPageCount();if(!(e<0||e>=r)){this.animating=!0;var i=n.viewerRender.scrollWrap,o=this.scrollHost.clientWidth,s=this.getItems(),l=s.get(e).offsetLeft,a=l+s.eq(e).width(),c=i.getScrollLeft(),u=i.getScrollTop(),d=t?-o:o,f=30,h=0;h=t?a-c:l-c,!t&&h>o&&(d=h),t&&h<0&&(d-=h);var g=d/f,p=this,v=setInterval((function(){f>0?(c+=g,i.scrollTo(c,u),f--):(clearInterval(v),p.animating=!1,n.setCurrentPageIndex(e))}),10)}}},{key:"allInVisible",value:function(){var e=this.docRender.getCurrentPageIndex(),t=this.getItems(),n=this.docRender.viewerRender.scrollWrap,r=this.scrollHost.clientWidth,i=this.scrollHost.clientHeight,o=(n.getScrollTop(),n.getScrollLeft()),s=o+r,l=t.get(e).offsetLeft,a=l+t.eq(e).width(),c=!1,u=!1;return Math.abs(o-l)<=1&&(c=!0),Math.abs(s-a)<=1&&(u=!0),{leftIn:c,rightIn:u}}},{key:"renderViewMode",value:function(e,t,n,r,i){var o=e.index,s=this.getItems().eq(o),l=(this.docRender.pagesRender.$ui.height(),this.scrollHost),a=l.clientWidth,c=(l.clientHeight,s.find(".fv__pdf-page-layout").width());s.find(".fv__pdf-page-layout").height();c<a?s.css({width:a}):s.css({width:""})}},{key:"mousedown",value:function(e){var t=this.scrollHost,n=R(t).offset(),r=n.top,i=n.left,o=i+t.clientWidth,s=r+t.clientHeight;this.dragging=!0;var l=e.clientX,a=e.clientY;return this.scrollType=i<=l&&l<=o&&r<=a&&a<=s?0:o<l&&r<a?1:2,this.client={x:l,y:a},this.start(),!1}},{key:"mouseup",value:function(e){var t=this;t.dragging,t.client,t.panning;2===this.scrollType&&this.end()}},{key:"start",value:function(){this.scrollPageIndex=this.docRender.getCurrentPageIndex()}},{key:"end",value:function(){var e=this.getVisibleIndexes();if(1!==e.length){var t=e.indexOf(this.scrollPageIndex),n=e.length-1;t>-1?t<n/2?this.docRender.goToPage(e[n],{x:0,y:0}):this.docRender.goToPage(e[0],{x:0,y:0}):e[0]>t?this.docRender.goToPage(e[n],{x:0,y:0}):e[n]<t&&this.docRender.goToPage(e[0],{x:0,y:0})}}},{key:"prev",value:function(e){var t=this.getItems(),n=this.scrollHost.clientWidth,r=t.eq(e).width()-n;r>=1?this.jumpToPage(e,{x:r,y:0}):this.jumpToPage(e,{x:0,y:0})}},{key:"jumpToPage",value:function(e,t){var n=t.x,r=void 0===n?0:n,i=t.y,o=void 0===i?0:i,s=this.getItems();e>=s.length?e=s.length-1:e<0&&(e=0);var l=s[e],a=l.offsetLeft+r,c=l.offsetTop+o;this.docRender.viewerRender.scrollWrap.scrollTo(a,c)}},{key:"getCurrentPageIndex",value:function(){for(var e,t=this.docRender.$ui,n=this.getItems(),r=this.docRender.viewerRender.scrollWrap,i=(r.getScrollTop(),t.height(),r.getScrollLeft()),o=i+t.width(),s=[],l=0;l<n.length;l++){var a=n[l],c=a.offsetLeft,u=R(a).width(),d=c+u;c<=i&&d>i&&d<o?s.push({index:l,width:d-i}):c>=i&&d<o?s.push({index:l,width:u}):c<=i&&d>o?e=l:c>=i&&c<o&&d>o&&s.push({index:l,width:o-c})}if(null==e)for(var f=0,h=0;h<s.length;h++)s[h].width>f&&(f=s[h].width,e=s[h].index);return e}},{key:"getFitHeight",value:function(e){var t=this.docRender.viewerRender.scrollWrap;return t.getHeight()-t.getScrollOffsetTop()}},{key:"getFitWidth",value:function(e){var t=this.docRender.viewerRender.scrollWrap;return t.getWidth()-t.getScrollOffsetLeft()}},{key:"getVisibleIndexes",value:function(){var e=this.docRender.viewerRender.scrollWrap,t=e.getScrollLeft()-e.getScrollOffsetLeft(),n=this.docRender.$ui.width(),r=t+n,i=[];return this.getItems().each((function(e,n){var o=n.offsetLeft,s=n.offsetWidth+o;t<s&&r>o&&i.push(e)})),i}},{key:"getNextPageIndex",value:function(){var e=this.docRender.doc.getPageCount(),t=this.getCurrentPageIndex();return t<e-1&&t++,t}},{key:"getPrevPageIndex",value:function(){var e=this.getCurrentPageIndex();return e>0&&e--,e}},{key:"out",value:function(){this.enableScroll(),this.scrollable=!1,this.pdfViewer.eventEmitter.off(w.fitWidthResizeViewport,this.resize),this.scrollHost.removeEventListener("mousedown",this.mousedown),R(window).off("mouseup",this.mouseup),this.hammer.destroy(),this.pdfViewer.eventEmitter.off(w.fitWidthResizeViewport,this.resize),this.pdfViewer.eventEmitter.off(w.switchStateHandler,this.switchSH),this.pdfViewer.eventEmitter.off(w.zoomToSuccess,this.zoom),this.docRender.$container.removeClass(this.constructor.getName()),this.docRender.$ui.parents(".fv__ui-pdfviewer").css({"overflow-x":"","overflow-y":""}),this.$style&&this.$style.remove();for(var e=this.getItems(),t=0;t<e.length;t++)e.eq(t).css({width:""})}},{key:"generateShortcutEventHandler",value:function(){return new m(this)}}],[{key:"getName",value:function(){return"h-single-view-mode"}}]),i}(v.IViewMode),P=(h.Controller,h.PDFViewCtrl.Events,function(e){c(i,e);var n=f(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"init",value:function(e,t){l(s(i.prototype),"init",this).call(this,e,t),t.getViewModeManager().register(I)}}],[{key:"getName",value:function(){return"h-single"}},{key:"getLoader",value:function(){return p()}},{key:"initOnLoad",value:function(){h.modular.module("h-single",[]).registerPreConfiguredComponent("h-single-button",{template:'\n            <xbutton @tooltip name="h-single-button" icon-class="fv__icon-toolbar-h-single-page">h-single:buttons.title</xbutton>\n            ',config:[{target:"h-single-button",tooltip:{title:"h-single:buttons.title"},callback:function(e){c(r,e);var n=f(r);function r(e){return t(this,r),n.call(this,e,I.getName())}return r}(h.controllers.ViewModeController)}]})}}]),i}(h.UIXAddon))})(),o=o.default})()));