!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("UIExtension")):"function"==typeof define&&define.amd?define(["UIExtension"],e):"object"==typeof exports?exports.JavaScriptFormAddon=e(require("UIExtension")):t.JavaScriptFormAddon=e(t.UIExtension)}(self,(t=>(()=>{var e={778:(t,e,n)=>{n(779);t.exports=function(t){"use strict";t=t||{};return'<layer @var.self="$component" name="document-action-dialog" class="fv__ui-document-action-layer center" append-to="body" @draggable modal>\n<layer-header title="javascript-form:document-action.dialog.title"></layer-header>\n<div class="fv__ui-document-action-layer-main" @stop-drag>\n<p>javascript-form:document-action.dialog.name</p>\n<div class="fv__ui-document-action-layer-top">\n<div class="fv__ui-document-action-layer-top-left">\n<ul id="docActionList">\n<li @foreach="item in self.docActionList" js-key="@{item.key}" @on.click="self.selectHandle(item)">@{item.name}</li>\n</ul>\n</div>\n<div class="fv__ui-document-action-layer-top-right">\n<xbutton @on.click="self.editJs()" name="doc-action-edit">javascript-form:document-action.dialog.edit</xbutton>\n</div>\n</div>\n<p>javascript-form:document-action.dialog.sub-name</p>\n<div class="fv__ui-document-action-layer-bottom">\n<textarea id="doc-action-preview" readonly></textarea>\n</div>\n</div>\n<div class="fv_ui_dialog-footer fv__doc_action_dia_footer">\n<xbutton @on.click="self.okHandle()" name="okBtn" class="fv__ui-dialog-ok-button fv__ui-dialog-btn fv__button-ok">javascript-form:document-action.dialog.ok</xbutton>\n<xbutton @on.click="self.closeDia()" name="closeBtn" class="fv__ui-dialog-cancel-button fv__ui-dialog-btn fv__button-cancle">javascript-form:document-action.dialog.cancel</xbutton>\n</div>\n</layer>','<layer @var.self="$component" name="document-action-dialog" class="fv__ui-document-action-layer center" append-to="body" @draggable modal>\n<layer-header title="javascript-form:document-action.dialog.title"></layer-header>\n<div class="fv__ui-document-action-layer-main" @stop-drag>\n<p>javascript-form:document-action.dialog.name</p>\n<div class="fv__ui-document-action-layer-top">\n<div class="fv__ui-document-action-layer-top-left">\n<ul id="docActionList">\n<li @foreach="item in self.docActionList" js-key="@{item.key}" @on.click="self.selectHandle(item)">@{item.name}</li>\n</ul>\n</div>\n<div class="fv__ui-document-action-layer-top-right">\n<xbutton @on.click="self.editJs()" name="doc-action-edit">javascript-form:document-action.dialog.edit</xbutton>\n</div>\n</div>\n<p>javascript-form:document-action.dialog.sub-name</p>\n<div class="fv__ui-document-action-layer-bottom">\n<textarea id="doc-action-preview" readonly></textarea>\n</div>\n</div>\n<div class="fv_ui_dialog-footer fv__doc_action_dia_footer">\n<xbutton @on.click="self.okHandle()" name="okBtn" class="fv__ui-dialog-ok-button fv__ui-dialog-btn fv__button-ok">javascript-form:document-action.dialog.ok</xbutton>\n<xbutton @on.click="self.closeDia()" name="closeBtn" class="fv__ui-dialog-cancel-button fv__ui-dialog-btn fv__button-cancle">javascript-form:document-action.dialog.cancel</xbutton>\n</div>\n</layer>'}},145:(t,e,n)=>{n(779);t.exports=function(t){"use strict";t=t||{};return'<layer @var.self="$component" name="document-javascript-dialog" class="fv__ui-document-javascript-layer center" append-to="body" @draggable modal>\n<layer-header title="javascript-form:document-javascript.dialog.title"></layer-header>\n<div class="fv__ui-document-javascript-layer-main" @stop-drag>\n<p>javascript-form:document-javascript.dialog.name</p>\n<input @model="self.inputName" type="text" class="js-name-input" name="js-name-input" @on.native.input="self.inputHandleChange($event)" />\n<div class="fv__ui-document-javascript-layer-main-body">\n<div class="fv__ui-document-javascript-layer-main-body-left">\n<ul id="addJsList" @if="self.addedJsList.length">\n<li @foreach="item in self.addedJsList" js-name="@{item.name}" @on.click="self.clickHandle(item)">@{item.name}</li>\n</ul>\n</div>\n<div class="fv__ui-document-javascript-layer-main-body-right">\n<xbutton @on.click="self.closeDia()" name="js-dia-close">javascript-form:document-javascript.dialog.close</xbutton>\n<xbutton @on.click="self.addJs(false)" name="js-dia-add">javascript-form:document-javascript.dialog.add</xbutton>\n<xbutton @on.click="self.addJs(true)" name="js-dia-edit">javascript-form:document-javascript.dialog.edit</xbutton>\n<xbutton @on.click="self.deleteItem()" name="js-dia-delete">javascript-form:document-javascript.dialog.delete</xbutton>\n</div>\n</div>\n<div class="fv__ui-document-javascript-layer-preview">\n<textarea id="js-dia-preview-box" readonly></textarea>\n</div>\n</div>\n</layer>','<layer @var.self="$component" name="document-javascript-dialog" class="fv__ui-document-javascript-layer center" append-to="body" @draggable modal>\n<layer-header title="javascript-form:document-javascript.dialog.title"></layer-header>\n<div class="fv__ui-document-javascript-layer-main" @stop-drag>\n<p>javascript-form:document-javascript.dialog.name</p>\n<input @model="self.inputName" type="text" class="js-name-input" name="js-name-input" @on.native.input="self.inputHandleChange($event)" />\n<div class="fv__ui-document-javascript-layer-main-body">\n<div class="fv__ui-document-javascript-layer-main-body-left">\n<ul id="addJsList" @if="self.addedJsList.length">\n<li @foreach="item in self.addedJsList" js-name="@{item.name}" @on.click="self.clickHandle(item)">@{item.name}</li>\n</ul>\n</div>\n<div class="fv__ui-document-javascript-layer-main-body-right">\n<xbutton @on.click="self.closeDia()" name="js-dia-close">javascript-form:document-javascript.dialog.close</xbutton>\n<xbutton @on.click="self.addJs(false)" name="js-dia-add">javascript-form:document-javascript.dialog.add</xbutton>\n<xbutton @on.click="self.addJs(true)" name="js-dia-edit">javascript-form:document-javascript.dialog.edit</xbutton>\n<xbutton @on.click="self.deleteItem()" name="js-dia-delete">javascript-form:document-javascript.dialog.delete</xbutton>\n</div>\n</div>\n<div class="fv__ui-document-javascript-layer-preview">\n<textarea id="js-dia-preview-box" readonly></textarea>\n</div>\n</div>\n</layer>'}},806:(t,e,n)=>{n(779);t.exports=function(t){"use strict";t=t||{};return'<layer @var.self="$component" name="edit-all-javascript-dialog" class="fv__ui-edit-all-javascript-layer center" append-to="body" @draggable modal>\n<layer-header class="lh-js" title="javascript-form:edit-all-javascript.dialog.title"></layer-header>\n<p>javascript-form:edit-all-javascript.dialog.sub-title</p>\n<div class="fv__ui-edit-all-javascript-layer-main" @stop-drag>\n<textarea id="all-js-editor"></textarea>\n</div>\n<div class="fv_ui_dialog-footer fv__edit_all_javascript_dia_footer">\n<xbutton @on.click="self.okHandle()" name="okBtn" class="fv__ui-dialog-ok-button fv__ui-dialog-btn fv__button-ok">javascript-form:edit-all-javascript.dialog.ok</xbutton>\n<xbutton @on.click="self.closeDia()" name="closeBtn" class="fv__ui-dialog-cancel-button fv__ui-dialog-btn fv__button-cancle">javascript-form:edit-all-javascript.dialog.cancel</xbutton>\n<xbutton @on.click="self.goTo()" name="goToBtn" class="fv__ui-dialog-cancel-button fv__ui-dialog-btn fv__button-cancle">javascript-form:edit-all-javascript.dialog.go</xbutton>\n<p id="js-editor-curpos"></p>\n</div>\n</layer>','<layer @var.self="$component" name="edit-all-javascript-dialog" class="fv__ui-edit-all-javascript-layer center" append-to="body" @draggable modal>\n<layer-header class="lh-js" title="javascript-form:edit-all-javascript.dialog.title"></layer-header>\n<p>javascript-form:edit-all-javascript.dialog.sub-title</p>\n<div class="fv__ui-edit-all-javascript-layer-main" @stop-drag>\n<textarea id="all-js-editor"></textarea>\n</div>\n<div class="fv_ui_dialog-footer fv__edit_all_javascript_dia_footer">\n<xbutton @on.click="self.okHandle()" name="okBtn" class="fv__ui-dialog-ok-button fv__ui-dialog-btn fv__button-ok">javascript-form:edit-all-javascript.dialog.ok</xbutton>\n<xbutton @on.click="self.closeDia()" name="closeBtn" class="fv__ui-dialog-cancel-button fv__ui-dialog-btn fv__button-cancle">javascript-form:edit-all-javascript.dialog.cancel</xbutton>\n<xbutton @on.click="self.goTo()" name="goToBtn" class="fv__ui-dialog-cancel-button fv__ui-dialog-btn fv__button-cancle">javascript-form:edit-all-javascript.dialog.go</xbutton>\n<p id="js-editor-curpos"></p>\n</div>\n</layer>'}},12:(t,e,n)=>{n(779);t.exports=function(t){"use strict";t=t||{};return'<layer @var.self="$component" name="go-to-line-dialog" class="fv__ui-go-to-line-layer center" append-to="body" @draggable modal>\n<layer-header title="javascript-form:edit-all-javascript.dialog.go-title"></layer-header>\n<div class="fv__ui-go-to-line-main" @stop-drag>\n<p>javascript-form:edit-all-javascript.dialog.go-sub-title</p>\n<input @model="self.inputNum" type="number" class="js-line-num-input" name="js-line-num-input" @on.native.input="self.inputHandleChange($event)" />\n</div>\n<div class="fv_ui_dialog-footer fv__go_to_line_dia_footer">\n<xbutton @on.click="self.okHandle()" name="okBtn" class="fv__ui-dialog-ok-button fv__ui-dialog-btn fv__button-ok">javascript-form:edit-all-javascript.dialog.ok</xbutton>\n<xbutton @on.click="self.closeDia()" name="closeBtn" class="fv__ui-dialog-cancel-button fv__ui-dialog-btn fv__button-cancle">javascript-form:edit-all-javascript.dialog.cancel</xbutton>\n</div>\n</layer>','<layer @var.self="$component" name="go-to-line-dialog" class="fv__ui-go-to-line-layer center" append-to="body" @draggable modal>\n<layer-header title="javascript-form:edit-all-javascript.dialog.go-title"></layer-header>\n<div class="fv__ui-go-to-line-main" @stop-drag>\n<p>javascript-form:edit-all-javascript.dialog.go-sub-title</p>\n<input @model="self.inputNum" type="number" class="js-line-num-input" name="js-line-num-input" @on.native.input="self.inputHandleChange($event)" />\n</div>\n<div class="fv_ui_dialog-footer fv__go_to_line_dia_footer">\n<xbutton @on.click="self.okHandle()" name="okBtn" class="fv__ui-dialog-ok-button fv__ui-dialog-btn fv__button-ok">javascript-form:edit-all-javascript.dialog.ok</xbutton>\n<xbutton @on.click="self.closeDia()" name="closeBtn" class="fv__ui-dialog-cancel-button fv__ui-dialog-btn fv__button-cancle">javascript-form:edit-all-javascript.dialog.cancel</xbutton>\n</div>\n</layer>'}},59:(t,e,n)=>{n(779);t.exports=function(t){"use strict";t=t||{};return'<layer @var.self="$component" name="javascript-console.dialog" class="fv__ui-javascript-console-layer center" append-to="body" @draggable modal>\n<layer-header title="javascript-form:javascript-console.dialog.title"></layer-header>\n<div class="fv__ui-javascript-console-layer-main" @stop-drag>\n<div class="fv__ui-console-content">\n<div class="fv__ui-script-input-dialog">\n<div class="fv_js-editor-body">\n<textarea disabled resize=none class="line-container">\n</textarea>\n<textarea resize=none class="script-container" @on.native.input="self.checkTxt($event)" @aria:labelledby="::parent()::previousSiblings()" id="importTextarea">\n</textarea>\n</div>\n</div>\n</div>\n<div class="fv__ui-console-results">\n<textarea disabled=\'1\' name="fv__ui-console-results" id="fv__ui-console-results" ></textarea>\n</div>\n<div class="fv__ui-console-footer">\n<div class="fv__ui-button-collection">\n<xbutton @on.click="self.handleRun()" name="js-dia-run">javascript-form:javascript-console.dialog.run</xbutton>\n<xbutton @on.click="self.handleClear()" name="js-dia-clear">javascript-form:javascript-console.dialog.clear</xbutton>\n<xbutton @on.click="self.handleClose()" name="js-dia-close">javascript-form:javascript-console.dialog.close</xbutton>\n</div>\n</div>   \n</div>\n</layer>','<layer @var.self="$component" name="javascript-console.dialog" class="fv__ui-javascript-console-layer center" append-to="body" @draggable modal>\n<layer-header title="javascript-form:javascript-console.dialog.title"></layer-header>\n<div class="fv__ui-javascript-console-layer-main" @stop-drag>\n<div class="fv__ui-console-content">\n<div class="fv__ui-script-input-dialog">\n<div class="fv_js-editor-body">\n<textarea disabled resize=none class="line-container">\n</textarea>\n<textarea resize=none class="script-container" @on.native.input="self.checkTxt($event)" @aria:labelledby="::parent()::previousSiblings()" id="importTextarea">\n</textarea>\n</div>\n</div>\n</div>\n<div class="fv__ui-console-results">\n<textarea disabled=\'1\' name="fv__ui-console-results" id="fv__ui-console-results" ></textarea>\n</div>\n<div class="fv__ui-console-footer">\n<div class="fv__ui-button-collection">\n<xbutton @on.click="self.handleRun()" name="js-dia-run">javascript-form:javascript-console.dialog.run</xbutton>\n<xbutton @on.click="self.handleClear()" name="js-dia-clear">javascript-form:javascript-console.dialog.clear</xbutton>\n<xbutton @on.click="self.handleClose()" name="js-dia-close">javascript-form:javascript-console.dialog.close</xbutton>\n</div>\n</div>   \n</div>\n</layer>'}},155:t=>{t.exports=null},585:(t,e,n)=>{"use strict";
/*! art-template@runtime | https://github.com/aui/art-template */var o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},a=Object.create(o),i=/["&'<>]/;function r(t){return"string"!=typeof t&&(t=null==t?"":"function"==typeof t?r(t.call(t)):JSON.stringify(t)),t}a.$escape=function(t){return function(t){var e=""+t,n=i.exec(e);if(!n)return t;var o="",a=void 0,r=void 0,c=void 0;for(a=n.index,r=0;a<e.length;a++){switch(e.charCodeAt(a)){case 34:c="&#34;";break;case 38:c="&#38;";break;case 39:c="&#39;";break;case 60:c="&#60;";break;case 62:c="&#62;";break;default:continue}r!==a&&(o+=e.substring(r,a)),r=a+1,o+=c}return r!==a?o+e.substring(r,a):o}(r(t))},a.$each=function(t,e){if(Array.isArray(t))for(var n=0,o=t.length;n<o;n++)e(t[n],n);else for(var a in t)e(t[a],a)},t.exports=a},779:(t,e,n)=>{"use strict";t.exports=n(585)},552:(t,e,n)=>{var o=n(852)(n(639),"DataView");t.exports=o},71:(t,e,n)=>{var o=n(852)(n(639),"Map");t.exports=o},818:(t,e,n)=>{var o=n(852)(n(639),"Promise");t.exports=o},525:(t,e,n)=>{var o=n(852)(n(639),"Set");t.exports=o},705:(t,e,n)=>{var o=n(639).Symbol;t.exports=o},577:(t,e,n)=>{var o=n(852)(n(639),"WeakMap");t.exports=o},239:(t,e,n)=>{var o=n(705),a=n(607),i=n(333),r=o?o.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":r&&r in Object(t)?a(t):i(t)}},454:(t,e,n)=>{var o=n(239),a=n(5);t.exports=function(t){return a(t)&&"[object Arguments]"==o(t)}},458:(t,e,n)=>{var o=n(560),a=n(346),i=n(218),r=n(257),c=/^\[object .+?Constructor\]$/,l=Function.prototype,s=Object.prototype,u=l.toString,d=s.hasOwnProperty,f=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!i(t)||a(t))&&(o(t)?f:c).test(r(t))}},749:(t,e,n)=>{var o=n(239),a=n(780),i=n(5),r={};r["[object Float32Array]"]=r["[object Float64Array]"]=r["[object Int8Array]"]=r["[object Int16Array]"]=r["[object Int32Array]"]=r["[object Uint8Array]"]=r["[object Uint8ClampedArray]"]=r["[object Uint16Array]"]=r["[object Uint32Array]"]=!0,r["[object Arguments]"]=r["[object Array]"]=r["[object ArrayBuffer]"]=r["[object Boolean]"]=r["[object DataView]"]=r["[object Date]"]=r["[object Error]"]=r["[object Function]"]=r["[object Map]"]=r["[object Number]"]=r["[object Object]"]=r["[object RegExp]"]=r["[object Set]"]=r["[object String]"]=r["[object WeakMap]"]=!1,t.exports=function(t){return i(t)&&a(t.length)&&!!r[o(t)]}},280:(t,e,n)=>{var o=n(726),a=n(916),i=Object.prototype.hasOwnProperty;t.exports=function(t){if(!o(t))return a(t);var e=[];for(var n in Object(t))i.call(t,n)&&"constructor"!=n&&e.push(n);return e}},518:t=>{t.exports=function(t){return function(e){return t(e)}}},429:(t,e,n)=>{var o=n(639)["__core-js_shared__"];t.exports=o},957:(t,e,n)=>{var o="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;t.exports=o},852:(t,e,n)=>{var o=n(458),a=n(801);t.exports=function(t,e){var n=a(t,e);return o(n)?n:void 0}},607:(t,e,n)=>{var o=n(705),a=Object.prototype,i=a.hasOwnProperty,r=a.toString,c=o?o.toStringTag:void 0;t.exports=function(t){var e=i.call(t,c),n=t[c];try{t[c]=void 0;var o=!0}catch(t){}var a=r.call(t);return o&&(e?t[c]=n:delete t[c]),a}},160:(t,e,n)=>{var o=n(552),a=n(71),i=n(818),r=n(525),c=n(577),l=n(239),s=n(257),u="[object Map]",d="[object Promise]",f="[object Set]",v="[object WeakMap]",p="[object DataView]",m=s(o),h=s(a),g=s(i),y=s(r),b=s(c),j=l;(o&&j(new o(new ArrayBuffer(1)))!=p||a&&j(new a)!=u||i&&j(i.resolve())!=d||r&&j(new r)!=f||c&&j(new c)!=v)&&(j=function(t){var e=l(t),n="[object Object]"==e?t.constructor:void 0,o=n?s(n):"";if(o)switch(o){case m:return p;case h:return u;case g:return d;case y:return f;case b:return v}return e}),t.exports=j},801:t=>{t.exports=function(t,e){return null==t?void 0:t[e]}},346:(t,e,n)=>{var o,a=n(429),i=(o=/[^.]+$/.exec(a&&a.keys&&a.keys.IE_PROTO||""))?"Symbol(src)_1."+o:"";t.exports=function(t){return!!i&&i in t}},726:t=>{var e=Object.prototype;t.exports=function(t){var n=t&&t.constructor;return t===("function"==typeof n&&n.prototype||e)}},916:(t,e,n)=>{var o=n(569)(Object.keys,Object);t.exports=o},167:(t,e,n)=>{t=n.nmd(t);var o=n(957),a=e&&!e.nodeType&&e,i=a&&t&&!t.nodeType&&t,r=i&&i.exports===a&&o.process,c=function(){try{var t=i&&i.require&&i.require("util").types;return t||r&&r.binding&&r.binding("util")}catch(t){}}();t.exports=c},333:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},569:t=>{t.exports=function(t,e){return function(n){return t(e(n))}}},639:(t,e,n)=>{var o=n(957),a="object"==typeof self&&self&&self.Object===Object&&self,i=o||a||Function("return this")();t.exports=i},257:t=>{var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},694:(t,e,n)=>{var o=n(454),a=n(5),i=Object.prototype,r=i.hasOwnProperty,c=i.propertyIsEnumerable,l=o(function(){return arguments}())?o:function(t){return a(t)&&r.call(t,"callee")&&!c.call(t,"callee")};t.exports=l},469:t=>{var e=Array.isArray;t.exports=e},612:(t,e,n)=>{var o=n(560),a=n(780);t.exports=function(t){return null!=t&&a(t.length)&&!o(t)}},144:(t,e,n)=>{t=n.nmd(t);var o=n(639),a=n(62),i=e&&!e.nodeType&&e,r=i&&t&&!t.nodeType&&t,c=r&&r.exports===i?o.Buffer:void 0,l=(c?c.isBuffer:void 0)||a;t.exports=l},609:(t,e,n)=>{var o=n(280),a=n(160),i=n(694),r=n(469),c=n(612),l=n(144),s=n(726),u=n(719),d=Object.prototype.hasOwnProperty;t.exports=function(t){if(null==t)return!0;if(c(t)&&(r(t)||"string"==typeof t||"function"==typeof t.splice||l(t)||u(t)||i(t)))return!t.length;var e=a(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(s(t))return!o(t).length;for(var n in t)if(d.call(t,n))return!1;return!0}},560:(t,e,n)=>{var o=n(239),a=n(218);t.exports=function(t){if(!a(t))return!1;var e=o(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},780:t=>{t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},218:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},5:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},719:(t,e,n)=>{var o=n(749),a=n(518),i=n(167),r=i&&i.isTypedArray,c=r?a(r):o;t.exports=c},62:t=>{t.exports=function(){return!1}},616:e=>{"use strict";e.exports=t}},n={};function o(t){var a=n[t];if(void 0!==a)return a.exports;var i=n[t]={id:t,loaded:!1,exports:{}};return e[t](i,i.exports,o),i.loaded=!0,i.exports}o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var a={};return(()=>{"use strict";function t(e,n){return null!=n&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](e):t(e,n)}function e(e,n){if(!t(e,n))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}function r(t,e){return r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},r(t,e)}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function s(t,e){return!e||"object"!=((n=e)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var n}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=l(t);if(e){var a=l(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return s(this,n)}}o.d(a,{default:()=>rt});var d=o(616),f=o(155),v=o.n(f);function p(t,e,n,o,a,i,r){try{var c=t[i](r),l=c.value}catch(t){return void n(t)}c.done?e(l):Promise.resolve(l).then(o,a)}function m(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function r(t){p(i,o,a,r,c,"next",t)}function c(t){p(i,o,a,r,c,"throw",t)}r(void 0)}))}}function h(t,e,n){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(o){var a=Object.getOwnPropertyDescriptor(o,e);return a.get?a.get.call(n||t):a.value}},h(t,e,n||t)}function g(t,e){var n,o,a,i,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(r=0)),r;)try{if(n=1,o&&(a=2&c[0]?o.return:c[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,c[1])).done)return a;switch(o=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,o=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(!(a=r.trys,(a=a.length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){r=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){r.label=c[1];break}if(6===c[0]&&r.label<a[1]){r.label=a[1],a=c;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(c);break}a[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(t){c=[6,t],o=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;d.PDFViewCtrl.ViewerEvents,d.PDFViewCtrl.Consts.PDFDocPermission;var y=function(t){c(o,t);var n=u(o);function o(){return e(this,o),n.apply(this,arguments)}return i(o,[{key:"mounted",value:function(){h(l(o.prototype),"mounted",this).call(this)}},{key:"click",value:function(){var t=this;return m((function(){return g(this,(function(e){return t.pdfUI.openDialog("document-action-dialog").then((function(t){return t.show()})),[2]}))}))()}}],[{key:"getName",value:function(){return"document-action"}}]),o}(d.SeniorComponentFactory.createSuperClass({template:'<xbutton\n        @on.click="$component.click()"\n        @tooltip\n        tooltip-title="javascript-form:document-action.title"\n        text="javascript-form:document-action.text"\n        icon-class="fx-icon-sm fx-icon-ribbon_form_document_action"\n        tabindex="0"\n    ></xbutton>'})),b=(d.PDFViewCtrl.ViewerEvents,d.PDFViewCtrl.Consts.PDFDocPermission,function(t){c(o,t);var n=u(o);function o(){return e(this,o),n.apply(this,arguments)}return i(o,[{key:"mounted",value:function(){h(l(o.prototype),"mounted",this).call(this)}},{key:"click",value:function(){var t=this;return m((function(){return g(this,(function(e){return t.pdfUI.openDialog("document-javascript-dialog").then((function(t){return t.show()})),[2]}))}))()}}],[{key:"getName",value:function(){return"document-javascript"}}]),o}(d.SeniorComponentFactory.createSuperClass({template:'\n    <xbutton\n        @on.click="$component.click()"\n        @tooltip\n        tooltip-title="javascript-form:document-javascript.title"\n        text="javascript-form:document-javascript.text"\n        icon-class="fx-icon-sm fx-icon-ribbon_form_document_javascript"\n        tabindex="0"\n    ></xbutton>'}))),j=(d.PDFViewCtrl.ViewerEvents,d.PDFViewCtrl.Consts.PDFDocPermission,function(t){c(o,t);var n=u(o);function o(){return e(this,o),n.apply(this,arguments)}return i(o,[{key:"mounted",value:function(){h(l(o.prototype),"mounted",this).call(this)}},{key:"click",value:function(){var t=this;return m((function(){return g(this,(function(e){return t.pdfUI.openDialog("edit-all-javascript-dialog").then((function(t){return t.show()})),[2]}))}))()}}],[{key:"getName",value:function(){return"edit-all-javascript"}}]),o}(d.SeniorComponentFactory.createSuperClass({template:'<xbutton\n        @on.click="$component.click()"\n        @tooltip\n        tooltip-title="javascript-form:edit-all-javascript.title"\n        text="javascript-form:edit-all-javascript.text"\n        icon-class="fx-icon-sm fx-icon-ribbon_form_edit_all_javascript"\n        tabindex="0"\n    ></xbutton>'})));function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function x(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}function k(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||x(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var w=function(t){c(o,t);var n=u(o);function o(){for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];var r;return e(this,o),(r=n.call.apply(n,[this].concat(k(a)))).initData(),r}return i(o,[{key:"mounted",value:function(){var t=this;h(l(o.prototype),"mounted",this).call(this),this.pdfUI.addViewerEventListener("show-js-console",(function(e){t.click(!1)}))}},{key:"initData",value:function(){}},{key:"click",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this;return m((function(){var n;return g(this,(function(o){switch(o.label){case 0:return e.pdfUI.customs.isAccountExpired(!0)?[2]:e.dialog?[3,2]:[4,e.pdfUI.getComponentByName("template-container")];case 1:n=o.sent(),e.dialog=n.append('<javascript-form:javascript-console-dialog name="javascript-console-dialog"></javascript-form:javascript-console-dialog>'),o.label=2;case 2:return t&&e.pdfUI.customs.sendGAEvent({eventKey:"fv--form-javascript-console",label:"form_tab"}),e.dialog.show(),[2]}}))}))()}}],[{key:"getName",value:function(){return"javascript-console"}}]),o}(d.SeniorComponentFactory.createSuperClass({template:'<xbutton\n        @on.click="$component.click()"\n        @tooltip\n        tooltip-title="javascript-form:javascript-console.title"\n        text="javascript-form:javascript-console.text"\n        icon-class="fx-icon-sm fx-icon-ribbon_form_javascript_console"\n        tabindex="0"\n    ></xbutton>'})),S=d.PDFViewCtrl.Consts.PDFDocPermission,A=function(t){c(o,t);var n=u(o);function o(){return e(this,o),n.apply(this,arguments)}return i(o,[{key:"mounted",value:function(){var t=this;h(l(o.prototype),"mounted",this).call(this);var e=this.getComponentByName("js-form-dropdown"),n=e.doActive.bind(e);e.doActive=function(){n(),t.pdfUI.getCurrentPDFDoc().then((function(e){var n=e.getUserPermissions(),o="all"===localStorage.getItem("SECURITY_PROTECTED_VIEW"),a=t.getComponentByName("form-document-javascript"),i=t.getComponentByName("form-document-action"),r=t.getComponentByName("form-edit-all-javascript");n&S.ModifyDocument?o?(a.disable(),i.disable(),r.disable()):(a.enable(),i.enable(),r.enable()):(a.disable(),i.disable(),r.disable())}))}}}],[{key:"getName",value:function(){return"javascript-form-dropdown"}}]),o}(d.SeniorComponentFactory.createSuperClass({template:'\n    <div>\n        <ribbon-button\n            @tooltip \n            tooltip-title="javascript-form:button-tooltip.title"\n            text="javascript-form:ribbon.text"\n            icon-class="fx-icon-ribbon_form_javascript_form"\n            class="fx-js-form-btn"\n            not-immediately="true"\n            @var.self="$component"\n        >\n        <dropdown\n            icon-class="fx-icon-ribbon_form_javascript_form"\n            @tooltip \n            tooltip-title="javascript-form:button-tooltip.title"\n            separate="false"\n            text="javascript-form:ribbon.text"\n            name="js-form-dropdown"\n        >\n            <javascript-form:document-javascript name="form-document-javascript"></javascript-form:document-javascript>\n            <javascript-form:document-action name="form-document-action"></javascript-form:document-action>\n            <javascript-form:javascript-console></javascript-form:javascript-console>\n            <javascript-form:edit-all-javascript name="form-edit-all-javascript"></javascript-form:edit-all-javascript>\n        </dropdown>\n        </ribbon-button>\n    </div>\n    '}));function I(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,a,i=[],r=!0,c=!1;try{for(n=n.call(t);!(r=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);r=!0);}catch(t){c=!0,a=t}finally{try{r||null==n.return||n.return()}finally{if(c)throw a}}return i}}(t,e)||x(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var C=o(145),N=o.n(C),D=d.vendors.jQuery,T=function(t){c(o,t);var n=u(o);function o(){for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];var r;return e(this,o),(r=n.call.apply(n,[this].concat(k(a)))).initData(),r}return i(o,[{key:"initData",value:function(){this.addedJsList=[],this.inputName="",this.selectName="",this.previewStr="",this.scriptInputDialog=null}},{key:"mounted",value:function(){h(l(o.prototype),"mounted",this).call(this)}},{key:"show",value:function(){h(l(o.prototype),"show",this).call(this),this.inputName="",this.selectName="",this.previewStr="",this.changeUiState(),this.localize();var t=this.pdfUI.addonInstanceMap.FormDesignerUIXAddon;this.scriptInputDialog||(this.scriptInputDialog=t.getDialog("JSInput")),this.getJsFromDoc()}},{key:"getJsFromDoc",value:function(){var t=this;return m((function(){var e,n,o,a,i,r,c,l,s,u,d;return g(this,(function(f){switch(f.label){case 0:return(e=window.localStorage.getItem("DOCUMENT_JAVASCRIPT_LIST"))&&(t.addedJsList=JSON.parse(e)),[4,t.pdfUI.getCurrentPDFDoc()];case 1:n=f.sent(),o=n.getJsNameTree(),a=!0,i=!1,r=void 0;try{for(c=Object.entries(o)[Symbol.iterator]();!(a=(l=c.next()).done);a=!0)s=I(l.value,2),u=s[0],d=s[1],t.addedJsList.push({name:u,content:d,jsNameTree:!0})}catch(t){i=!0,r=t}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return t.controller.digest(),[2]}}))}))()}},{key:"closeDia",value:function(){this.hide()}},{key:"clickHandle",value:function(t){var e=t.name,n=t.content;this.inputName=e,this.selectName=e,this.previewStr=n,this.changeUiState(),this.changeSelectUi(e)}},{key:"changeSelectUi",value:function(t){D("#addJsList").find("li").removeClass("selected"),t&&D('li[js-name="'.concat(t,'"]')).addClass("selected")}},{key:"deleteItem",value:function(){var t=this;return m((function(){var e;return g(this,(function(n){switch(n.label){case 0:return[4,t.pdfUI.getCurrentPDFDoc()];case 1:return e=n.sent(),t.addedJsList.forEach((function(n){t.selectName===n.name&&n.jsNameTree&&delete e.info.jsNameTree[t.selectName]})),t.addedJsList=t.addedJsList.filter((function(e){return e.name!==t.selectName})),t.selectName="",t.inputName="",t.previewStr="",t.changeUiState(),t.saveToLocal(),[2]}}))}))()}},{key:"addJs",value:function(t){var e=this;return m((function(){var n,o;return g(this,(function(a){return n="",o=e.addedJsList.find((function(t){return t.name===e.selectName})),n=t&&o?o.content:"function ".concat(e.inputName,"()\n{\n}\n"),e.scriptInputDialog.show(n,(function(n){t?(o.content=n,o.jsNameTree&&(e.pdfUI.getCurrentPDFDoc().info.jsNameTree[e.selectName]=n)):(e.addedJsList.push({name:e.inputName,content:n,jsNameTree:!1}),e.selectName=e.inputName);e.controller.digest(),e.saveToLocal(),e.previewStr=n,e.changeUiState(),e.changeSelectUi(e.selectName)})),[2]}))}))()}},{key:"saveToLocal",value:function(){window.localStorage.setItem("DOCUMENT_JAVASCRIPT_LIST",JSON.stringify(this.addedJsList.filter((function(t){return!t.jsNameTree}))))}},{key:"changeUiState",value:function(){var t=this;return m((function(){var e,n,o,a;return g(this,(function(i){switch(i.label){case 0:return[4,t.pdfUI.getComponentByName("js-dia-add")];case 1:return e=i.sent(),[4,t.pdfUI.getComponentByName("js-dia-edit")];case 2:return n=i.sent(),[4,t.pdfUI.getComponentByName("js-dia-delete")];case 3:return o=i.sent(),a=D("#js-dia-preview-box"),!t.selectName&&t.inputName?(e.enable(),n.disable(),o.disable()):t.selectName||t.inputName?(e.disable(),n.enable(),o.enable()):(e.disable(),n.disable(),o.disable()),a.val(t.previewStr),t.controller.digest(),[2]}}))}))()}},{key:"inputHandleChange",value:function(t){var e=this;this.inputName=t.target.value,this.addedJsList.some((function(t){return t.name===e.inputName}))?(this.selectName=this.inputName,this.changeSelectUi(this.selectName),this.previewStr=this.addedJsList.find((function(t){return t.name===e.selectName})).content):(this.selectName="",this.previewStr="",this.changeSelectUi()),this.changeUiState()}}],[{key:"getName",value:function(){return"document-javascript-dialog"}}]),o}(d.SeniorComponentFactory.createSuperClass({template:N()()}));const L=T;function O(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var U=o(778),E=o.n(U),J=d.PDFViewCtrl.ViewerEvents,F=d.PDFViewCtrl.PDF.actions.JavaScriptAction,P=d.vendors.jQuery,R=function(t){c(o,t);var n=u(o);function o(){for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];return e(this,o),n.call.apply(n,[this].concat(k(a)))}return i(o,[{key:"initData",value:function(){this.selectKey="",this.previewStr="",this.scriptInputDialog=null,this.isEnable=!1,this.todoEventList=[],this.timer=null,this.docActionList=["wc","ws","ds","wp","dp"].map((function(t){return{key:t,name:"",content:""}})),this.getDataFromLocalStorage(),this.changeLanguage()}},{key:"changeLanguage",value:function(){var t=this.docActionList;this.docActionList=[],this.controller.digest(),this.docActionList=t;var e=this.controller.pdfUI,n=e.i18n.t("javascript-form:document-action.dialog.doc-will-close"),o=e.i18n.t("javascript-form:document-action.dialog.doc-will-save"),a=e.i18n.t("javascript-form:document-action.dialog.doc-did-save"),i=e.i18n.t("javascript-form:document-action.dialog.doc-will-print"),r=e.i18n.t("javascript-form:document-action.dialog.doc-did-print");this.docActionList.forEach((function(t){switch(t.key){case"wc":t.name=n;break;case"ws":t.name=o;break;case"ds":t.name=a;break;case"wp":t.name=i;break;case"dp":t.name=r}})),this.controller.digest()}},{key:"mounted",value:function(){h(l(o.prototype),"mounted",this).call(this),this.initData(),this.bindEvent()}},{key:"bindEvent",value:function(){var t,e=this,n=this.controller.pdfUI;this.addDestroyHook(n.addViewerEventListener((O(t={},J.willCloseDocument,(function(t){e.handleJsAction("wc")})),O(t,J.documentWillPrint,(function(t){e.handleJsAction("wp")})),O(t,J.documentDidPrint,(function(t){e.handleJsAction("dp")})),O(t,J.documentWillSave,(function(t){e.handleJsAction("ws")})),O(t,J.documentDidSave,(function(t){e.handleJsAction("ds")})),t)))}},{key:"handleJsActionFun",value:function(t){var e=this.controller.pdfUI,n=this.docActionList.find((function(e){return e.key===t})).content,o=new F;o.setScript(n);var a=e.pdfViewer.getPDFDocRender();a&&a.getFormRender().execAction(o.getType(),o)}},{key:"handleJsAction",value:function(t){var e=this;this.todoEventList.includes(t)||this.todoEventList.push(t),this.timer||(this.timer=setTimeout((function(){if(e.getJsEnableFun(),e.isEnable)e.todoEventList.forEach((function(t){return e.handleJsActionFun(t)})),e.todoEventList=[];else{var t=e.controller.pdfUI,n=t.i18n.t("javascript-form:document-action.dialog.enable-tip");t.confirm({message:n,level:"warning"}).then((function(){localStorage.setItem("enable_js_action",!0),t.pdfViewer.setEnableJS(!0),t.eventEmitter.emit("js_action_event",!0),e.todoEventList.forEach((function(t){return e.handleJsActionFun(t)})),e.todoEventList=[]}),(function(){}))}e.timer=null})))}},{key:"show",value:function(){h(l(o.prototype),"show",this).call(this),this.selectKey="",this.previewStr="",this.changeLanguage(),this.changeUiState(),this.changeSelectUi(),this.localize();var t=this.controller.pdfUI;this.getJsEnableFun();var e=t.addonInstanceMap.FormDesignerUIXAddon;this.scriptInputDialog||(this.scriptInputDialog=e.getDialog("JSInput")),this.getDataFromLocalStorage(),this.controller.digest()}},{key:"getJsEnableFun",value:function(){this.controller.pdfUI;var t=localStorage.getItem("enable_js_action");null==t&&(t=this.controller.pdfUI.pdfViewer.getEnableJS());"string"==typeof t&&(t="true"===t),this.isEnable=t}},{key:"getDataFromLocalStorage",value:function(){var t=window.localStorage.getItem("DOCUMENT_ACTION_LIST"),e=null;t&&(e=JSON.parse(t)),this.docActionList.forEach((function(t){var n=t.key;if(e){var o=e.find((function(t){return t.key===n}));t.content=o?o.content:""}else t.content=""}))}},{key:"closeDia",value:function(){this.hide()}},{key:"okHandle",value:function(){window.localStorage.setItem("DOCUMENT_ACTION_LIST",JSON.stringify(this.docActionList)),this.closeDia()}},{key:"selectHandle",value:function(t){var e=t.key,n=t.content;this.selectKey=e,this.previewStr=n,this.changeSelectUi(e),this.changeUiState()}},{key:"changeUiState",value:function(){var t=this;return m((function(){var e;return g(this,(function(n){switch(n.label){case 0:return[4,t.controller.pdfUI.getComponentByName("doc-action-edit")];case 1:return e=n.sent(),t.selectKey?e.enable():e.disable(),[2]}}))}))()}},{key:"changeSelectUi",value:function(t){P("#docActionList").find("li").removeClass("selected");var e=P("#doc-action-preview");t&&P('li[js-key="'.concat(t,'"]')).addClass("selected"),e.val(this.previewStr)}},{key:"editJs",value:function(){var t=this;this.scriptInputDialog.show(this.previewStr,(function(e){t.previewStr=e,t.docActionList.forEach((function(n){n.key===t.selectKey&&(n.content=e)})),t.changeSelectUi(t.selectKey)}))}}],[{key:"getName",value:function(){return"document-action-dialog"}}]),o}(d.SeniorComponentFactory.createSuperClass({template:E()()}));const $=R;var B=o(806),V=o.n(B),H=o(609),M=o.n(H),W=d.PDFViewCtrl.PDF.actions.JavaScriptAction,z=d.vendors.jQuery,K=d.internals.AnnotActions,G=function(n){c(a,n);var o=u(a);function a(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r;return e(this,a),(r=o.call.apply(o,[this].concat(k(n)))).initData(),r}return i(a,[{key:"initData",value:function(){this.col=0,this.ln=0,this.jsUsedAnnotActionList=[],this.docActionList=[],this.docJsList=[]}},{key:"mounted",value:function(){h(l(a.prototype),"mounted",this).call(this),this.bindEvent()}},{key:"bindEvent",value:function(){this.pdfUI.eventEmitter.on("goToLineNumber",this.getGoToLIneNum)}},{key:"getGoToLIneNum",value:function(t){var e=document.getElementById("all-js-editor");if(!(t>parseInt(e.scrollHeight/20))){for(var n=e.value.split(""),o=n.length,a=0,i=0,r=0,c=1;r<o;r++)if("\n"===n[r]&&(c+=1)===t){a=r+1;break}for(var l=a;l<o;l++){if(l===o-1){i=o;break}if("\n"===n[l]){i=l;break}}if(e.createTextRange){var s=e.createTextRange();s.moveEnd("character",i),s.moveStart("character",a),s.select()}else e.setSelectionRange(a,i);e.focus(),z("#all-js-editor").scrollTop(20*Number(t-1))}}},{key:"show",value:function(){var e=this,n=this;return m((function(){var o,i,r,c,s,u,d,f,v,p,m,y,b,j,_,x,k,w,S,A,C,N,D;return g(this,(function(g){switch(g.label){case 0:return h(l(a.prototype),"show",e).call(n),n.addEditorEvent(),n.col=1,n.ln=1,n.updateCurLineCol(),n.localize(),n.jsUsedAnnotActionList=[],o=z("#all-js-editor"),i=window.localStorage.getItem("DOCUMENT_ACTION_LIST"),n.docActionList=i?JSON.parse(i):null,r=window.localStorage.getItem("DOCUMENT_JAVASCRIPT_LIST"),n.docJsList=r?JSON.parse(r):[],[4,n.pdfUI.getCurrentPDFDoc()];case 1:c=g.sent(),s=c.getJsNameTree(),u=!0,d=!1,f=void 0;try{for(v=Object.entries(s)[Symbol.iterator]();!(u=(p=v.next()).done);u=!0)m=I(p.value,2),y=m[0],b=m[1],n.docJsList.push({name:y,content:b,jsNameTree:!0})}catch(t){d=!0,f=t}finally{try{u||null==v.return||v.return()}finally{if(d)throw f}}return j="//-------------------------------------------------------------\n//-----------------Do not edit the XML tags--------------------\n//-------------------------------------------------------------\n",n.docJsList.length&&(_=n.docJsList.reduce((function(t,e){var n=e.name,o=e.content;return t+="\n//<Document-Level>\n//<ACRO_source>".concat(n,"</ACRO_source>\n//<ACRO_script>\n//\x3c!--*********** belongs to:Document-Level:").concat(n," ***********--\x3e\n").concat(o,"\n//</ACRO_script>\n//</Document-Level>\n")}),""),j+=_),n.docActionList&&(x=n.docActionList.filter((function(t){return t.content})),k=n.pdfUI.i18n.t("javascript-form:document-action.dialog.doc-did-save"),w=n.pdfUI.i18n.t("javascript-form:document-action.dialog.doc-did-saved"),S=n.pdfUI.i18n.t("javascript-form:document-action.dialog.doc-did-print"),A=n.pdfUI.i18n.t("javascript-form:document-action.dialog.doc-did-printed"),C=x.reduce((function(t,e){var n=e.name,o=e.content,a=n;return n===k?a=w:n===S&&(a=A),t+="\n//<Document-Actions>\n//<ACRO_source>".concat(a,":Action1</ACRO_source>\n//<ACRO_script>\n//\x3c!--*********** belongs to:Document-Actions:").concat(a," ***********--\x3e\n").concat(o,"\n//</ACRO_script>\n//</Document-Actions>\n")}),""),j+=C),[4,n.getAllAnnot()];case 2:return(N=g.sent())&&(D=N.reduce((function(e,o){if(t(n.getActionInAnnot(o),W)){n.jsUsedAnnotActionList.push(o);var a=n.getActionTitleName(o),i=a.jsStr,r=a.titleStr;e+="\n//<AcroForm>\n//<ACRO_source>".concat(r,"</ACRO_source>\n//<ACRO_script>\n//\x3c!--*********** belongs to:AcroForm:").concat(r," ***********--\x3e\n").concat(i,"\n//</ACRO_script>\n//</AcroForm>\n")}return e}),""),j+=D),o.val(j),[2]}}))}))()}},{key:"getActionInAnnot",value:function(e){var n=null;if(e){n=e.getAction&&e.getAction();var o=e.engineActions;if(!n&&!M()(o)){var a=!0,i=!1,r=void 0;try{for(var c,l=Object.entries(e.engineActions)[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var s=I(c.value,2),u=s[0],d=s[1];if(t(d,W)){(n=d).actionTriggerType=u;break}}}catch(t){i=!0,r=t}finally{try{a||null==l.return||l.return()}finally{if(i)throw r}}}}return n}},{key:"getActionTitleName",value:function(t){var e=this.getActionInAnnot(t),n=e.getScript(),o="Page".concat(t.getPage().getIndex()+1,":"),a="".concat(t.getField().getName(),":"),i="Annot".concat(t.getIndex()+1,":"),r="";e.actionTriggerType&&Number(e.actionTriggerType)&&(r=(r=this.pdfUI.i18n.t(K[Number(e.actionTriggerType)]))?r.split(" ").join("")+":":"");var c="Action".concat(e.getSubActionCount()+1);return{jsStr:n,titleStr:"".concat(o).concat(a).concat(i).concat(r).concat(c)}}},{key:"getAllAnnot",value:function(){var t=this;return m((function(){var e,n,o,a,i,r;return g(this,(function(c){switch(c.label){case 0:e=t.pdfUI.pdfViewer.getCurrentPDFDoc(),n=e.getPageCount(),o=[],a=0,c.label=1;case 1:return a<n?[4,e.getPageByIndex(a)]:[3,5];case 2:return[4,c.sent().getAnnots()];case 3:r=c.sent(),(i=o).push.apply(i,k(r)),c.label=4;case 4:return a++,[3,1];case 5:return[2,o]}}))}))()}},{key:"closeDia",value:function(){this.hide()}},{key:"addEditorEvent",value:function(){var t=this;z("#all-js-editor").on("click keyup focus",(function(e){return t.editorEventHandler(e)}))}},{key:"editorEventHandler",value:function(t){var e=t.target,n=e.value,o=e.selectionEnd;if(n){for(var a=n.split(""),i=a.length,r=o;r>=0;r--){if(0===o||"\n"===a[r-1]){this.col=1;break}if(0===r){this.col=o+1;break}if("\n"===a[r-2]){var c=n.substring(r-1,o);1===c.length&&"\n"===c?this.col=1:this.col=c.length+1;break}}for(var l=0,s=0;s<i;s++){if("\n"===a[s]&&(l+=1),s+1===o){this.ln=l+1;break}if(0===o){this.ln=1;break}}}else this.col=1,this.ln=1;this.updateCurLineCol()}},{key:"updateCurLineCol",value:function(){var t=this.pdfUI.i18n.t("javascript-form:edit-all-javascript.dialog.ln"),e=this.pdfUI.i18n.t("javascript-form:edit-all-javascript.dialog.col");z("#js-editor-curpos").html("".concat(t,": ").concat(this.ln,", ").concat(e,": ").concat(this.col))}},{key:"okHandle",value:function(){var t=z("#all-js-editor").val().split("\n//").filter((function(t){return t.startsWith("<")}));this.getEditedJsFromStr(t),this.closeDia()}},{key:"getEditedJsFromStr",value:function(t){for(var e=t,n=e.length,o=0;o<n;o+=6){var a=this.splitNameFromStr(e[o+1]);e[o].startsWith("<Document-Actions>")&&(a=this.splitNameFromStr(e[o+1],"action"));var i=e[o+3].split("**--\x3e\n")[1];e[o].startsWith("<Document-Level>")?this.saveJsToSource("level",a,i):e[o].startsWith("<Document-Actions>")?this.saveJsToSource("action",a,i):e[o].startsWith("<AcroForm>")&&this.saveJsToSource("form",a,i)}}},{key:"saveJsToSource",value:function(t,e,n){var o=this;return m((function(){var a,i,r,c,l,s,u,d,f,v,p,m,h,y,b,j,_,x,k;return g(this,(function(g){switch(g.label){case 0:return"level"!==t?[3,2]:[4,o.pdfUI.getCurrentPDFDoc()];case 1:a=g.sent(),i=!0,r=!1,c=void 0;try{for(l=o.docJsList[Symbol.iterator]();!(i=(s=l.next()).done);i=!0)if((u=s.value).name===e){u.content=n,u.jsNameTree&&(a.info.jsNameTree[e]=n);break}}catch(t){r=!0,c=t}finally{try{i||null==l.return||l.return()}finally{if(r)throw c}}return window.localStorage.setItem("DOCUMENT_JAVASCRIPT_LIST",JSON.stringify(o.docJsList.filter((function(t){return!t.jsNameTree})))),[3,3];case 2:if("action"===t){d=!0,f=!1,v=void 0;try{for(p=o.docActionList[Symbol.iterator]();!(d=(m=p.next()).done);d=!0)if((h=m.value).name===e){h.content=n;break}}catch(t){f=!0,v=t}finally{try{d||null==p.return||p.return()}finally{if(f)throw v}}window.localStorage.setItem("DOCUMENT_ACTION_LIST",JSON.stringify(o.docActionList))}else if("form"===t){y=!0,b=!1,j=void 0;try{for(_=o.jsUsedAnnotActionList[Symbol.iterator]();!(y=(x=_.next()).done);y=!0)if(k=x.value,o.getActionTitleName(k).titleStr===e){o.getActionInAnnot(k).setScript(n);break}}catch(t){b=!0,j=t}finally{try{y||null==_.return||_.return()}finally{if(b)throw j}}}g.label=3;case 3:return[2]}}))}))()}},{key:"splitNameFromStr",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=t.split("</ACRO_source>")[0].split("<ACRO_source>")[1];if("action"===e){var o=n.split(":")[0],a=this.pdfUI.i18n.t("javascript-form:document-action.dialog.doc-did-save"),i=this.pdfUI.i18n.t("javascript-form:document-action.dialog.doc-did-saved"),r=this.pdfUI.i18n.t("javascript-form:document-action.dialog.doc-did-print"),c=this.pdfUI.i18n.t("javascript-form:document-action.dialog.doc-did-printed");return o===i?a:o===c?r:o}return n}},{key:"goTo",value:function(){var t=this;return m((function(){return g(this,(function(e){switch(e.label){case 0:return[4,t.pdfUI.openDialog("go-to-line-dialog")];case 1:return e.sent().show(),[2]}}))}))()}},{key:"destroy",value:function(){var t=this;h(l(a.prototype),"destroy",this).call(this),z("#all-js-editor").off("click keyup focus",(function(e){return t.editorEventHandler(e)})),this.pdfUI.eventEmitter.off("goToLineNumber",this.getGoToLIneNum)}}],[{key:"getName",value:function(){return"edit-all-javascript-dialog"}}]),a}(d.SeniorComponentFactory.createSuperClass({template:V()()}));const q=G;var Q=o(12),X=o.n(Q),Y=function(t){c(o,t);var n=u(o);function o(){for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];var r;return e(this,o),(r=n.call.apply(n,[this].concat(k(a)))).inputNum="",r}return i(o,[{key:"mounted",value:function(){h(l(o.prototype),"mounted",this).call(this)}},{key:"show",value:function(){h(l(o.prototype),"show",this).call(this),this.inputNum="",this.localize(),this.controller.digest()}},{key:"closeDia",value:function(){this.hide()}},{key:"okHandle",value:function(){var t=this.inputNum;""!==t&&0!==Number(t)?(this.pdfUI.eventEmitter.emit("goToLineNumber",Number(this.inputNum)),this.closeDia()):this.closeDia()}},{key:"inputHandleChange",value:function(t){var e=t.target.value;this.inputNum=e.replace(/[^0-9]/g,""),this.inputNum=0===Number(this.inputNum)?"":this.inputNum,this.controller.digest()}}],[{key:"getName",value:function(){return"go-to-line-dialog"}}]),o}(d.SeniorComponentFactory.createSuperClass({template:X()()}));const Z=Y;var tt=o(59),et=o.n(tt),nt=d.vendors.jQuery,ot=d.PDFViewCtrl.PDF.actions.JavaScriptAction,at=function(n){c(a,n);var o=u(a);function a(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e(this,a),o.call.apply(o,[this].concat(k(n)))}return i(a,[{key:"mounted",value:function(){var e=this;h(l(a.prototype),"mounted",this).call(this),this.$element=nt(this.element),this.pdfUI.pdfViewer.JSEngine.setConsoleImpl({clear:function(){console.log("clear")},show:function(){return e.show()},println:function(n){t(n,Object)&&(n=n.toString());var o=nt("#fv__ui-console-results",e.$element),a=o.val()+"\n";o.val(a+n+"\n")},hide:function(){return e.hide()}})}},{key:"show",value:function(){h(l(a.prototype),"show",this).call(this),this.$element.find(".script-container").val(""),this.syncLine(""),this.bindEvent()}},{key:"bindEvent",value:function(){var t=this,e=nt(".script-container",this.$element),n=nt(".line-container",this.$element);e.on("change keyup",(function(e){if(t.syncLine(e.target.value),37==e.keyCode||39==e.keyCode)return e.stopPropagation(),!1})).on("scroll",(function(t){n[0].scrollTop=e[0].scrollTop}))}},{key:"syncLine",value:function(t){for(var e=t.split("\n"),n=nt(".line-container",this.$element),o="",a=0;a<e.length;a++){for(var i=""+a;i.length<5;)i="0"+i;a!=(o+=i)-1&&(o+="\r\n")}n.val(o);var r=nt(".script-container",this.$element);n[0].scrollTop=r[0].scrollTop}},{key:"substringError",value:function(t,e,n){return t.toString().substring(e,t.toString().indexOf(n))}},{key:"handleRun",value:function(){var t=this,e=nt(".script-container",this.$element).val(),n=pdfui.i18n.t("javascript-form:javascript-console.dialog.exec"),o=pdfui.i18n.t("javascript-form:javascript-console.dialog.fail"),a=pdfui.i18n.t("javascript-form:javascript-console.dialog.success"),i=new ot;i.setScript(e),pdfui.getPDFDocRender().then((function(e){var r,c=e.getFormRender().execAction(i.getType(),i,null,e.pdfViewer.JSEngine.cacheJSDoc,"Exec",{});if(c&&-1===c.ret){var l=c.errorInfo.stack.split("\n")[1].match(/<anonymous>:(\d*):\d*/);r="======== ".concat(n," ======== \n [").concat(o," ").concat(l?l[1]-1:"1"," {").concat(t.substringError(c.errorInfo,0,":"),"}] ").concat(c.errorInfo.toString().substring(c.errorInfo.toString().indexOf(":")))}else r="======== ".concat(n," ======== \n ").concat(a);var s=nt("#fv__ui-console-results",t.$element),u=s.val()+"\n";s.val(u+r+"\n"),s[0].scrollTop=s[0].scrollHeight}))}},{key:"handleClear",value:function(t){nt("#fv__ui-console-results",this.$element).val("")}},{key:"handleClose",value:function(t){this.hide()}},{key:"checkTxt",value:function(t){}},{key:"handleCheckboxClick",value:function(t){console.log(t)}},{key:"showExecuteResults",value:function(){}}],[{key:"getName",value:function(){return"javascript-console-dialog"}}]),a}(d.SeniorComponentFactory.createSuperClass({template:et()()}));const it=at;var rt=function(t){c(o,t);var n=u(o);function o(){return e(this,o),n.apply(this,arguments)}return i(o,[{key:"init",value:function(t){var e=function(e){t.registerDialog(e,(function(a){return n[i=e]?Promise.resolve(n[i]):t.getComponentByName("template-container").then((function(t){return n[i]=t.append(o[i])}));var i}))},n=this;this.pdfUI=t;var o={"document-javascript-dialog":'<javascript-form:document-javascript-dialog name="document-javascript-dialog"></javascript-form:document-javascript-dialog>',"document-action-dialog":'<javascript-form:document-action-dialog name="document-action-dialog"></javascript-form:document-action-dialog>',"javascript-console-dialog":'<javascript-form:javascript-console-dialog name="javascript-console-dialog"></javascript-form:javascript-console-dialog>',"edit-all-javascript-dialog":'<javascript-form:edit-all-javascript-dialog name="edit-all-javascript-dialog"></javascript-form:edit-all-javascript-dialog>',"go-to-line-dialog":'<javascript-form:go-to-line-dialog name="go-to-line-dialog"></javascript-form:go-to-line-dialog>'};for(var a in o)e(a)}},{key:"fragments",value:function(){return[]}}],[{key:"getName",value:function(){return"javascript-form"}},{key:"getLoader",value:function(){return v()}},{key:"initOnLoad",value:function(){var t=d.modular.module("javascript-form",[]);[L,$,it,q,Z,A,w,b,y,j].forEach((function(e){return t.registerComponent(e)}))}}]),o}(d.UIXAddon)})(),a=a.default})()));