!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("UIExtension"),require("UIExtension").PDFViewCtrl.commons):"function"==typeof define&&define.amd?define(["UIExtension",["UIExtension","PDFViewCtrl","commons"]],t):"object"==typeof exports?exports.PageEditor=t(require("UIExtension"),require("UIExtension").PDFViewCtrl.commons):e.PageEditor=t(e.UIExtension,e.UIExtension.PDFViewCtrl.commons)}(self,((e,t)=>(()=>{var n={395:(e,t,n)=>{var r=n(779);e.exports=function(e){"use strict";var t="",n=(e=e||{}).AdditionalFamilies,o=e.index,a=e.item,i=r.$escape;t+='<layer \nclass="fv__ui-PE-props-dialog center websdk-modal"\n@draggable \n@controller="page-editor:PropsDialogController as ctrl"\nname="pageEditorProps"\n>\n<layer-header></layer-header>\n<layer-view @stop-drag>\n<div class="fv__ui-PE-props-nav" name="PE-props-tabs" @alt.menu=">::activated()">\n<gtab name="general-tab" group="PE-props-tab" body="PE-props-general" text="page-editor:general.title" active></gtab>\n<gtab name="text-ap-tab" @show="ctrl.getActiveType()==1" group="PE-props-tab" body="PE-props-text-ap" text="page-editor:textAp.title"></gtab>\n<gtab name="path-ap-tab" @show="ctrl.getActiveType()==2" group="PE-props-tab" body="PE-props-path-ap" text="page-editor:textAp.title"></gtab>\n<gtab name="image-ap-tab" @show="ctrl.getActiveType()==3" group="PE-props-tab" body="PE-props-image-ap" text="page-editor:textAp.title"></gtab>\n</div>\n<div class="fv__ui-PE-props-bodies" name="PE-props-bodies">\n<div class="PE-props-general" name="PE-props-general">\n<div class="d_f fv__ui-PE-props-item">\n<div class="PE-general-input inchesPostfix">\n<label>page-editor:general.posx</label>\n<input \n@on.blur="ctrl.blurInput" \n@on.focus="ctrl.focusInput" \n@model="ctrl.positionX|page-editor:format_number($component)"\n@stop-propagation="keydown,keyup"\n></input>\n</div>\n<div class="PE-general-input inchesPostfix">\n<label>page-editor:general.posy</label>\n<input \n@on.blur="ctrl.blurInput" \n@on.focus="ctrl.focusInput" \n@model="ctrl.positionY|page-editor:format_number($component)" \n@stop-propagation="keydown,keyup"\n></input>\n</div>\n</div>\n<div class="d_f fv__ui-PE-props-item">\n<div class="PE-general-input inchesPostfix">\n<label>page-editor:general.width</label>\n<input\nname="width"\nclass="rangeLimit"\nmin=0\n@on.blur="ctrl.blurInput"\n@on.focus="ctrl.focusInput"\n@model="ctrl.width|page-editor:format_number($component)"\n@stop-propagation="keydown,keyup"\n></input>\n</div>\n<div class="PE-general-input inchesPostfix">\n<label>page-editor:general.height</label>\n<input\nname="height"\nclass="rangeLimit"\nmin=0\n@on.blur="ctrl.blurInput"\n@on.focus="ctrl.focusInput"\n@model="ctrl.height|page-editor:format_number($component)"\n@stop-propagation="keydown,keyup"\n></input>\n</div>\n',t+='\n</div>\n<div class="d_f fv__ui-PE-props-item">\n<div class="PE-general-input PE-noMargin">\n<label>page-editor:general.scalex</label>\n<input \n@on.blur="ctrl.blurInput"\nclass="rangeLimit"\nmin=0 \nmax=10000 \ndata-dir=\'horizon\'\n@on.focus="ctrl.focusInput"\n@model="ctrl.scaleX|page-editor:format_number($component)"\n@stop-propagation="keydown,keyup"\n></input>\n</div>\n<div class="PE-general-input">\n<label>page-editor:general.scaley</label>\n<input\n@on.blur="ctrl.blurInput"\nclass="rangeLimit"\nmin=0\nmax=10000\n@on.focus="ctrl.focusInput"\n@model="ctrl.scaleY|page-editor:format_number($component)"\n@stop-propagation="keydown,keyup"\n></input>\n</div>\n</div>\n</div>\n<div name="PE-props-text-ap" style="cursor: initial;">\n<div class="PE-general-input fullWidth">\n<label>page-editor:textAp.fontName</label>\n<select class="PE-fillInput" name="PE-fontName">\n<option>Courier</option>\n<option>Helvetica</option>\n<option>Times Roman</option>\n<option>Symbol</option>\n<option>ZapfDingbats</option>\n',n=n||[];for(o=0;o<n.length;o++){t+="\n<option value='",t+=i((a=n[o]).family),t+="'>",t+=i(a.name),t+="</option>\n"}return t+='\n</select>\n</div>\n<div class="PE-general-input">\n<label>page-editor:textAp.fontSize</label>\n<input @on.blur="ctrl.fontSizeBlur" type="number" class="rangeLimit" min=1 max=9999 @model="ctrl.fontSize" data-i18n="[title]page-editor:textAp.fontSizeRangeLimit" name="PE-fontSize"></input>\n</div>\n<div class="PE-general-input PE-horizonScale">\n<label>page-editor:textAp.HScale</label>\n<input type="number" class="rangeLimit" min=1 max=1000 @model="ctrl.horizonScale" data-i18n="[title]page-editor:textAp.HScaleRangeLimit" name="PE-horizonScale"></input>\n<span>%</span>\n</div>\n<div class="PE-general-input">\n<label>page-editor:textAp.charSpace</label>\n<input type="number" class="rangeLimit" min=0 max=32 @model="ctrl.charSpace" data-i18n="[title]page-editor:textAp.charSpaceRangeLimit" name="PE-charSpace"></input>\n</div>\n<div class="PE-general-input">\n<label>page-editor:textAp.wordSpace</label>\n<input type="number" class="rangeLimit" min=0 max=32 @model="ctrl.wordSpace" class="PE-w100px" data-i18n="[title]page-editor:textAp.wordSpaceRangeLimit" name="PE-wordSpace"></input>\n</div>\n\n<div class="PE-general-input fullWidth">\n<label>page-editor:textAp.textMode</label>\n<select class="PE-fillInput" name="PE-textMode">\n<option value="0">page-editor:textAp.fillText</option>\n<option value="1">page-editor:textAp.strokeText</option>\n<option value="2">page-editor:textAp.fillStrokeText</option>\n<option value="3">page-editor:textAp.invisible</option>\n</select>\n</div>\n\n<div class="PE-general-input fullWidth offsetTop" name="PE-textStrokeColor">\n<label>page-editor:textAp.strokeColor</label>\n<select>\n<option value="2">RGB</option>\n<option value="3">CMYK</option>\n<option value="1">page-editor:textAp.gray</option>\n</select>\n<div class="color-picker" @on.click="ctrl.showCP(\'PE-textStrokeColor\')"><div class="color"></div></div>\n<slider class="PE-slider"\n@model="ctrl.strokeGray" max="1" min="0" step="0.1" value="1" name="PE-stroke-slider" @stop-drag hideinput="true"></slider>\n</div>\n\n<div class="PE-general-input fullWidth offsetTop" name="PE-textFillColor">\n<label>page-editor:textAp.fillColor</label>\n<select>\n<option value="2">RGB</option>\n<option value="3">CMYK</option>\n<option value="1">page-editor:textAp.gray</option>\n</select>\n<div class="color-picker" @on.click="ctrl.showCP(\'PE-textFillColor\')"><div class="color"></div></div>\n<slider class="PE-slider"\n@model="ctrl.fillGray" max="1" min="0" step="0.1" value="1" name="PE-fill-slider" @stop-drag hideinput="true"></slider>\n</div>\n\n<div class="PE-general-input fullWidth"  name="opacity">\n<label>page-editor:textAp.opacity</label>\n<input min="0" value="100" max="100" type="number" @model="ctrl.opacity" name="PE-opacity"></input>\n<span>%</span>\n<slider class="PE-slider"\n@model="ctrl.opacity"\nmax="100" min="0" step="1" value="100" name="PE-opacity-slider" @stop-drag hideinput="true"></slider>\n</div>\n</div>\n<div name="PE-props-path-ap" style="cursor: initial;">\n<div class="PE-general-input fullWidth offsetTop" name="PE-pathStrokeColor">\n<label>page-editor:textAp.lineColor</label>\n<select>\n<option value=0>page-editor:textAp.noColor</option>\n<option value=2>RGB</option>\n<option value=3>CMYK</option>\n<option value=1>page-editor:textAp.gray</option>\n</select>\n<div class="color-picker" @aria:role="button" tabindex="0" @on.click="ctrl.showCP(\'PE-pathStrokeColor\')" @on.native.keydown="ctrl.keyBoardHandler($event,\'PE-pathStrokeColor\')"><div class="color"></div></div>\n<slider class="PE-slider"\n@model="ctrl.strokeGray" max="1" min="0" step="0.1" value="1" name="PE-stroke-slider" @stop-drag hideinput="true"></slider>\n</div>\n\n<div class="PE-general-input fullWidth offsetTop" name="PE-pathFillColor">\n<label>page-editor:textAp.fillColor</label>\n<select>\n<option value=0>page-editor:textAp.noColor</option>\n<option value=2>RGB</option>\n<option value=3>CMYK</option>\n<option value=1>page-editor:textAp.gray</option>\n</select>\n<div class="color-picker" @aria:role="button" tabindex="0" @on.click="ctrl.showCP(\'PE-pathFillColor\')" @on.native.keydown="ctrl.keyBoardHandler($event,\'PE-pathFillColor\')"><div class="color"></div></div>\n<slider class="PE-slider"\n@model="ctrl.fillGray" max="1" min="0" step="0.1" value="1" name="PE-fill-slider" @stop-drag hideinput="true"></slider>\n</div>\n\n<div class="PE-general-input">\n<label>page-editor:textAp.lineWidth</label>\n<number type="number" min=0.1 max=1000 step=0  @model="ctrl.lineWidth"></number>\n</div>\n<div class="PE-general-input">\n<label>page-editor:textAp.Dashed</label>\n<choice class="fv__property-component PE-lineStyle" name="PE-lineStyle" @aria:labelledby="::previousSiblings()"></choice>\n</div>\n\n<div class="PE-general-input">\n<label>page-editor:textAp.miterLimit</label>\n<number type="number" min=0 max=1000 @model="ctrl.miterLimit"></number>\n</div>\n<div class="PE-general-input">\n<label>page-editor:textAp.capStyle</label>\n<select name="PE-lineCap" class="PE-w100px">\n<option value="2">page-editor:textAp.project</option>\n<option value="1">page-editor:textAp.round</option>\n<option value="0">page-editor:textAp.butt</option>\n</select>\n</div>\n\n<div class="PE-general-input PE-fillInput">\n<label>page-editor:textAp.joinStyle</label>\n<select name="PE-lineJoin">\n<option value="1">page-editor:textAp.round</option>\n<option value="2">page-editor:textAp.bevel</option>\n<option value="0">page-editor:textAp.miter</option>\n</select>\n</div>\n\n<div class="PE-general-input fullWidth" name="opacity">\n<label>page-editor:textAp.opacity</label>\n<input  min="0" max="100" value="100" type="number" \n@model="ctrl.opacity"></input>\n<span>%</span>\n<slider class="PE-slider" \n@model="ctrl.opacity" max="100" min="0" step="1" value="100" name="PE-opacity-slider" @stop-drag hideinput="true"></slider>\n</div>\n</div>\n<div name="PE-props-image-ap" style="cursor: initial;">\n<div class="PE-general-input fullWidth" name="opacity">\n<label>page-editor:textAp.opacity</label>\n<input\ntype="number"\nmin=0 \nmax=100\n@model="ctrl.opacity"></input>\n<span>%</span>\n<slider class="PE-slider"\n@model="ctrl.opacity"\n max="100" min="0" step="1" value="100" name="PE-opacity-slider" @stop-drag hideinput="true"></slider>\n</div>\n</div>\n</div>\n</layer-view>\n<layer-toolbar>\n<xbutton class="fv__ui-dialog-button fv__ui-dialog-ok-button" @on.click="ctrl.hideDialog()">dialog.close</xbutton>\n</layer-toolbar>\n</layer>'}},848:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return"\n<ribbon-button @tooltip tooltip-title=\"page-editor:addShape.title\"  name=\"create-shapeObject-dropdown\" icon-class=\"fv__icon-menu-add-shapes\" text=\"page-editor:addShape.title\" @controller=\"page-editor:AddShapesController as asc\" not-immediately=\"true\">\n<dropdown name=\"shape-drop-down-ui\" popup-class=\"fv__ui-shapes-dropdown\" separate=\"false\">\n<div class=\"fv__ui-shape-type-title\">page-editor:addShape.addPath</div>\n<dropdown-item name=\"path\">\n<xbutton icon-class='fv__icon-path-line' @on.click=\"asc.addPath('Line')\" name=\"Line\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-rect' @on.click=\"asc.addPath('Rectangle')\" name=\"Rectangle\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-roundedRect' @on.click=\"asc.addPath('RoundRect')\" name=\"RoundRect\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-circle' @on.click=\"asc.addPath('Ellipse')\" name=\"Ellipse\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-brokenLine' @on.click=\"asc.addPath('Polyline')\" name=\"Polyline\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-pentagonal' @on.click=\"asc.addPath('Polygon')\" name=\"Polygon\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-curve' @on.click=\"asc.addPath('Polybezier')\" name=\"Polybezier\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-closedCurve' @on.click=\"asc.addPath('Curve')\" name=\"Curve\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-closedIrregularFigure' @on.click=\"asc.addPath('Freedom')\" name=\"Freedom\" tabindex='0'></xbutton>\n</dropdown-item>\n<div class=\"fv__ui-shape-type-title\">page-editor:addShape.addShading</div>\n<dropdown-item name=\"shading\">\n<xbutton icon-class='fv__icon-shading-rect' @on.click=\"asc.addShading('Rectangle')\" name=\"Rectangle\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-shading-roundedRect' @on.click=\"asc.addShading('RoundRect')\" name=\"RoundRect\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-shading-circle' @on.click=\"asc.addShading('Ellipse')\" name=\"Ellipse\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-shading-brokenLine' @on.click=\"asc.addShading('Polyline')\" name=\"Polyline\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-shading-Pentagonal' @on.click=\"asc.addShading('Polygon')\" name=\"Polygon\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-shading-curve' @on.click=\"asc.addShading('Polybezier')\" name=\"Polybezier\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-shading-closedCurve' @on.click=\"asc.addShading('Curve')\" name=\"Curve\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-shading-closedIrregularFigure' @on.click=\"asc.addShading('Freedom')\" name=\"Freedom\" tabindex='0'></xbutton>\n</dropdown-item>\n</dropdown>\n</ribbon-button>","\n<ribbon-button @tooltip tooltip-title=\"page-editor:addShape.title\"  name=\"create-shapeObject-dropdown\" icon-class=\"fv__icon-menu-add-shapes\" text=\"page-editor:addShape.title\" @controller=\"page-editor:AddShapesController as asc\" not-immediately=\"true\">\n<dropdown name=\"shape-drop-down-ui\" popup-class=\"fv__ui-shapes-dropdown\" separate=\"false\">\n<div class=\"fv__ui-shape-type-title\">page-editor:addShape.addPath</div>\n<dropdown-item name=\"path\">\n<xbutton icon-class='fv__icon-path-line' @on.click=\"asc.addPath('Line')\" name=\"Line\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-rect' @on.click=\"asc.addPath('Rectangle')\" name=\"Rectangle\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-roundedRect' @on.click=\"asc.addPath('RoundRect')\" name=\"RoundRect\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-circle' @on.click=\"asc.addPath('Ellipse')\" name=\"Ellipse\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-brokenLine' @on.click=\"asc.addPath('Polyline')\" name=\"Polyline\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-pentagonal' @on.click=\"asc.addPath('Polygon')\" name=\"Polygon\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-curve' @on.click=\"asc.addPath('Polybezier')\" name=\"Polybezier\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-closedCurve' @on.click=\"asc.addPath('Curve')\" name=\"Curve\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-path-closedIrregularFigure' @on.click=\"asc.addPath('Freedom')\" name=\"Freedom\" tabindex='0'></xbutton>\n</dropdown-item>\n<div class=\"fv__ui-shape-type-title\">page-editor:addShape.addShading</div>\n<dropdown-item name=\"shading\">\n<xbutton icon-class='fv__icon-shading-rect' @on.click=\"asc.addShading('Rectangle')\" name=\"Rectangle\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-shading-roundedRect' @on.click=\"asc.addShading('RoundRect')\" name=\"RoundRect\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-shading-circle' @on.click=\"asc.addShading('Ellipse')\" name=\"Ellipse\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-shading-brokenLine' @on.click=\"asc.addShading('Polyline')\" name=\"Polyline\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-shading-Pentagonal' @on.click=\"asc.addShading('Polygon')\" name=\"Polygon\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-shading-curve' @on.click=\"asc.addShading('Polybezier')\" name=\"Polybezier\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-shading-closedCurve' @on.click=\"asc.addShading('Curve')\" name=\"Curve\" tabindex='0'></xbutton>\n<xbutton icon-class='fv__icon-shading-closedIrregularFigure' @on.click=\"asc.addShading('Freedom')\" name=\"Freedom\" tabindex='0'></xbutton>\n</dropdown-item>\n</dropdown>\n</ribbon-button>"}},442:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return'<ribbon-button name="edit-object-ribbon-dropdown" @tooltip tooltip-title="page-editor:editObject.title" text="page-editor:editObject.title" icon-class="fv__icon-menu-edit" not-immediately="true" class="edit-object-ribbon-dropdown" @controller="page-editor:EditObjectController as eord">\n<dropdown separate="false">\n<dropdown-button @on.click="eord.setEditType(\'All\')" name="All" icon-class=\'fv__ui-button-icon fv__ui-property-icon-selected-color-light\'>page-editor:editObject.all</dropdown-button>\n<dropdown-button @on.click="eord.setEditType(\'Text\')" name="Text" icon-class=\'fv__ui-button-icon fv__ui-property-icon-selected-color-light\'>page-editor:editObject.text</dropdown-button>\n<dropdown-button @on.click="eord.setEditType(\'Image\')" name="Image" icon-class=\'fv__ui-button-icon fv__ui-property-icon-selected-color-light\'>page-editor:editObject.image</dropdown-button>\n<dropdown-button @on.click="eord.setEditType(\'Path\')" name="Path" icon-class=\'fv__ui-button-icon fv__ui-property-icon-selected-color-light\'>page-editor:editObject.shape</dropdown-button>\n<dropdown-button @on.click="eord.setEditType(\'Shading\')" name="Shading" icon-class=\'fv__ui-button-icon fv__ui-property-icon-selected-color-light\'>page-editor:editObject.shading</dropdown-button>\n</dropdown>\n</ribbon-button>','<ribbon-button name="edit-object-ribbon-dropdown" @tooltip tooltip-title="page-editor:editObject.title" text="page-editor:editObject.title" icon-class="fv__icon-menu-edit" not-immediately="true" class="edit-object-ribbon-dropdown" @controller="page-editor:EditObjectController as eord">\n<dropdown separate="false">\n<dropdown-button @on.click="eord.setEditType(\'All\')" name="All" icon-class=\'fv__ui-button-icon fv__ui-property-icon-selected-color-light\'>page-editor:editObject.all</dropdown-button>\n<dropdown-button @on.click="eord.setEditType(\'Text\')" name="Text" icon-class=\'fv__ui-button-icon fv__ui-property-icon-selected-color-light\'>page-editor:editObject.text</dropdown-button>\n<dropdown-button @on.click="eord.setEditType(\'Image\')" name="Image" icon-class=\'fv__ui-button-icon fv__ui-property-icon-selected-color-light\'>page-editor:editObject.image</dropdown-button>\n<dropdown-button @on.click="eord.setEditType(\'Path\')" name="Path" icon-class=\'fv__ui-button-icon fv__ui-property-icon-selected-color-light\'>page-editor:editObject.shape</dropdown-button>\n<dropdown-button @on.click="eord.setEditType(\'Shading\')" name="Shading" icon-class=\'fv__ui-button-icon fv__ui-property-icon-selected-color-light\'>page-editor:editObject.shading</dropdown-button>\n</dropdown>\n</ribbon-button>'}},683:e=>{e.exports=null},585:(e,t,n)=>{"use strict";
/*! art-template@runtime | https://github.com/aui/art-template */var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},o=Object.create(r),a=/["&'<>]/;function i(e){return"string"!=typeof e&&(e=null==e?"":"function"==typeof e?i(e.call(e)):JSON.stringify(e)),e}o.$escape=function(e){return function(e){var t=""+e,n=a.exec(t);if(!n)return e;var r="",o=void 0,i=void 0,c=void 0;for(o=n.index,i=0;o<t.length;o++){switch(t.charCodeAt(o)){case 34:c="&#34;";break;case 38:c="&#38;";break;case 39:c="&#39;";break;case 60:c="&#60;";break;case 62:c="&#62;";break;default:continue}i!==o&&(r+=t.substring(i,o)),i=o+1,r+=c}return i!==o?r+t.substring(i,o):r}(i(e))},o.$each=function(e,t){if(Array.isArray(e))for(var n=0,r=e.length;n<r;n++)t(e[n],n);else for(var o in e)t(e[o],o)},e.exports=o},779:(e,t,n)=>{"use strict";e.exports=n(585)},297:e=>{e.exports="data:image/png;charset=utf-8;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGCAYAAADgzO9IAAAAN0lEQVR42m3NMQ7AMBACweH+/2dSOLIdKZSrBdIWJCm0DcyBRbcQvPBOVuMvszbzsdtmzmE2hAeBeRkFLldufwAAAABJRU5ErkJggg=="},945:e=>{e.exports="data:image/png;charset=utf-8;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGCAYAAADgzO9IAAAANUlEQVR42m2NSQrAQBCEtP//Z3NImAXiUSzKCgA1gEqAWTKgHQi88sRv8cdU4l1Xzjp0S4AHhHsZBRHojyUAAAAASUVORK5CYII="},649:e=>{e.exports="data:image/png;charset=utf-8;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAW0lEQVR42rXQsQ3AIAxE0X8oG9BSsv9ElLTMcCkiJxQkoslVtvRkW5ZtIpKeBrCtqI8ZjVJnhyQHTm8IYJR6bxGwRHNyb9fEnfwAbSv39nmfbaX41woHAtDuw09owS/ec9h8cQAAAABJRU5ErkJggg=="},665:e=>{e.exports="data:image/png;charset=utf-8;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADBUlEQVR42tVXS27TUBQ99zngIJXiBSBhVkA6wskEdwUQBSExol1B3CQTRnFmDPpxV5AyqkSVul1BzIREYtCwgroSCzBVB2mVvMsgpYodx83HQnBntt675/jcr4H/yQzrUE/bp5jrNKl2oXZ8Vqi0NtIiQPMcfllxLUG8d/voE3NDyhuv67z3/4oCgobjQDoTNUlRzwtVt7loeGZSwLSa2o3QykxsAdCmn+STzk6pmKoC+epp+Vp5cs7EdiI4wx8MRWMycY/MhQkUam4dGDrJXz0CZ0nr351iLwReOzJJUdqFilufm0Ch5taZ2b5PIQY8VdJa1yn6k/FV6gDAxPY0ErE5YFRaG0TUjLwOQNzAkHQIlEfg8nN3521sSRq1I5NYaYfZ8lZnt+QkKmBYhzoR1SckHtJaZ7vkMHFv5Isb08ABAIOMD0ZYFaK6aTe1RAKkPLABjJdUwJLW7yQW0memze5uKTE8Xafos6R1AMHYa61/uWpNDYFhHeqkqOdhRrzV2Q7LNo/lKy0LRHvjH6Q+/vXcszeDSQXEQzMq/TLgAHAb85AK15erG7EhEOA3kRzfT6PfM4X9EMSL+BwQ4lnoopC9dEaO9CKEzFgCzMiNP2dXrlIhkB1kon60mTrhn0RZ1jynGMxKIHQwWrOLmmm52qytOESgf7WSS4NAPzOI+unF54DE13DuCDOVKpCZXCTXLuIJEPXCnZPKqex9xOVIuZ/EEngkcRBtGvlKy1oGPF89LUdaO6QUXiwBzykG0aYBovqi69bo3tAONyE6GB/dYrJmxUTrJEVtz0vidq60Q8sMw5dDNBKnoecUAzBHVyudFPVs1nDkq6dlUtSzqPQEbkQXl6lLqVFr2cQUt8X4YN5nIXvZwVXPczYD02pqfazkhMi8mra4MnMjboQnbsUJJOYrwyngAKAkXfz57Yv3NP/ugkA5EBbpigGIP3Z3Sp+W+i8wLFeHwjYBH2YFZuL97EA4MXNg8V8zw3J1CGkSidcA68Dd9AwYCATIY5Y/VCkO7gP+Z+w3g7JLOd6W0HAAAAAASUVORK5CYII="},705:(e,t,n)=>{var r=n(639).Symbol;e.exports=r},239:(e,t,n)=>{var r=n(705),o=n(607),a=n(333),i=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?o(e):a(e)}},561:(e,t,n)=>{var r=n(990),o=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(o,""):e}},957:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},607:(e,t,n)=>{var r=n(705),o=Object.prototype,a=o.hasOwnProperty,i=o.toString,c=r?r.toStringTag:void 0;e.exports=function(e){var t=a.call(e,c),n=e[c];try{e[c]=void 0;var r=!0}catch(e){}var o=i.call(e);return r&&(t?e[c]=n:delete e[c]),o}},333:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},639:(e,t,n)=>{var r=n(957),o="object"==typeof self&&self&&self.Object===Object&&self,a=r||o||Function("return this")();e.exports=a},990:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},279:(e,t,n)=>{var r=n(218),o=n(771),a=n(841),i=Math.max,c=Math.min;e.exports=function(e,t,n){var l,s,u,p,d,g,h=0,f=!1,v=!1,m=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function b(t){var n=l,r=s;return l=s=void 0,h=t,p=e.apply(r,n)}function y(e){var n=e-g;return void 0===g||n>=t||n<0||v&&e-h>=u}function P(){var e=o();if(y(e))return C(e);d=setTimeout(P,function(e){var n=t-(e-g);return v?c(n,u-(e-h)):n}(e))}function C(e){return d=void 0,m&&l?b(e):(l=s=void 0,p)}function S(){var e=o(),n=y(e);if(l=arguments,s=this,g=e,n){if(void 0===d)return function(e){return h=e,d=setTimeout(P,t),f?b(e):p}(g);if(v)return clearTimeout(d),d=setTimeout(P,t),b(g)}return void 0===d&&(d=setTimeout(P,t)),p}return t=a(t)||0,r(n)&&(f=!!n.leading,u=(v="maxWait"in n)?i(a(n.maxWait)||0,t):u,m="trailing"in n?!!n.trailing:m),S.cancel=function(){void 0!==d&&clearTimeout(d),h=0,l=g=s=d=void 0},S.flush=function(){return void 0===d?p:C(o())},S}},218:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},5:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},448:(e,t,n)=>{var r=n(239),o=n(5);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==r(e)}},771:(e,t,n)=>{var r=n(639);e.exports=function(){return r.Date.now()}},841:(e,t,n)=>{var r=n(561),o=n(218),a=n(448),i=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,l=/^0o[0-7]+$/i,s=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(a(e))return NaN;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=c.test(e);return n||l.test(e)?s(e.slice(2),n?2:8):i.test(e)?NaN:+e}},616:t=>{"use strict";t.exports=e},732:e=>{"use strict";e.exports=t}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var a=r[e]={exports:{}};return n[e](a,a.exports,o),a.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};return(()=>{"use strict";o.d(a,{default:()=>ja});var e={};function t(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function n(e){return function(){var n=this,r=arguments;return new Promise((function(o,a){var i=e.apply(n,r);function c(e){t(i,o,a,c,l,"next",e)}function l(e){t(i,o,a,c,l,"throw",e)}c(void 0)}))}}function r(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):r(e,t)}function i(e,t){if(!r(e,t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function p(e,t,n){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n||e):o.value}},p(e,t,n||e)}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,c=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(c)throw o}}return a}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return b(this,n)}}o.r(e),o.d(e,{ArrangeAlignmentOptions:()=>ma,ArrangeDistributeOptions:()=>ba,ArrangeFlipOptions:()=>Pa,ArrangePagecenterOptions:()=>va,ArrangeRotateOptions:()=>ya,ArrangeZorderOptions:()=>Ca});function P(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;var C=o(616),S=o(683),E=o.n(S);const w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(i(this,e),"function"==typeof t.transformRect){var l=t;t=l.a,n=l.b,r=l.c,o=l.d,a=l.e,c=l.f}else if(Array.isArray(t)){var s=t;t=s[0],n=s[1],r=s[2],o=s[3],a=s[4],c=s[5]}this.a=t,this.b=n,this.c=r,this.d=o,this.e=a,this.f=c}return l(e,[{key:"set",value:function(e,t,n,r,o,a){this.a=e,this.b=t,this.c=n,this.d=r,this.e=o,this.f=a}},{key:"reset",value:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}},{key:"reverse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=t.a*t.d-t.b*t.c;if(0==n)return t;var r=-n;return new e(t.d/n,t.b/r,t.c/r,t.a/n,(t.c*t.f-t.d*t.e)/n,(t.a*t.f-t.b*t.e)/r)}},{key:"setReverse",value:function(e){var t=this.reverse(e);this.set(t.a,t.b,t.c,t.d,t.e,t.f)}},{key:"rotate",value:function(t,n){var r,o=Math.cos(t),a=Math.sin(t),i=new e(o,a,-a,o,0,0);r=n?e.Concat2mt(i,this):e.Concat2mt(this,i),this.set(r.a,r.b,r.c,r.d,r.e,r.f)}},{key:"rotateAt",value:function(e,t,n,r){this.translate(e,t,r),this.rotate(n,r),this.translate(-e,-t,r)}},{key:"translate",value:function(e,t,n){n?(this.e+=e*this.a+t*this.c,this.f+=t*this.d+e*this.b):(this.e+=e,this.f+=t)}},{key:"concat",value:function(t,n,o,a,i,c,l){var s,u;r(t,e)?(s=t,l=n):s=new e(t,n,o,a,i,c),u=l?e.Concat2mt(s,this):e.Concat2mt(this,s),this.set(u.a,u.b,u.c,u.d,u.e,u.f)}},{key:"is90Rotated",value:function(){var e=1e3*this.a;e<0&&(e*=-1);var t=1e3*this.d;t<0&&(t*=-1);var n=this.b;n<0&&(n*=-1);var r=this.c;return r<0&&(r*=-1),e<n&&t<r}},{key:"isScaled",value:function(){var e=1e3*this.b;e<0&&(e*=-1);var t=1e3*this.c;t<0&&(t*=-1);var n=this.a;n<0&&(n*=-1);var r=this.d;return r<0&&(r*=-1),e<n&&t<r}},{key:"getA",value:function(){return this.a}},{key:"getB",value:function(){return this.b}},{key:"getC",value:function(){return this.c}},{key:"getD",value:function(){return this.d}},{key:"getE",value:function(){return this.e}},{key:"getF",value:function(){return this.f}},{key:"scale",value:function(e,t,n){this.a*=e,this.d*=t,n?(this.b*=e,this.c*=t):(this.b*=t,this.c*=e,this.e*=e,this.f*=t)}},{key:"transformXDistance",value:function(e){var t=this.a*e,n=this.b*e;return Math.sqrt(t*t+n*n)}},{key:"transformYDistance",value:function(e){var t=this.c*e,n=this.d*e;return Math.sqrt(t*t+n*n)}},{key:"transformDistance",value:function(e,t){var n=this.a*e+this.c*t,r=this.b*e+this.d*t;return Math.sqrt(n*n+r*r)}},{key:"transformPoint",value:function(e,t){return[this.a*e+this.c*t+this.e,this.b*e+this.d*t+this.f]}},{key:"transformRect",value:function(e,t,n,r){for(var o,a=[e,e,n,n],i=[t,r,t,r],c=0;c<4;c++)o=this.transformPoint(a[c],i[c]),a[c]=o[0],i[c]=o[1];for(var l=[a[0],a[0],i[0],i[0]],s=1;s<4;s++)l[0]>a[s]&&(l[0]=a[s]),l[1]<a[s]&&(l[1]=a[s]),l[2]>i[s]&&(l[2]=i[s]),l[3]<i[s]&&(l[3]=i[s]);return[l[0],l[2],l[1],l[3]]}},{key:"getXUnit",value:function(){var e=this.a,t=this.b;return 0===t?Math.abs(e):0===e?Math.abs(t):Math.sqrt(e*e+t*t)}},{key:"getYUnit",value:function(){var e=this.c,t=this.d;return 0===e?Math.abs(t):0===t?Math.abs(e):Math.sqrt(e*e+t*t)}},{key:"getUnitRect",value:function(){return this.transformRect(0,0,1,1)}},{key:"matchRect",value:function(e,t){var n=t[0]-t[2];this.a=Math.abs(n)<.001?1:(e[0]-e[2])/n,n=t[3]-t[1],this.d=Math.abs(n)<.001?1:(e[3]-e[1])/n,this.e=e[0]-t[0]*this.a,this.f=e[3]-t[3]*this.d,this.b=0,this.c=0}},{key:"getAngle",value:function(){return Math.atan2(this.b,this.a)}},{key:"toArray",value:function(){return[this.a,this.b,this.c,this.d,this.e,this.f]}}],[{key:"Concat2mt",value:function(t,n){return new e(t.a*n.a+t.b*n.c,t.a*n.b+t.b*n.d,t.c*n.a+t.d*n.c,t.c*n.b+t.d*n.d,t.e*n.a+t.f*n.c+n.e,t.e*n.b+t.f*n.d+n.f)}}]),e}();var x=C.PDFViewCtrl,k=x.shared.DebounceTaskExecutor,I=x.DeviceInfo.isIOS,A=C.vendors.jQuery,_="",T=A('<input style="opacity:0;position:fixed;z-index: -1;" tabindex="-1" title="input chart"/>');A("body").append(T);var M=!1,O=new k(20);I&&(O={exec:function(e){e()}});var R=function(e,t){},D={onChar:R};T.on("compositionstart",(function(){M=!0})).on("compositionend",(function(e){M=!1,D.onChar(e.originalEvent.data,e),T.val(""),_=""})).on("input",(function(e){var t=T.val();!M&&t.length>_.length&&D.onChar(t.replace(_,""),e),M?_=t:(T.val(""),_="")})).on("keydown",(function(e){(e.shiftKey&&e.ctrlKey&&90===e.keyCode||e.ctrlKey&&89===e.keyCode)&&e.preventDefault()}));var F=function(){T.val(_="")};const j={startInput:function(e){D.onChar=e,F(),O.exec((function(){T.focus()}))},endInput:function(){D.onChar=R,O.exec((function(){D.onChar===R&&T.blur()}))},refocusInput:function(){O.exec((function(){T.focus()}))},isCompositionInput:function(){return M},getElement:function(){return T},resetValue:F,setPos:function(e,t){T.css({left:e,top:t})}};var B=UIExtension.vendors.jQuery,N=function(){function e(t){var n=this;i(this,e),s(this,"keydown",void 0),s(this,"keyup",void 0),s(this,"trace",void 0),this.trace=!0,B(document).on("keydown",this.keydown=function(e){if(n.trace){var r=e.keyCode;if(t.skipKey(r))return;if(!j.isCompositionInput())return j.resetValue(),t.keydown(e)}}).on("keyup",this.keyup=function(e){if(n.trace){var r=e.keyCode;if(t.skipKey(r))return;if(!j.isCompositionInput())return j.resetValue(),t.keyup(e)}})}return l(e,[{key:"stop",value:function(){this.trace=!1}},{key:"start",value:function(){this.trace=!0}},{key:"destroy",value:function(){B(document).off("keydown",this.keydown),B(document).off("keyup",this.keyup)}}]),e}(),U={shiftKey:1,ctrlKey:2,altKey:4,metaKey:8},L=function(e){var t=0;for(var n in U)e[n]&&(t|=U[n]);return t},V=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Down";switch(e.button){case 0:t="OnLButton"+n;break;case 1:t="OnWheelButton"+n;break;case 2:t="OnRButton"+n}return t},H={37:"up",38:"left",39:"right",40:"down",46:"Delete",67:"c",86:"v",88:"x",8:"backspace",13:"enter",27:"esc"},z=C.PDFViewCtrl.shared.dpr,$=[];function K(){var e=!0,t=!1,n=void 0;try{for(var r,o=$[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;a.parentNode.removeChild(a)}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}$=[]}function W(e,t,n){switch(t){case"font-family":e.handleEvent("OnFontNameChanged",{type:"WString",value:n});break;case"font-size":e.handleEvent("OnFontSizeChanged",Number(n));break;case"font-color":e.handleEvent("OnTextColorChanged","transparent"===(r=n)?0:parseInt("FF"+r.slice(1),16));break;case"font-bold":e.handleEvent("OnBoldItalicChanged",{type:"WString",value:""},n,!1,!0);break;case"font-italic":e.handleEvent("OnBoldItalicChanged",{type:"WString",value:""},!1,n,!1);break;case"font-underline":e.handleEvent("OnUnderlineChanged",n);break;case"font-strikethrough":e.handleEvent("OnCrossChanged",n);break;case"font-super-sub-script":"font-superscript"===n[0]?e.handleEvent("OnSuperScriptChanged",!0):"font-subscript"===n[0]?e.handleEvent("OnSubScriptChanged",!0):(e.handleEvent("OnSuperScriptChanged",!1),e.handleEvent("OnSubScriptChanged",!1));break;case"font-character-spacing":e.handleEvent("OnCharSpaceChanged",Number(n));break;case"paragraph-bullets":e.handleEvent("OnBulletedList",{type:"NumberingType",value:parseInt(n[n.length-1])});break;case"paragraph-numbering":e.handleEvent("OnNumberedList",{type:"BulletType",value:parseInt(n[n.length-1])});break;case"paragraph-align":"left"===n?e.handleEvent("OnAlignChanged",0):"center"===n?e.handleEvent("OnAlignChanged",1):"right"===n?e.handleEvent("OnAlignChanged",2):"justify"===n&&e.handleEvent("OnAlignChanged",3);break;case"paragraph-increase":e.handleEvent("OnInDentChanged");break;case"paragraph-decrease":e.handleEvent("OnDeDentChanged");break;case"paragraph-line-spacing":e.handleEvent("OnLineLeadingChanged",Number(n));break;case"paragraph-spacing":e.handleEvent("OnParagraphSpacingChanged",Number(n));break;case"paragraph-character-scale":e.handleEvent("OnCharHorzScaleChanged",parseInt(n))}var r}var G={Annotation:0,TextObject:1,PathObject:2,ImageObject:3,ShadingObject:4,FormXObject:5,TouchUp:6,Measure:7,DistanceObject:8,NoteObject:9,Drawing:10,EraserObject:11,FileObject:12,HighlightObject:13,PencilObject:14,FreeText:15},Y=UIExtension.PDFViewCtrl.FontUtil.FoxitFontMap,J={0:"page-editor:popMenu.JoinTextBoxes",1:"page-editor:popMenu.SplitTextBoxes",2:"page-editor:popMenu.LinkTextBoxes",3:"page-editor:popMenu.UnlinkTextBoxes",4:"page-editor:popMenu.SelectNone",5:"page-editor:popMenu.MaxValue",32751:"page-editor:popMenu.Undo",32752:"page-editor:popMenu.Redo",32753:"page-editor:popMenu.Cut",32754:"page-editor:popMenu.Copy",32755:"page-editor:popMenu.Paste",32756:"page-editor:popMenu.Delete",32757:"page-editor:popMenu.SelectAll",32758:"page-editor:popMenu.RightToLeft",32759:"page-editor:popMenu.LeftToRight",32760:"SuggestStart"},q=0,X=1,Q=2,Z=3,ee=4,te=5,ne={Line:0,Rectangle:1,RoundRect:2,Ellipse:3,Polyline:4,Polygon:5,Polybezier:6,Curve:7,Freedom:8},re={Invalid:0,All:1,Text:2,Image:3,Path:4,Shading:5},oe={LineCap:{1:"ProjectingSquareCap",2:"Round",3:"Butt",ProjectingSquareCap:1,Round:2,Butt:3},LineJoin:{1:"Round",2:"Bevel",3:"Miter",Round:1,Bevel:2,Miter:3}},ae={0:"None",1:"Text",2:"Path",3:"Image",4:"Shading",5:"Mixed",None:0,Text:1,Path:2,Image:3,Shading:4,Mixed:5},ie={2:"Text",3:"Image",4:"Path",5:"Shading",Text:2,Image:3,Path:4,Shading:5},ce={0:"Left",1:"Right",2:"Top",3:"Bottom",4:"Vertical",5:"Horizontal",Left:0,Right:1,Top:2,Bottom:3,Vertical:4,Horizontal:5},le={0:"Left",1:"Center",2:"Right",3:"Justify",Left:0,Center:1,Right:2,Justify:3},se={0:"Vertical",1:"Horizontal",2:"Both",Vertical:0,Horizontal:1,Both:2},ue={0:"Back",1:"Front",Back:0,Front:2},pe={0:"Line",1:"Rectangle",2:"RoundRect",3:"Ellipse",4:"Polyline",5:"Polygon",6:"Polybezier",7:"Curve",8:"Freedom",9:"Unknow",Line:0,Rectangle:1,RoundRect:2,Ellipse:3,Polyline:4,Polygon:5,Polybezier:6,Curve:7,Freedom:8,Unknow:9},de={0:"None",1:"Super",2:"Sub",None:0,Super:1,Sub:2},ge={0:"None",1:"All",2:"Text",3:"Image",4:"Path",5:"Shading",None:0,All:1,Text:2,Image:3,Path:4,Shading:5},he={0:"Left2Right",1:"Right2Left",Left2Right:0,Right2Left:1},fe={0:"Butt",1:"Round",2:"ProjectingSquareCap",Butt:0,Round:1,ProjectingSquareCap:2},ve={0:"Miter",1:"Round",2:"Bevel",Miter:0,Round:1,Bevel:2},me={PopupMenuItem_e_PopupMenuItemProperties:"Properties",PopupMenuItem_e_PopupMenuItemSetDefault:"SetDefault",PopupMenuItem_e_PopupMenuItemEditObject:"EditObject",PopupMenuItem_e_PopupMenuItemChangeOrderStartFlag:"ChangeOrderStartFlag",PopupMenuItem_e_PopupMenuItemBackward:"Backward",PopupMenuItem_e_PopupMenuItemForward:"ForwardGround",PopupMenuItem_e_PopupMenuItemBackGround:"BackGround",PopupMenuItem_e_PopupMenuItemFrontGround:"FrontGround",PopupMenuItem_e_PopupMenuItemChangeOrderEndFlag:"ChangeOrderEndFlag",PopupMenuItem_e_PopupMenuItemCut:"Cut",PopupMenuItem_e_PopupMenuItemCopy:"Copy",PopupMenuItem_e_PopupMenuItemPaste:"Paste",PopupMenuItem_e_PopupMenuItemPasteInPlace:"PasteInPlace",PopupMenuItem_e_PopupMenuItemDelete:"Delete",PopupMenuItem_e_PopupMenuItemAlignStartFlag:"AlignStartFlag",PopupMenuItem_e_PopupMenuItemAlignLeft:"AlignLeft",PopupMenuItem_e_PopupMenuItemAlignRight:"AlignRight",PopupMenuItem_e_PopupMenuItemAlignTop:"AlignTop",PopupMenuItem_e_PopupMenuItemAlignBottom:"AlignBottom",PopupMenuItem_e_PopupMenuItemAlignVertical:"AlignVertical",PopupMenuItem_e_PopupMenuItemAlignHorizontal:"AlignHorizontal",PopupMenuItem_e_PopupMenuItemAlignEndFlag:"AlignEndFlag",PopupMenuItem_e_PopupMenuItemCenterStartFlag:"CenterStartFlag",PopupMenuItem_e_PopupMenuItemCenterVertical:"CenterVertical",PopupMenuItem_e_PopupMenuItemCenterHorizontal:"CenterHorizontal",PopupMenuItem_e_PopupMenuItemCenterBoth:"CenterBoth",PopupMenuItem_e_PopupMenuItemCenterEndFlag:"CenterEndFlag",PopupMenuItem_e_PopupMenuItemDistributeStartFlag:"DistributeStartFlag",PopupMenuItem_e_PopupMenuItemDistributeVertical:"DistributeVertical",PopupMenuItem_e_PopupMenuItemDistributeHorizontal:"DistributeHorizontal",PopupMenuItem_e_PopupMenuItemDistributeEndFlag:"DistributeEndFlag",PopupMenuItem_e_PopupMenuItemSizeStartFlag:"SizeStartFlag",PopupMenuItem_e_PopupMenuItemSizeWidth:"SizeWidth",PopupMenuItem_e_PopupMenuItemSizeHeight:"SizeHeight",PopupMenuItem_e_PopupMenuItemSizeBoth:"SizeBoth",PopupMenuItem_e_PopupMenuItemSizeEndFlag:"SizeEndFlag",PopupMenuItem_e_PopupMenuItemRotateStartFlag:"RotateStartFlag",PopupMenuItem_e_PopupMenuItemRotateClockwise:"RotateClockwise",PopupMenuItem_e_PopupMenuItemRotateCounterClockwise:"RotateCounterClockwise",PopupMenuItem_e_PopupMenuItemRotateMoreOptions:"RotateMoreOptions",PopupMenuItem_e_PopupMenuItemRotateEndFlag:"RotateEndFlag",PopupMenuItem_e_PopupMenuItemFlipStartFlag:"FlipStartFlag",PopupMenuItem_e_PopupMenuItemFlipVertical:"FlipVertical",PopupMenuItem_e_PopupMenuItemFlipHorizontal:"FlipHorizontal",PopupMenuItem_e_PopupMenuItemFilpEndFlag:"FilpEndFlag",PopupMenuItem_e_PopupMenuItemShear:"Shear",PopupMenuItem_e_PopupMenuItemAddClipStartFlag:"AddClipStartFlag",PopupMenuItem_e_PopupMenuItemAddClipRectangle:"AddClipRectangle",PopupMenuItem_e_PopupMenuItemAddClipElipse:"AddClipElipse",PopupMenuItem_e_PopupMenuItemAddClipRoundRectangle:"AddClipRoundRectangle",PopupMenuItem_e_PopupMenuItemAddClipPolygon:"AddClipPolygon",PopupMenuItem_e_PopupMenuItemAddClipCurve:"AddClipCurve",PopupMenuItem_e_PopupMenuItemAddClipDrawing:"AddClipDrawing",PopupMenuItem_e_PopupMenuItemAddClipEndFlag:"AddClipEndFlag",PopupMenuItem_e_PopupMenuItemEditClip:"EditClip",PopupMenuItem_e_PopupMenuItemClearClip:"ClearClip",PopupMenuItem_e_PopupMenuItemConvert2Shape:"Convert2Shape",PopupMenuItem_e_PopupMenuItemMaxValue:"MaxValue",PopupMenuItem_e_PopupMenuItemShadingDelete:"Delete",PopupMenuItem_e_PopupMenuItemShadingInsertStartFlag:"InsertStartFlag",PopupMenuItem_e_PopupMenuItemShadingInsertLine:"InsertLine",PopupMenuItem_e_PopupMenuItemShadingInsertBessel:"InsertBessel",PopupMenuItem_e_PopupMenuItemShadingInsertEndFlag:"InsertEndFlag",PopupMenuItem_e_PopupMenuItemShadingChangeToStartFlag:"ChangeToStartFlag",PopupMenuItem_e_PopupMenuItemShadingChangeToLine:"ChangeToLine",PopupMenuItem_e_PopupMenuItemShadingChangeToBessel:"ChangeToBessel",PopupMenuItem_e_PopupMenuItemShadingChangeToEndFlag:"ChangeToEndFlag",PopupMenuItem_e_PopupMenuItemShadingClose:"Close",PopupMenuItem_e_PopupMenuItemShadingExit:"Exit",PopupMenuItem_e_PopupMenuItemShadingMaxValue:"MaxValue",PopupMenuItem_e_PopupMenuItemTextUndo:"Undo",PopupMenuItem_e_PopupMenuItemTextRedo:"Redo",PopupMenuItem_e_PopupMenuItemTextCut:"Cut",PopupMenuItem_e_PopupMenuItemTextCopy:"Copy",PopupMenuItem_e_PopupMenuItemTextPaste:"Paste",PopupMenuItem_e_PopupMenuItemTextDelete:"Delete",PopupMenuItem_e_PopupMenuItemTextDirection:"TextDirection",PopupMenuItem_e_PopupMenuItemTextDirectionL2R:"TextDirectionL2R",PopupMenuItem_e_PopupMenuItemTextDirectionR2L:"TextDirectionR2L",PopupMenuItem_e_PopupMenuItemTextSelectAll:"SelectAll",PopupMenuItem_e_PopupMenuItemPathDelete:"Delete",PopupMenuItem_e_PopupMenuItemPathInsertStartFlag:"InsertStartFlag",PopupMenuItem_e_PopupMenuItemPathInsertLine:"InsertLine",PopupMenuItem_e_PopupMenuItemPathInsertBessel:"InsertBessel",PopupMenuItem_e_PopupMenuItemPathInsertEndFlag:"InsertEndFlag",PopupMenuItem_e_PopupMenuItemPathChangeToStartFlag:"ChangeToStartFlag",PopupMenuItem_e_PopupMenuItemPathChangeToLine:"ChangeToLine",PopupMenuItem_e_PopupMenuItemPathChangeToBessel:"ChangeToBessel",PopupMenuItem_e_PopupMenuItemPathChangeToEndFlag:"ChangeToEndFlag",PopupMenuItem_e_PopupMenuItemPathClose:"Close",PopupMenuItem_e_PopupMenuItemPathAddLine:"AddLine",PopupMenuItem_e_PopupMenuItemPathAddRectangle:"AddRectangle",PopupMenuItem_e_PopupMenuItemPathAddEllipse:"AddEllipse",PopupMenuItem_e_PopupMenuItemPathAddLineDrawing:"AddLineDrawing",PopupMenuItem_e_PopupMenuItemPathExit:"Exit",PopupMenuItem_e_PopupMenuItemPathMaxValue:"MaxValue"},be="EditObject",ye="AddText",Pe="AdvEditStateHandlerName",Ce=Object.assign({},{"Foxit Fixed OTF":"Courier","Foxit Sans OTF":"Helvetica","Foxit Serif OTF":"Times-Roman",FoxitSansOTF:"Helvetica"},Y);function Se(){return(Se=n((function(e,t,n,r,o){var a,i,c,l;return P(this,(function(s){switch(s.label){case 0:return a=["","font-superscript","font-subscript"],i=["left","center","right","justify"],c={fontFamily:{value:Ce[r]||r},fontSize:{value:Math.round(100*t.fontSize)/100},fontColor:{enable:!0,value:t.wordColor},fontBold:{value:t.isBold},fontItalic:{value:t.isItalic},fontUnderline:{value:t.isUnderline},fontStrikethrough:{value:t.isCross},fontSuperSubScript:{value:a[t.scriptType]},fontCharacterSpacing:{value:t.charSpace},fontWritingDirection:{enable:!1},paragraphBullets:{enable:!0},paragraphNumbering:{enable:!0},paragraphAlign:{enable:!0,value:i[n.alignment]},paragraphIncrease:{enable:!0},paragraphDecrease:{enable:!0},paragraphLineSpacing:{value:n.lineLeading},paragraphSpacing:{value:n.secSpace.toFixed(2)},paragraphWordSpacing:{enable:!1},paragraphCharacterScale:{value:t.horzScale},bulletType:o.bulletType,numberType:o.numberType},e?[4,e.getComponentByName("edit-properties")]:[2];case 1:return(l=s.sent())?(l.enable(),l.setHost(c,G.TouchUp),[2]):[2]}}))}))).apply(this,arguments)}function Ee(e){return we.apply(this,arguments)}function we(){return(we=n((function(e){var t;return P(this,(function(n){switch(n.label){case 0:return e?[4,e.getComponentByName("edit-properties")]:[2];case 1:return(t=n.sent())&&t.disable(),[2]}}))}))).apply(this,arguments)}function xe(){return(xe=n((function(e){var t;return P(this,(function(n){switch(n.label){case 0:return e?[4,e.getComponentByName("edit-properties")]:[2];case 1:return(t=n.sent())&&t.enable(),[2]}}))}))).apply(this,arguments)}var ke,Ie,Ae,_e,Te=(ke=function(e,t){var n;t&&(Object.values(t).forEach((function(e){var t=e.target;"-1"===t.getAttribute("tabindex")&&t.removeAttribute("tabindex")})),!(n=e).getAttribute("tabindex")&&n.setAttribute("tabindex",-1))},Ie=500,Ae=!0,function(){var e=this,t=arguments,n=Ae&&!_e;clearTimeout(_e),_e=setTimeout((function(){_e=null,Ae||ke.apply(e,t)}),Ie),n&&ke.apply(e,t)}),Me=function(){function e(){i(this,e),this.eventObject={},this._addKeyEvent()}return l(e,[{key:"setDebugger",value:function(e){this.debugger=e}},{key:"_cwarn",value:function(){if(this.debugger)return console.warn.apply(this,arguments)}},{key:"_addTabindexEvent",value:function(e){var t=this;if(!e._hasmousedownevent_){var n=e._mousedown_=function(n){Te(e,t.eventObject)};e.addEventListener("mousedown",n),e._hasmousedownevent_=!0}}},{key:"_addEventObject",value:function(e,t,n){if(!t)throw Error("keys arguments is required.");var r,o=e._stctid||(r=(new Date).getTime(),window.performance&&"function"==typeof window.performance.now&&(r+=performance.now()),"xxyy-4xxx-yxxx-xx-sc".replace(/[xy]/g,(function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==e?t:3&t|8).toString(16)})));t=(t+"").toLocaleLowerCase().replace(/ /g,""),this._addTabindexEvent(e);var a=this.eventObject[o];a||(a={}),a.target=a.target||e,a[t]&&this._cwarn("重复绑定快捷键：",e,t),a[t]=n,e._stctid=o,this.eventObject[o]=a}},{key:"_addKeyEvent",value:function(){var e=this,t=[],n=[],r=function(o,a){var i=a||o.target,c=i._stctid,l=e.eventObject[c];if(a=i.parentNode,c&&l){var s=t.concat([]),u=n.concat([]);do{var p=s.join("+"),d=u.join("+"),g=l[p],h=l[d];if(g||h)return t=s,n=u,void(g||h)(o);s.shift(),u.shift()}while(s.length+u.length)}a&&"HTML"!==a.nodeName&&r(o,a)};document.addEventListener("keydown",(function(o){var a=o.key,i=o.keyCode;if(a){a="Control"===a?"ctrl":"Escape"===a?"esc":a.toLocaleLowerCase();var c=t.indexOf(a),l=n.indexOf(i);c>-1&&t.splice(c,1),l>-1&&n.splice(l,1),t.push(a),n.push(i);var s=function(){var t=document.activeElement;if(["INPUT","TEXTAREA"].includes(t.nodeName)||t.hasAttribute("contenteditable")||t.hasAttribute("tabindex"))return t;var n=Object.values(e.eventObject).find((function(e){return e.target.hasAttribute("tabindex")}));return n&&n.target}();r(o,s)}})),document.addEventListener("keyup",(function(e){var r=e.keyCode,o=e.altKey,a=e.ctrlKey,i=e.metaKey,c=e.shiftKey;if(o||a||i||c){var l=n.indexOf(r);l>-1&&(t.splice(l,1),n.splice(l,1))}else t=[],n=[]}))}},{key:"register",value:function(e,t,n){var o=this;if(e||(e=document),!r(e,Node))throw Error("first arguments is not a node.");return r(t,Array)?t.forEach((function(t){o._addEventObject(e,t,n)})):this._addEventObject(e,t,n),this}},{key:"unregister",value:function(e,t){var n=this,o=e._stctid;t?(r(t,Array)?t:[t]).forEach((function(e){delete n.eventObject[o][e]})):(e.removeEventListener("mousedown",e._mousedown_),delete this.eventObject[o],delete e._stctid,delete e._hasmousedownevent_,delete e._mousedown_)}}],[{key:"getInstance",value:function(){return window.Shortcut?window.Shortcut:window.Shortcut=new e}}]),e}();Me.getInstance();var Oe=o(732);function Re(e,t,n,r,o,a){var i=e.target;if(!(i==t.getElement()[0]||0==n||Oe.isIOS&&"div"===i.localName&&i.isContentEditable)){if("input"===i.localName||"textarea"===i.localName||i.isContentEditable)return"value"==i.name||i.classList.contains("fv__ui-dropdown-editor")?void o():(o(),void a());r(),t.getElement().focus()}}var De=C.PDFViewCtrl.commons.copyText;function Fe(e,t,r){var o=[],a=!0,i=!1,c=void 0;try{for(var l,s=function(){var t=l.value,a=t.name,i=t.enable,c=t.id,s=t.subItems;if("-"===a||"touchup"===r&&0===a)o.push({type:"separator"});else{var u={text:J[a],id:c,enable:i,shortcut:"",onClick:function(){return n((function(){var t,n;return P(this,(function(r){switch(r.label){case 0:return t=e.doc,32755!==c?[3,3]:[4,(0,Oe.readFromClipboard)()];case 1:return n=r.sent(),[4,e.handleEvent("UpdateClipboardText",n)];case 2:r.sent(),r.label=3;case 3:return e.triggerTUPopMenuAction(c).then((function(){[32753,32754].includes(a)&&t.api.handleTouchUpEvent(t.getId(),"GetClipboardText").then((function(e){De(e)}))})),[2]}}))}))()}};s&&(contentSubItems=Fe(e,s),u.subMenu=contentSubItems),o.push(u)}},u=t[Symbol.iterator]();!(a=(l=u.next()).done);a=!0)s()}catch(e){i=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(i)throw c}}return o}function je(e,t,n,r,o,a){var i=Fe(t,o,n),c=document.querySelector(".fv__ui-pdfviewer").getBoundingClientRect(),l=c.x,s=c.y;e.popMenu(r.x+l,r.y+s,i)}var Be=o(279),Ne=o.n(Be);function Ue(e){if("clientX"in e)return e.clientX;switch(e.type){case"touchstart":case"touchmove":return e.touches[0].clientX;case"touchend":case"touchcancel":return e.changedTouches[0].clientX}}function Le(e){if("clientY"in e)return e.clientY;switch(e.type){case"touchstart":case"touchmove":return e.touches[0].clientY;case"touchend":case"touchcancel":return e.changedTouches[0].clientY}}var Ve=C.vendors.jQuery,He=C.PDFViewCtrl,ze=C.UIEvents,$e=C.vendors.Hammer,Ke=He.DeviceInfo.isTouchDevice,We=C.PDFViewCtrl,Ge=We.commons,Ye=Ge.copyText,Je=Ge.readFromClipboard,qe=(We.shared.createDeferred,We.DeviceInfo),Xe=qe.isMobile,Qe=qe.isTablet,Ze=Promise.resolve(),et=0,tt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"OnKeyDown";return Ze=Ze.then((function(n){return St.trigger(t,[e.keyCode])}))},nt=!0;var rt,ot={3:"nesw-resize",0:"ns-resize",2:"nwse-resize",1:"ew-resize",4:"move"},at="touchup",it=!1,ct="",lt=function(){return"findReplace"===at&&rt&&0===rt.pdfViewer.currentPDFDoc.checkPermission(He.PDF.constant.User_Permissions.modify)},st=function(e){g(r,e);var t=y(r);function r(e){var n;return i(this,r),(n=t.call(this,e)).destroyHooks=[],n.canScroll=!0,n.rectsCache=[],n.index=-1,n.ocrCache=[],n.disableToggleCaret=!1,n.throttleRender=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=null;return function(){var r=this,o=arguments;n||(n=setTimeout((function(){e.apply(r,o),n=null}),t))}}((function(){n.pdfViewer.redraw(1,0)})),window&&(window.PageEditorTrigger=St),n}return l(r,[{key:"goToPage",value:function(e,t,n){if(this.docRender){var r=this.docRender.getPDFPageRender(e);if(r){var o=v(r.getPDFPointFromClientPoint(t,n,!0),2),a=o[0],i=o[1],c=this.docRender.pdfViewer,l=this.uiContainerRect.height||0;c.goToPage(e,i-l/4,a,!1)}}}},{key:"docHandler",value:function(e){var t=this,o=this;this.docRender=e;var a=this.pdfViewer;St.setDocRender(this.docRender,"touchup");var i=a.viewerUI.loading();St.trigger("restartTouchup").then((function(e){gt(a,1,0).then((function(e){i();var t="findReplace"==at?"touchup":at;St.trigger("OnActivate",[t,it])}))})),this.setEditorNotifier(),this.keyMgr=new N({skipKey:function(e){var t=document.activeElement!==j.getElement()[0];return t?!H[e]&&void 0:t},keydown:function(e){e.ctrlKey;var n=t.handleSpecialKesEvent(e);if(([37,38,39,40].indexOf(e.keyCode)>=0||Oe.isMac&&e.metaKey&&[89].indexOf(e.keyCode)>=0)&&(e.preventDefault(),e.stopPropagation()),27==e.keyCode&&St.trigger("ExitEditing",[!1]),8==e.keyCode&&St.trigger("OnChar",[String.fromCharCode(e.keyCode)]),n)return!1;tt(e)},keyup:function(e){e.ctrlKey,13==e.keyCode?St.trigger("OnChar",[String.fromCharCode(e.keyCode)]):tt(e,"OnKeyUp")}}),Ve(document).on("focusin",this._focusinLisener=function(e){Re(e,j,et,(function(){return t.keyMgr.start()}),(function(){return t.keyMgr.stop()}),(function(){return l()}))}),Ve(document).on("mouseup",this.cancelDown=function(e){if(!(e.target.classList&&e.target.classList.contains("fv__pdf-doc-handler-container")||Ve(e.target).hasClass("icon-btn")||Ve(e.target).parents('[name="fv--plugin-PageEditor-add-shape"]').length||Ve(e.target).parents(".icon-btn").length||Ve(e.target).parents('[name="edit-properties"]').length)){var n=V(e,"Up");return setTimeout((function(){if(t.docRender){var r=St.getPageIndex(e);-1!==r&&St.trigger(n,St.getArgs(r,e)).then((function(e){return t.actionFinalUpdate()}))}}),200)}}),this.setEditorNotifier();var c=function(){o.uiContainerRect=e.pdfViewer.$ui[0].parentElement.getBoundingClientRect();gt(a,1,0);ct=""};[He.Events.fitWidthResizeViewport,He.Events.zoomToSuccess,He.Events.afterDocumentRotation].forEach((function(e){t.destroyHooks.push(a.addEventListener(e,c))}));var l=function(){St.trigger("ExitEditing",[!1]);var e={clientX:50,clientY:150},t=St.getPageIndex(e);-1!==t&&St.trigger("OnLButtonUp",St.getArgs(t,e),2)},s=this.docRender.doc.getTouchup();this.destroyHooks.push(a.addEventListener(ze.editPropertiesAction,(function(e){var n=e.name,r=e.value;Ke&&("font-family"!==n&&"paragraph-numbering"!==n&&"paragraph-align"!==n&&"paragraph-increase"!==n&&"paragraph-decrease"!==n||(t.disableToggleCaret=!0)),W(s,n,r)})),a.addEventListener("restartTouchup",(function(){St.trigger("restartTouchup").then((function(e){gt(a,1,0).then((function(e){var t="findReplace"==at?"touchup":at;St.trigger("OnActivate",[t,!1])}))}))})),a.addEventListener("before-page-rotation-changed",l),a.addEventListener("exitTouchup",l),a.addEventListener(ze.switchStateHandler,l),Ke?a.addEventListener("refocusInput",(function(){t.disableToggleCaret=!1,j.refocusInput()})):function(){});var u=this.$handler=e.$container.siblings(".fv__pdf-doc-handler-container");u.css("z-index",80);var p=u.get(0);if(Oe.isIOS){var d=function(){t.disableTouchEndEvent?t.disableTouchEndEvent=!1:(t.tempInput=document.createElement("div"),t.tempInput.contentEditable=!0,t.tempInput.style="pointer-events: none;position:absolute;left:0;top:0;right:0;bottom:0;opacity: 0.001;",p.appendChild(t.tempInput),t.tempInput.focus({preventScroll:!0}))};p.addEventListener("touchend",d),this.destroyHooks.push((function(){p.removeEventListener("touchend",d),t.tempInput&&t.tempInput.parentElement&&t.tempInput.remove()}))}var g=this.hammer=new $e.Manager(p,{recognizers:[[$e.Pan,{direction:$e.DIRECTION_ALL}]],time:150}),h=Ve('<div class="touchup_handler_container"></div>'),f=Ve('<canvas class="touchup_handler" style="backdrop-filter: url(#touchup-revert-bg)"></canvas>');h.append(f),u.before(h),this.destroyHooks.push((function(){u.css("z-index",0),u.off("mousemove mousedown mouseup contextmenu")}));var v,m=this;u.on("mousemove",this.hover=function(e){if(St.cacheMouseCoord(e),nt){var t=St.getPageIndex(e);-1!==t&&St.trigger("OnMouseMove",St.getArgs(t,e),1)}}).on("mousedown",this.RButtionDown=function(e){if(2==e.button){t.$handler.find(".touchup_rect").remove();var n=St.getPageIndex(e);-1!==n&&St.trigger("OnRButtonDown",St.getArgs(n,e),0)}}).on("mouseup",this.RButtionUp=(v=n((function(e){var t,n,r;return P(this,(function(o){switch(o.label){case 0:if(2!=e.button)return[3,6];t=m.docRender.doc.getTouchup(),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,Je()];case 2:return n=o.sent(),[4,t.handleEvent("UpdateClipboardText",n)];case 3:case 4:return o.sent(),[3,5];case 5:-1!==(r=St.getPageIndex(e))&&St.trigger("OnRButtonUp",St.getArgs(r,e),0),o.label=6;case 6:return[2]}}))})),function(e){return v.apply(this,arguments)})).on("contextmenu",(function(e){return!1})),window.addEventListener("wheel",this.cancelWheel=function(e){t.canScroll||e.preventDefault()},{passive:!1}),this.destroyHooks.push((function(){u.css("z-index",0),Ve(document).off("mouseup",t.cancelDown),u.off("mousemove",t.hover),u.off("mousedown",t.RButtionDown),u.off("mouseup",t.RButtionUp),window.removeEventListener("wheel",t.cancelWheel),Ve(document).off("focusin",t._focusinLisener)})),g.add(new $e.Tap({event:"doubletap",taps:2})),g.add(new $e.Tap({event:"singletap"})),g.add(new $e.Press);try{g.get("doubletap").recognizeWith("singletap"),g.get("singletap").requireFailure("doubletap"),g.on("hammer.input",(function(e){if(!Ke&&!lt())if("pointerdown"!=e.srcEvent.type){if("pointerup"==e.srcEvent.type){nt=!0,e=e.srcEvent;var n=St.getPageIndex(e);if(-1===n)return;var r=V(e,"Up");St.trigger(r,St.getArgs(n,e))}}else{nt=!1,e=e.srcEvent;var o=V(e);t.$handler.find(".touchup_rect").remove();var a=St.getPageIndex(e);-1!==a&&St.trigger(o,St.getArgs(a,e))}})),g.on("singletap",(function(e){if(Ke&&(t.$handler.find(".touchup_rect").remove(),e=e.srcEvent,!lt())){t.LButtionEvent=e;var n=V(e),r=St.getPageIndex(e);if(-1!==r){var o=St.trigger(n,St.getArgs(r,e));n=V(e,"Up"),o.then((function(t){return St.trigger(n,St.getArgs(r,e),2)})),o.then((function(n){t.goToPage(r,Ue(e),Le(e))}))}}})),g.on("panstart",(function(e){t.disableTouchEndEvent=!0,t.canScroll=!1,lt()||(t.LButtionEvent=e.srcEvent,t.$handler.find(".touchup_rect").remove(),r.panStartHandle(e))})),g.on("panmove",(function(e){r.panMoveHandle(e)})),g.on("panend",(function(e){t.canScroll=!0,r.panEndHandle(e)})),g.on("doubletap",(function(e){lt()||(t.LButtionEvent=e.srcEvent,t.$handler.find(".touchup_rect").remove(),r.doubleTapHandle(e))})),g.on("press",(function(e){if(Ke){t.disableTouchEndEvent=!0;var n=St.getPageIndex(e.srcEvent);-1!==n&&St.trigger("OnRButtonUp",St.getArgs(n,e.srcEvent),0)}}))}catch(e){console.error(e)}c(!1)}},{key:"actionFinalUpdate",value:function(e){}},{key:"setEditorNotifier",value:function(){var e=this,t={gotoPageView:function(t){var n=JSON.stringify(t);if(ct!=n){ct=n;var o=t.index,a=t.left,i=t.top,c=e.uiContainerRect.height,l=e.pdfViewer.getPDFDocRender().getPDFPageRender(0),s=l.page;if(s){var u=v(s.reverseDeviceOffset([c,0],l.scale,l.rotate),2),p=u[0];u[1];i+=p/2}"findReplace"==r.getType()?e.pdfViewer.eventEmitter.emit("find-replace-goto",{pageIndex:o,top:i,left:a}):e.pdfViewer.goToPage(o,i,a)}},replaceAllProgress:function(t){var n=t.pageIndex,r=t.total;-1===n?e.pdfViewer.eventEmitter.emit("find-replace-abort"):e.pdfViewer.eventEmitter.emit("find-replace-progress",{pageIndex:n,total:r})},updateTextFormat:function(e){!function(e,t,n,r,o){Se.apply(this,arguments)}(rt,e.wordProp,e.secProps,e.fontName,e)},toggleCaret:function(t,n,r,o){if(!Ke||!e.disableToggleCaret)if(t)j.startInput((function(e,t){return St.trigger("OnChar",[e])})),et=3,Oe.isIOS&&e.tempInput&&e.tempInput.remove();else{if(et=0,Oe.isIOS)return;j.endInput()}},showPopupMenu:function(t){var n=t.position,r=t.menu,o=(t.pageIndex,e.docRender.doc.getTouchup());je(rt,o,at,n,r)},showMessageBox:function(e){var t=e.id;e.flag,e.data;1===t?(K(),rt.alert(rt.i18n.t("page-editor:alert.joinFailed"))):2===t&&(K(),rt.alert(rt.i18n.t("page-editor:alert.notAvaliable")))},updateView:function(t){var n=t.bitmapInfo,r=t.revertRects;t.redraw;e.displayImage(n,r),"joinSplit"===at&&(!1,e.updateJoinSplitBtns())},enterEdit:function(){e.pdfViewer.eventEmitter.emit(ze.paragraphTextEnterEdit),function(e){xe.apply(this,arguments)}(rt),j.startInput((function(e,t){return St.trigger("OnChar",[e]).then((function(e){var n=St.getPageIndex(t);-1!==n&&St.trigger("OnMouseMove",St.getArgs(n,t,0,-1))}))})),e.throttleRender(),et=3,Oe.isIOS&&e.tempInput&&e.tempInput.remove()},exitEdit:function(){e.pdfViewer.eventEmitter.emit(ze.paragraphTextExitEdit),rt.getAddonInstance("UndoRedoAddon").then((function(e){e.pushUndoStack("touchup","exitEdit")})),et=0,rt.getComponentByName("edit-properties").then((function(e){e&&e.hostType===G.TouchUp&&Ee(rt)})),ft(rt,{},{}),e.throttleRender()},cursorChange:function(t){e.$handler&&(7==t?(e.$handler.css("cursor",""),e.$handler.addClass("fv__cursor-text")):(e.$handler.removeClass("fv__cursor-text"),e.$handler.css("cursor",ot[t]||"")),it&&(void 0===t||5===t||4===t&&(Xe||Qe))&&e.$handler.css("cursor",it?"text":""))},progressRelease:function(){},progressCreate:function(e){var t=v(e,2);t[0],t[1]},progressSetText:function(e){var t=v(e,2);t[0],t[1]},progressSetRange:function(e){var t=v(e,3);t[0],t[1],t[2]},progressSetCurrentValue:function(e){var t=v(e,2);t[0],t[1]},progressDestroy:function(e){v(e,1)[0]},fontNameChange:function(e){},docModified:function(){e.docRender&&e.docRender.doc.setDocModified()},OnActivate:Ne()((function(){e.pdfViewer.eventEmitter.emit(ze.paragraphTextOnActivate)}),50),OnDeactivate:function(){e.pdfViewer.eventEmitter.emit(ze.paragraphTextOnDeactivate)},pageWithoutText:Ne()((function(t){var n=rt;t===e.docRender.currentPageNumber&&n.getPDFPageRender(t).then((function(t){e.ocrPage(t)}))}),300),contentChange:function(t){var n=t.pageIndex,r=t.type;e.throttleRender(),e.docRender&&e.docRender.doc.setDocModified(),e.pdfViewer.eventEmitter.emit(ze.paragraphContentChanged,{pageIndex:n,type:r})},onTextInputReachesLimit:Ne()((function(e){rt.alert(rt.i18n.t("page-editor:alert.textInputReachesLimit"))}),300)};this.docRender.doc.getTouchup().setNotifier(t)}},{key:"displayImage",value:function(e,t){var n=rt.pdfViewer.getPDFDocRender();if(n.matrixes){var r=n.matrixes.uiRect,o=r.left,a=r.top,i=e.width,c=e.height,l=e.buffer,s=e.left,u=e.top;if(l&&o==s&&a==u){var p=n.$ui[0].getBoundingClientRect(),d=n.pdfViewer.$ui[0].parentElement,g=(this.uiContainerRect=d.getBoundingClientRect(),Ve('<div class="touchup_handler_container"></div>')),h=Ve('<canvas class="touchup_handler" style="backdrop-filter: url(#touchup-revert-bg)"></canvas>');g.append(h),g.css({left:s-p.left+"px",top:u-p.top+"px",width:d.clientWidth+"px",height:d.clientHeight+"px"});var f=h[0];f.width=i,f.height=c;var v=f.getContext("2d");v.clearRect(0,0,i,c);var m=new(Uint8ClampedArray||Uint8Array)(l),b=v.createImageData(i,c);b.data.set(m),K(),function(e,t){try{var n=t.$ui.find(".touchup_handler")[0];if(null==n)return;var r=n.getBoundingClientRect(),o=[],a=t.$ui.find(".fv__pdf-doc-handler-container"),i=t.$ui[0].getBoundingClientRect(),c=!0,l=!1,s=void 0;try{for(var u,p=e[Symbol.iterator]();!(c=(u=p.next()).done);c=!0){var d=u.value,g=document.createElement("div");g.style.webkitBackdropFilter="invert(1)",g.style.backdropFilter="invert(1)",g.style.position="absolute",g.style.left=d.left/z+r.left-i.left+"px",g.style.top=d.bottom/z+r.top-i.top+"px",g.style.width=(d.right-d.left)/z+"px",g.style.height=(d.top-d.bottom)/z+"px",a.append(g),o.push(g)}}catch(e){l=!0,s=e}finally{try{c||null==p.return||p.return()}finally{if(l)throw s}}$=o}catch(e){console.log("revert error",e)}}(t,n),v.putImageData(b,0,0);var y=n.$ui.find(".touchup_handler_container");this.$handler&&this.$handler.before(g),y.hide().remove()}}}},{key:"destroyDocHandler",value:function(){St.trigger("OnDeactivate"),this.destroyHooks.forEach((function(e){return e()})),this.docRender.$ui.find(".touchup_handler_container").remove(),this.keyMgr.destroy(),this.hammer.destroy(),"touchup"===at&&Ee(rt),K(),this.ocrCache=[],this.docRender=null,this.$handler=null}},{key:"handleSpecialKesEvent",value:function(e){var t=null,n=this.docRender.doc.getTouchup();if(e.ctrlKey||e.metaKey){var r=document.activeElement===j.getElement()[0];switch(e.keyCode){case 67:t=this.doCopy();break;case 86:t=this.doPaste();break;case 90:e.shiftKey?n.handleEvent("Undo",!1,r):n.handleEvent("Undo",!0,r);break;case 89:n.handleEvent("Undo",!1,r)}}return t}},{key:"doCopy",value:function(){var e=this.docRender.doc.getTouchup();return e.handleEvent("DoCopy").then((function(){return e.handleEvent("GetClipboardText").then((function(e){return Ye(e)}))}))}},{key:"doPaste",value:function(){var e=this;return Je().then((function(t){if(t){var n=e.docRender.doc.getTouchup();return n.handleEvent("UpdateClipboardText",t).then((function(){return n.handleEvent("DoPaste")}))}}),(function(){e.pdfViewer.viewerUI.alert({level:"warning",message:"alert.clipboard-permission"})}))}},{key:"updateJoinSplitBtns",value:function(){if(this.docRender){var e=this.docRender.doc.getTouchup();e.handleEvent("GetEnableStatus",{type:"JoinSpiltOperationType",value:q}).then((function(e){rt.getComponentByName("join-split-join").then((function(t){t&&(e?t.enable():t.disable())}))})),e.handleEvent("GetEnableStatus",{type:"JoinSpiltOperationType",value:X}).then((function(e){rt.getComponentByName("join-split-split").then((function(t){t&&(e?t.enable():t.disable())}))})),e.handleEvent("GetEnableStatus",{type:"JoinSpiltOperationType",value:Q}).then((function(e){rt.getComponentByName("join-split-link").then((function(t){t&&(e?t.enable():t.disable())}))})),e.handleEvent("GetEnableStatus",{type:"JoinSpiltOperationType",value:Z}).then((function(e){rt.getComponentByName("join-split-unlink").then((function(t){t&&(e?t.enable():t.disable())}))})),e.handleEvent("GetEnableStatus",{type:"JoinSpiltOperationType",value:ee}).then((function(e){rt.getComponentByName("join-split-select-none").then((function(t){t&&(e?t.enable():(t.disable(),K()))}))})),e.handleEvent("GetEnableStatus",{type:"JoinSpiltOperationType",value:te}).then((function(e){rt.getComponentByName("join-split-close").then((function(t){t&&(e?t.enable():t.disable())}))}))}}},{key:"ocrPage",value:function(e){var t=e.index;if(!(this.ocrCache.indexOf(t)>-1)){this.ocrCache.push(t);var n=rt,r=e.page;if(!(n.customs&&n.customs.isDisableButton&&n.customs.isDisableButton("edit-text"))){var o=this.getEditingData(),a=this.getScannedEditingSettingData(),i=function(){var t=a.makeAllPages?"":e.index+1;n.customs&&n.customs.convert&&n.customs.convert.doConvertScannedDocument({languages:a.languages.join(","),is_editable:!0,to_find_all_suspects:!1,to_recognize_line_as_path:!1,pageRange:t},(function(e){var r=Promise.resolve();t&&t>1&&(r=n.goToPage(t-1,0,0,!1)),r.then((function(){return n.getRootComponent()})).then((function(e){e.querySelector("edit-text").controller.handle()}))}))};o.alert?n.$confirm({message:"page-editor:confirm.content",id:r.doc.id+"-edit-text-"+e.index,again:!0,autoHide:!1,againText:"page-editor:confirm.againText",level:"question",customBtns:[{id:"setting",text:"page-editor:confirm.buttons.setting"},{id:"recognize",text:"page-editor:confirm.buttons.recognize"},{id:"no",text:"page-editor:confirm.buttons.no"}]}).then((function(e){if("setting"!==e)return i(),!0;n.customs&&n.customs.showScannedEditing&&n.customs.showScannedEditing()})):o.recognize&&i()}}}},{key:"getEditingData",value:function(){var e=localStorage.getItem("EDITING_DATA"),t=rt.customs&&rt.customs.sendGAEvent&&rt.customs.getPreferencesDefaultData&&rt.customs.getPreferencesDefaultData("EditingDefaultData");return e=Object.assign(t||{},e?JSON.parse(e):{})}},{key:"getScannedEditingSettingData",value:function(){var e=localStorage.getItem("SCANNED-EDITING-SETTING-DATA"),t=rt.customs&&rt.customs.sendGAEvent&&rt.customs.getPreferencesDefaultData&&rt.customs.getPreferencesDefaultData("ScannedDocumentSettingDefaultData");return e=Object.assign(t||{},e?JSON.parse(e):{})}}],[{key:"getStateName",value:function(){return"touch-up-editor"}},{key:"setType",value:function(e){at=e,K()}},{key:"isAddingText",value:function(){return it}},{key:"activateType",value:function(e,t,n,o,a){r.setType(n),rt=e,it=o,gt(t,1,0).then((function(t){var n="findReplace"==at?"touchup":at;e.getPDFDocRender().then((function(e){St.setDocRender(e,"touchup"),St.trigger("OnActivate",[n,o]).then((function(e){return a&&St.trigger("SelectContent",a)}))}))}))}},{key:"joinSplit2EditText",value:function(e,t){return r.setType("touchup"),rt=e,gt(t,1,0).then((function(e){return St.trigger("JoinSplitToEditText")}))}},{key:"getType",value:function(){return at}},{key:"doubleTapHandle",value:function(e){var t=St.getPageIndex(e.srcEvent);return-1===t?Promise.resolve():St.trigger("OnLButtonDoubleClick",St.getArgs(t,e.srcEvent,0,-1))}},{key:"panEndHandle",value:function(e){e=e.srcEvent;var t=V(e,"Up"),n=St.getPageIndex(e);-1!==n&&St.trigger(t,St.getArgs(n,e),2)}},{key:"panMoveHandle",value:function(e){e=e.srcEvent;var t=St.getPageIndex(e);return-1!==t?St.trigger("OnMouseMove",St.getArgs(t,e),1):Promise.resolve()}},{key:"panStartHandle",value:function(e){var t=St.getPageIndex(e.srcEvent);return-1===t?Promise.resolve():St.trigger("OnLButtonDown",St.getArgs(t,{clientX:e.srcEvent.clientX-e.deltaX,clientY:e.srcEvent.clientY-e.deltaY}))}}]),r}(He.IStateHandler);const ut=st;var pt=0,dt=[];function gt(e){var t,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=e.getPDFDocRender();if(i&&delete i.matrixes,"page-editor"!==e.getStateHandlerManager().currentStateHandler.getStateName()&&1!=o)return Promise.resolve();if(pt){var c=i.getContainerVisiblePageIndexes();if(t=c,r=dt,Array.isArray(t)&&Array.isArray(r)&&t.length===r.length&&t.every((function(e){return r.includes(e)})))return Promise.resolve()}return new Promise((function(e){return pt=setTimeout(e,a)})).then((function(){var t=e.$ui[0].parentElement,r=t.getBoundingClientRect();if(!i)return pt=0,dt=[],Promise.resolve();var a,c=i.doc,l=i.getContainerVisiblePageIndexes();return dt=l,l.length?l.reduce((a=n((function(e,t){var n,o,a,c,l,s,u,p,d;return P(this,(function(g){switch(g.label){case 0:return[4,e];case 1:return n=g.sent(),(o=i.getPDFPageRender(t)).isRendering()?[4,o.waitRendered()]:[3,3];case 2:g.sent(),g.label=3;case 3:return[4,o.getPDFPage()];case 4:return g.sent()&&(a=o.$ui[0].getBoundingClientRect(),c=a.x-r.x,l=a.y-r.y,s=o.page.getDeviceMatrix(o.rotate),u=o.getScale(),s.scale(u,u),p=new w(s),s.translate(c,l),h=a,f=r,d={left:(d={left:Math.max(h.left,f.left),top:Math.max(h.top,f.top),right:Math.min(h.right,f.right),bottom:Math.min(h.bottom,f.bottom)}).left-r.x,right:d.right-r.x,top:d.top-r.y,bottom:d.bottom-r.y},a={left:a.left-r.x,right:a.right-r.x,top:a.top-r.y,bottom:a.bottom-r.y},n[t]=[u,o.rotate,s,d,a,p]),[2,n]}var h,f}))})),function(e,t){return a.apply(this,arguments)}),Promise.resolve({})).then((function(e){return e.visibleIndexes=l,e.uiRect={left:r.left,top:r.top,width:t.clientWidth,height:t.clientHeight},e.dpr=devicePixelRatio||1,i.matrixes=e,pt=0,dt=[],c.api.updateWinlessMatrix(c.id,o,e)})):(pt=0,Promise.resolve())})).finally((function(){pt=0,dt=[]}))}function ht(e,t){return{type:e,value:t}}function ft(e){return vt.apply(this,arguments)}function vt(){return vt=n((function(e){return P(this,(function(t){var r;return e.getRootComponent().then((r=n((function(t){var n,r,o,a,i,c,l,s,u,p,d,g;return P(this,(function(h){switch(h.label){case 0:return n=t.getComponentByName("edit-text"),r=t.getComponentByName("join-split"),o=t.getComponentByName("edit-tab"),[4,e.getStateHandlerManager()];case 1:return a=h.sent(),(i=t.getComponentByName("joinsplit-tab"))||(c=t.getComponentByName("toolbar-tabs"),l=t.getComponentByName("toolbar-tab-bodies"),s=t.getComponentByName("fv--protect-tab-paddle"),u=s?s.index():0,l&&l.insert('<paddle exclude-devices="tablet" name="fv--joinsplit-tab-paddle" visible="false">\n                <group-list name="joinsplit-toolbar-group-list">\n                    <group name="joinsplit-tab-group-join">\n                        <page-editor:join></page-editor:join>\n                        <page-editor:split></page-editor:split>\n                    </group>\n                    <group name="joinsplit-tab-group-link">\n                        <page-editor:link></page-editor:link>\n                        <page-editor:unlink></page-editor:unlink>\n                    </group>\n                    <group name="joinsplit-tab-group-select">\n                        <page-editor:select-none></page-editor:select-none>\n                    </group>\n                    <group name="joinsplit-tab-group-exit">\n                        <page-editor:edit-text @async class="fv__ui-toolbar-show-text-button"></page-editor:edit-text>\n                        <page-editor:close></page-editor:close>\n                    </group>\n                </group-list>\n            </paddle>',u+1),c&&c.insert('<gtab group="toolbar-tab" body="fv--joinsplit-tab-paddle" name="joinsplit-tab" text="toolbar.tabs.join&split.title" @portfolio.unsupport visible="false"></gtab>',6),i=t.getComponentByName("joinsplit-tab")),(p=a.getCurrentStates())!==ut||p.isAddingText()?(n&&n.deactive(),r&&r.deactive(),i&&i.hide()):"touchup"===(d=ut.getType())||"findReplace"==d?(o&&o.active(),n&&n.active(),r&&r.deactive(),i&&i.hide()):"joinSplit"===d&&(n&&n.deactive(),i&&i.show(),i&&i.active(),r&&r.active()),(g=t.getComponentByName("fv--plugin-PageEditor-add-text"))?(p===ut&&p.isAddingText()?g.active():g.deactive(),[2]):[2]}}))})),function(e){return r.apply(this,arguments)})),[2]}))})),vt.apply(this,arguments)}var mt=PDFViewCtrl.shared,bt=mt.getClientX,yt=mt.getClientY,Pt=C.UIEvents,Ct=function(){function e(){i(this,e),this.cache={}}return l(e,[{key:"destroy",value:function(){this.docRender=null}},{key:"setDocRender",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pageEditor";this.docRender=e,this.type=t}},{key:"getPageIndex",value:function(e){var t=this;return this.docRender&&this.docRender.pagesRender?this.docRender.pagesRender.pageDOMs.findIndex((function(n){var r=n.getBoundingClientRect(),o=bt(e),a=yt(e);return void 0===o&&(o=t._clientX),void 0===a&&(a=t._clientY),o>r.left&&o<r.right&&a>r.top&&a<r.bottom})):-1}},{key:"getArgs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,o=this.docRender,a=[];if(a.push(ht("EditorPage",e)),t){var i=o.pdfViewer.$ui[0].parentElement.getBoundingClientRect(),c=bt(t),l=yt(t),s=devicePixelRatio||1,u=(c-i.x)*s,p=(l-i.y)*s;a.push(ht("PointF",[u,p]))}return n&&a.push(n),-1!==r&&a.push(r),a}},{key:"trigger",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!this.docRender)return Promise.resolve();var r=this.docRender,o=r.doc,a=r.pdfViewer;if(!o.isDestroyed){var i=document.activeElement,c=i===j.getElement()[0],l=i&&i.getComponent&&i.getComponent();if(l&&"contextmenu"===l.nodeName&&(c=!0),"pageEditor"==this.type){var s=[o.id,e,n].concat(m(t));return o.api.handlePageEditorEvent.apply(o.api,s).then((function(){["OnKeyUp","OnLButtonUp"].includes(e)&&setTimeout((function(){c=document.activeElement===j.getElement()[0],o.api.handlePageEditorEvent.apply(o.api,[o.id,"GetUndoManager",void 0,c]).then((function(e){a.eventEmitter.emit(Pt.undoRedoStoreChange,e,"pageEditor",c)}))}),500)}))}"OnChar"===e&&a.eventEmitter.emit(Pt.paragraphTextOnChar,{char:t[0]});var u=[o.id,e].concat(m(t));return o.api.handleTouchUpEvent.apply(o.api,u).then((function(t){["OnKeyUp","OnLButtonUp"].includes(e)&&o.api.handleTouchUpEvent.apply(o.api,[o.id,"GetUndoManager"]).then((function(e){a.eventEmitter.emit(Pt.undoRedoStoreChange,e,"touchUp")}))}))}}},{key:"cacheMouseCoord",value:function(e){this._clientX=bt(e),this._clientY=yt(e)}},{key:"clearPageEditorTouchupRedo",value:function(e,t){var n=this.docRender,r=n.doc,o=n.pdfViewer,a=document.activeElement===j.getElement()[0],i=this.cache.pageEditor,c=(i?i[0].length:0)+(i?i[1].length:0),l=t[0].length,s=t[1].length;c&&c!==l+s?r.api.handlePageEditorEvent.apply(r.api,[r.id,"ClearRedo",void 0,a]).then((function(e){o.eventEmitter.emit(Pt.undoRedoStoreChange,e,"pageEditor",a)})):"pageEditor"===e&&o.eventEmitter.emit(Pt.undoRedoStoreChange,t,"pageEditor",a);var u=this.cache.touchup,p=(u?u[0].length:0)+(u?u[1].length:0),d=t[0].length,g=t[1].length;p&&p!==d+g?r.api.handleTouchUpEvent.apply(r.api,[r.id,"ClearRedo"]).then((function(e){o.eventEmitter.emit(Pt.undoRedoStoreChange,e,"touchUp")})):"touchup"===e&&o.eventEmitter.emit(Pt.undoRedoStoreChange,t,"touchUp"),this.cache[e]=t}}]),e}();const St=new Ct;var Et=o(665),wt=o.n(Et),xt=o(649),kt=o.n(xt),It=o(297),At=o.n(It),_t=o(945),Tt=o.n(_t);const Mt={1:"crosshair",3:"nesw-resize",4:"ns-resize",5:"nwse-resize",6:"ew-resize",11:"no-drop",24:"text"};var Ot=UIExtension.vendors.jQuery,Rt=Ot('<div class="pe_tip"></div>');Ot("body").append(Rt);const Dt=Rt;var Ft={Courier:{regular:"Courier",bold:"Courier-Bold",italic:"Courier-Oblique",bolditalic:"Courier-BoldOblique"},Helvetica:{regular:"Helvetica",bold:"Helvetica-Bold",italic:"Helvetica-Oblique",bolditalic:"Helvetica-BoldOblique"},"Times-Roman":{regular:"Times-Roman",bold:"Times-Bold",italic:"Times-Italic",bolditalic:"Times-BoldItalic"}};var jt={popMenu:{activeObject:null,editingObject:null,position:null,pageIndex:null},addingText:!1,shapeElement:null};function Bt(){return jt.addingText}function Nt(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ut(e){for(var t=e.length,n=[],r=0;r<t-1;r++)n.push({fromColor:e[r].color,from:e[r].offset,toColor:e[r+1].color,to:e[r+1].offset});return n}function Lt(e){return"transparent"===e?0:parseInt("FF"+e.slice(1),16)}function Vt(e){var t,n,r,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"HTML",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,c="";switch("number"==typeof e&&(e=["int",e]),e[0]){case"int":t=(16711680&e[1])>>16,n=(65280&e[1])>>8,r=255&e[1];break;case"T":t=0,n=0,r=0,i=0;break;case"G":t=n=r=255*e[1];break;case"RGB":t=255*e[1],n=255*e[2],r=255*e[3];break;case"CMYK":t=(1-e[4])*(1-e[1])*255,n=(1-e[4])*(1-e[2])*255,r=(1-e[4])*(1-e[3])*255;break;case"r":t=+(o=e.match(/rgba?\((\d*),\s*(\d*),\s*(\d*),?\s*([\.0-9]*)?\)/))[1],n=+o[2],r=+o[3];break;case"#":var l=4==e.length?/#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/:/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/;o=e.match(l),t=parseInt(o[1],16),n=parseInt(o[2],16),r=parseInt(o[3],16);break;default:throw new Error("Unsupported color format")}switch(a){case"HTML":c=t===n&&n===r&&-1===r?"transparent":"rgba("+parseInt(t)+","+parseInt(n)+","+parseInt(r)+","+i+")";break;case"RGB":c=["RGB",t/255,n/255,r/255];break;case"#":c+=t<16?"#0"+t.toString(16):"#"+t.toString(16),c+=n<16?"0"+n.toString(16):n.toString(16),c+=r<16?"0"+r.toString(16):r.toString(16);break;case"int":c=0,c|=(i*=255)<<24,c|=t<<16,c|=n<<8,c|=r,c>>>=0}return c}function Ht(){return(Ht=n((function(e,t,n){var r;return P(this,(function(o){switch(o.label){case 0:return t!==ie.Text?[3,2]:[4,e.getDefaultProperty(ae.Text)];case 1:r=o.sent(),Jt({fontName:(a=r).fontName||"Helvetica",fontSize:a.fontSize||18,rtl:a.rtl||!1,charSpace:a.charSpace||0,wordSpace:a.wordSpace||0,fontColor:a.fillColor||"#000000",horzScale:a.horzScale||100,isBold:a.isBold||!1,isItalic:a.isItalic||!1,isCross:a.isCross||!1,isUnderline:a.isUnderline||!1,scriptType:a.scriptType||de.None,alignment:a.alignment||le.Left,isAdding:Bt(),lineSpace:0},n),o.label=2;case 2:return[2]}var a}))}))).apply(this,arguments)}function zt(){return(zt=n((function(e,t,n,r){var o,a,i;return P(this,(function(c){switch(c.label){case 0:switch(a={},e&&(a=e.json,o=a.type),o){case ae.Text:return[3,1];case ae.Image:return[3,2];case ae.Path:return[3,3];case ae.Shading:return[3,4];case ae.Mixed:return[3,5]}return[3,6];case 1:return $t(a,n,r),[3,8];case 2:return Yt(a,n,r),[3,8];case 3:return Kt(a,n,r),[3,8];case 4:return Wt(a,n,r),[3,8];case 5:return Gt(a,n,r),[3,8];case 6:return[4,t.getEditingObject()];case 7:return(i=c.sent())&&i.type===ie.Text?i&&i.type===ie.Text?[2]:[3,8]:(Xt(n),[2]);case 8:return[2]}}))}))).apply(this,arguments)}function $t(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=v(function(e){var t,n,r=Ft[e.baseFontName];return r?(t=r.bold===e.fontName||r.bolditalic===e.fontName,n=r.italic===e.fontName||r.bolditalic===e.fontName):(t=e.fontIsBold,n=e.fontIsItalic),[e.baseFontName,t,n]}(e),3),o=r[0],a=r[1],i=r[2],c={effectClippingType1:{enable:1===e.count},effectClippingType2:{enable:1===e.count},effectClippingType3:{enable:1===e.count},effectClippingType4:{enable:1===e.count},effectClippingType5:{enable:1===e.count},effectClippingType6:{enable:1===e.count},effectEditClipping:{enable:Zt(e)},effectClearClipping:{enable:en(e)},fontFamily:{enable:!0,value:o},fontSize:{enable:!0,value:Math.round(100*e.fontSize)/100},fontBold:{enable:!0,value:a},fontItalic:{enable:!0,value:i},fontColor:{enable:!0,value:Vt(e.fillColor,"#")},fontUnderline:{enable:!1},fontStrikethrough:{enable:!1},fontSuperSubScript:{enable:!1},fontCharacterSpacing:{enable:!1},fontWritingDirection:{enable:!1},paragraphBullets:{enable:!1},paragraphNumbering:{enable:!1},paragraphAlign:{enable:!1},paragraphIncrease:{enable:!1},paragraphDecrease:{enable:!1},paragraphLineSpacing:{enable:!1},paragraphSpacing:{enable:!1},paragraphCharacterScale:{enable:!0,value:e.horizontalScale},paragraphWordSpacing:{enable:e.isWordSpaceValid},splitMergeText:{enable:e.canMergeText},splitRemoveKerning:{enable:e.canRemoveTextKerning},splitText:{enable:e.canSplitText,value:e.text},splitToShape:{enable:e.canText2Path},arrangeAlignmentVertically:{enable:e.count>1},arrangeAlignmentHorizontally:{enable:e.count>1},arrangeAlignmentLeft:{enable:e.count>1},arrangeAlignmentRight:{enable:e.count>1},arrangeAlignmentTop:{enable:e.count>1},arrangeAlignmentBottom:{enable:e.count>1},arrangeDistributeVertically:{enable:e.count>2},arrangeDistributeHorizontally:{enable:e.count>2},arrangeZorderToBack:{enable:e.canChangeBack},arrangeZorderToFront:{enable:e.canChangeFront},effectOpacity:{enable:!0,value:e.opacity},arrangeRotateMoreOptions:{enable:!0,value:e.rotateOption},arrangeRotateMoreOptionsInput:{enable:!0,value:e.rotateOption}};n||Qt(t,c,e.type)}function Kt(e,t){var n,r,o,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=fe,c=oe.LineCap,l=ve,s=oe.LineJoin;switch(e.lineCap){case i.Butt:n=c.Butt;break;case i.Round:n=c.Round;break;case i.ProjectingSquareCap:n=c.ProjectingSquareCap}switch(e.lineJoin){case l.Miter:r=s.Miter;break;case l.Round:r=s.Round;break;case l.Bevel:r=s.Bevel}Nt(e.lineStyle,[])?o=1:Nt(e.lineStyle,[2,2])?o=2:Nt(e.lineStyle,[3,3])?o=3:Nt(e.lineStyle,[4,4])?o=4:Nt(e.lineStyle,[4,3,2,3])?o=5:Nt(e.lineStyle,[4,3,16,3])?o=6:Nt(e.lineStyle,[8,4,4,4])&&(o=7);var u={effectClippingType1:{enable:1===e.count},effectClippingType2:{enable:1===e.count},effectClippingType3:{enable:1===e.count},effectClippingType4:{enable:1===e.count},effectClippingType5:{enable:1===e.count},effectClippingType6:{enable:1===e.count},effectEditClipping:{enable:Zt(e)},effectClearClipping:{enable:en(e)},shapeStyleLineColor:{enable:!0,value:e.strokeColorSpace?Vt(e.strokeColor,"#"):"#fff"},shapeStyleFillColor:{enable:!0,value:Vt(e.fillColor,"#")},shapeStyleMiterLimit:{enable:!0,value:e.miterLimit},shapeStyleLineJoin:{enable:!0,value:r},shapeStyleLineCap:{enable:!0,value:n},shapeStyleDashType:{enable:!0,value:o},shapeStyleOpacity:{enable:!0,value:e.opacity},shapeStyleLineWidth:{enable:!0,value:e.lineWidth},arrangeAlignmentVertically:{enable:e.count>1},arrangeAlignmentHorizontally:{enable:e.count>1},arrangeAlignmentLeft:{enable:e.count>1},arrangeAlignmentRight:{enable:e.count>1},arrangeAlignmentTop:{enable:e.count>1},arrangeAlignmentBottom:{enable:e.count>1},arrangeDistributeVertically:{enable:e.count>2},arrangeDistributeHorizontally:{enable:e.count>2},arrangeZorderToBack:{enable:e.canChangeBack},arrangeZorderToFront:{enable:e.canChangeFront},effectOpacity:{enable:!0,value:e.opacity},arrangeRotateMoreOptions:{enable:!0,value:e.rotateOption},arrangeRotateMoreOptionsInput:{enable:!0,value:e.rotateOption}};a||Qt(t,u,e.type)}function Wt(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(e){for(var t=e.length,n=[],r=0;r<t;r++)n.push({color:e[r].fromColor,offset:e[r].from}),r===t-1&&n.push({color:e[r].toColor,offset:e[r].to});return n}(e.gradientArray),o={effectClippingType1:{enable:1===e.count},effectClippingType2:{enable:1===e.count},effectClippingType3:{enable:1===e.count},effectClippingType4:{enable:1===e.count},effectClippingType5:{enable:1===e.count},effectClippingType6:{enable:1===e.count},effectEditClipping:{enable:Zt(e)},effectClearClipping:{enable:en(e)},shadingStyleGradientStops:{enable:!0,value:r},arrangeAlignmentVertically:{enable:e.count>1},arrangeAlignmentHorizontally:{enable:e.count>1},arrangeAlignmentLeft:{enable:e.count>1},arrangeAlignmentRight:{enable:e.count>1},arrangeAlignmentTop:{enable:e.count>1},arrangeAlignmentBottom:{enable:e.count>1},arrangeDistributeVertically:{enable:e.count>2},arrangeDistributeHorizontally:{enable:e.count>2},arrangeZorderToBack:{enable:e.canChangeBack},arrangeZorderToFront:{enable:e.canChangeFront},effectOpacity:{enable:!0,value:e.opacity},arrangeRotateMoreOptions:{enable:!0,value:e.rotateOption},arrangeRotateMoreOptionsInput:{enable:!0,value:e.rotateOption}};n||Qt(t,o,e.type)}function Gt(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={effectClippingType1:{enable:1===e.count},effectClippingType2:{enable:1===e.count},effectClippingType3:{enable:1===e.count},effectClippingType4:{enable:1===e.count},effectClippingType5:{enable:1===e.count},effectClippingType6:{enable:1===e.count},effectEditClipping:{enable:Zt(e)},effectClearClipping:{enable:en(e)},arrangeAlignmentVertically:{enable:e.count>1},arrangeAlignmentHorizontally:{enable:e.count>1},arrangeAlignmentLeft:{enable:e.count>1},arrangeAlignmentRight:{enable:e.count>1},arrangeAlignmentTop:{enable:e.count>1},arrangeAlignmentBottom:{enable:e.count>1},arrangeDistributeVertically:{enable:e.count>2},arrangeDistributeHorizontally:{enable:e.count>2},arrangeZorderToBack:{enable:e.canChangeBack},arrangeZorderToFront:{enable:e.canChangeFront},effectOpacity:{enable:!0,value:e.opacity}};n||Qt(t,r,ae.Image)}function Yt(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={effectClippingType1:{enable:1===e.count},effectClippingType2:{enable:1===e.count},effectClippingType3:{enable:1===e.count},effectClippingType4:{enable:1===e.count},effectClippingType5:{enable:1===e.count},effectClippingType6:{enable:1===e.count},effectEditClipping:{enable:Zt(e)},effectClearClipping:{enable:en(e)},arrangeAlignmentVertically:{enable:e.count>1},arrangeAlignmentHorizontally:{enable:e.count>1},arrangeAlignmentLeft:{enable:e.count>1},arrangeAlignmentRight:{enable:e.count>1},arrangeAlignmentTop:{enable:e.count>1},arrangeAlignmentBottom:{enable:e.count>1},arrangeDistributeVertically:{enable:e.count>2},arrangeDistributeHorizontally:{enable:e.count>2},arrangeZorderToBack:{enable:e.canChangeBack},arrangeZorderToFront:{enable:e.canChangeFront},effectOpacity:{enable:!0,value:e.opacity},arrangeRotateMoreOptions:{enable:!0,value:e.rotateOption},arrangeRotateMoreOptionsInput:{enable:!0,value:e.rotateOption}};n||Qt(t,r,e.type)}function Jt(e,t){var n;switch(e.scriptType){case de.None:n="";break;case de.Sub:n="font-subscript";break;case de.Super:n="font-superscript"}var r={fontFamily:{enable:!0,value:Ce[e.fontName]||e.fontName},fontSize:{enable:!0,value:e.fontSize},fontColor:{enable:!0,value:Vt(e.fontColor,"#")},fontBold:{enable:!0,value:e.isBold},fontItalic:{enable:!0,value:e.isItalic},fontStrikethrough:{enable:!0,value:e.isCross},fontUnderline:{enable:!0,value:e.isUnderline},fontSuperSubScript:{enable:!0,value:n},fontCharacterSpacing:{enable:!0,value:e.charSpace},fontWritingDirection:{enable:e.isAdding,value:e.isAdding?e.rtl?"rtl":"ltr":""},paragraphWordSpacing:{enable:!0,value:e.wordSpace},paragraphCharacterScale:{enable:!0,value:e.horzScale},paragraphAlign:{enable:!0,value:["left","center","right","justify"][e.alignment]},paragraphBullets:{enable:!1},paragraphNumbering:{enable:!1},paragraphIncrease:{enable:!1},paragraphDecrease:{enable:!1},paragraphLineSpacing:{enable:!0,value:e.lineSpace},paragraphSpacing:{enable:!1},splitMergeText:{enable:!1},splitRemoveKerning:{enable:!1},splitText:{enable:!1},splitToShape:{enable:!1},effectClippingType1:{enable:!1},effectClippingType2:{enable:!1},effectClippingType3:{enable:!1},effectClippingType4:{enable:!1},effectClippingType5:{enable:!1},effectClippingType6:{enable:!1},effectEditClipping:{enable:!1},effectClearClipping:{enable:!1},effectOpacity:{enable:!1},effectShear:{enable:!1},arrangePagecenterVertically:{enable:!1},arrangePagecenterHorizontally:{enable:!1},arrangePagecenterBoth:{enable:!1},arrangeAlignmentVertically:{enable:!1},arrangeAlignmentHorizontally:{enable:!1},arrangeAlignmentLeft:{enable:!1},arrangeAlignmentRight:{enable:!1},arrangeAlignmentTop:{enable:!1},arrangeAlignmentBottom:{enable:!1},arrangeDistributeVertically:{enable:!1},arrangeDistributeHorizontally:{enable:!1},arrangeRotateClockwise:{enable:!1},arrangeRotateCounterClockwise:{enable:!1},arrangeRotateMoreOptions:{enable:!1},arrangeFlipVertically:{enable:!1},arrangeFlipHorizontally:{enable:!1},arrangeZorderToBack:{enable:!1},arrangeZorderToFront:{enable:!1}};Oe.isTouchDevice&&(r.showKeyboard=!0),Qt(t,r,ae.Text)}function qt(){return qt=n((function(e,t){var n,r,o=arguments;return P(this,(function(a){return n=o.length>2&&void 0!==o[2]&&o[2],e&&((r=e.type)===ae.Text?$t(e,t,n):r===ae.Path?Kt(e,t,n):r===ae.Shading?Wt(e,t,n):r===ae.Mixed?Gt(e,t,n):r===ae.Image&&Yt(e,t,n)),[2]}))})),qt.apply(this,arguments)}function Xt(e){if(e){var t=e.getComponentByName("edit-properties");if(t){if(t.formatTab&&t.formatTab.$element){var n=t.formatTab.$element.find('[name="arrange-rotate-more-options-input"]');n&&n.val("")}t.disable()}}}function Qt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(e){var r=e.getComponentByName("sidebar-right");if(!r){var o=e.getComponentByName("edit-properties");if(!o)return;return o.enable(),void o.setHost(t,n)}r.show();var a=e.getComponentByName("sidebar-right-tabs");a.openTab("edit-properties-panel"),a.setActivetab("edit-properties-panel"),e.getComponentByName("edit-properties").setHost(t,n)}}function Zt(e){return!(e.count>1)&&(e.type===ae.Shading||e.clipPathCount>0)}function en(e){return!(e.count>1)&&(e.type!==ae.Shading&&e.clipPathCount>0)}function tn(e,t){return nn.apply(this,arguments)}function nn(){return(nn=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.setOpacity(t)];case 1:return n.sent(),[2]}}))}))).apply(this,arguments)}function rn(e,t){return on.apply(this,arguments)}function on(){return on=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.rotate(parseFloat(t))];case 1:return n.sent(),[2]}}))})),on.apply(this,arguments)}function an(e,t){return cn.apply(this,arguments)}function cn(){return(cn=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.flip(t)];case 1:return n.sent(),[2]}}))}))).apply(this,arguments)}function ln(e,t){return sn.apply(this,arguments)}function sn(){return(sn=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.shear(t)];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function un(e,t){return pn.apply(this,arguments)}function pn(){return(pn=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.align(t)];case 1:return n.sent(),[2]}}))}))).apply(this,arguments)}function dn(e,t){return gn.apply(this,arguments)}function gn(){return(gn=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.center(t)];case 1:return n.sent(),[2]}}))}))).apply(this,arguments)}function hn(e,t){return fn.apply(this,arguments)}function fn(){return(fn=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.distribute(t)];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function vn(e,t){return mn.apply(this,arguments)}function mn(){return(mn=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.changeRenderingOrder(t)];case 1:return n.sent(),[2]}}))}))).apply(this,arguments)}function bn(e){return yn.apply(this,arguments)}function yn(){return(yn=n((function(e){return P(this,(function(t){switch(t.label){case 0:return[4,e.clearClipPath()];case 1:return[2,t.sent()]}}))}))).apply(this,arguments)}function Pn(e){return Cn.apply(this,arguments)}function Cn(){return(Cn=n((function(e){return P(this,(function(t){switch(t.label){case 0:return[4,e.editClipPath()];case 1:return[2,t.sent()]}}))}))).apply(this,arguments)}function Sn(e,t){return En.apply(this,arguments)}function En(){return(En=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.addClipPath(t)];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function wn(e,t){return xn.apply(this,arguments)}function xn(){return(xn=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.setFontSize(parseInt(t))];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function kn(e,t){return In.apply(this,arguments)}function In(){return(In=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.setHorizontalScale(t)];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function An(e,t){return _n.apply(this,arguments)}function _n(){return(_n=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.setCharSpace(t)];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function Tn(e,t){return Mn.apply(this,arguments)}function Mn(){return(Mn=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.setWordSpace(t)];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function On(e,t,n,r,o){return Rn.apply(this,arguments)}function Rn(){return(Rn=n((function(e,t,n,r,o){return P(this,(function(a){return[2,e.setFont(t,n,r,o)]}))}))).apply(this,arguments)}function Dn(e){return Fn.apply(this,arguments)}function Fn(){return(Fn=n((function(e){return P(this,(function(t){switch(t.label){case 0:return[4,e.removeTextKerning()];case 1:return[2,t.sent()]}}))}))).apply(this,arguments)}function jn(e){return Bn.apply(this,arguments)}function Bn(){return(Bn=n((function(e){return P(this,(function(t){switch(t.label){case 0:return[4,e.mergeText()];case 1:return[2,t.sent()]}}))}))).apply(this,arguments)}function Nn(e,t){return Un.apply(this,arguments)}function Un(){return(Un=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return t=t.sort((function(e,t){return e-t})),[4,e.splitText(t)];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function Ln(e,t,n){return Vn.apply(this,arguments)}function Vn(){return(Vn=n((function(e,t,n){return P(this,(function(r){switch(r.label){case 0:return e.json.fillColorSpace=2,[4,e.setFillColor(Lt(t),n)];case 1:return[2,r.sent()]}}))}))).apply(this,arguments)}function Hn(e,t){return zn.apply(this,arguments)}function zn(){return(zn=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.setLineWidth(t)];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function $n(e,t){return Kn.apply(this,arguments)}function Kn(){return(Kn=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.setMiterLimit(t)];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function Wn(e,t){return Gn.apply(this,arguments)}function Gn(){return(Gn=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.setLineCap(t)];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function Yn(e,t){return Jn.apply(this,arguments)}function Jn(){return(Jn=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,e.setLineJoin(t)];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function qn(e,t){return Xn.apply(this,arguments)}function Xn(){return(Xn=n((function(e,t){return P(this,(function(n){return[2,e.setLineStyle(t)]}))}))).apply(this,arguments)}function Qn(e,t){return Zn.apply(this,arguments)}function Zn(){return Zn=n((function(e,t){var n,r=arguments;return P(this,(function(o){switch(o.label){case 0:return n=r.length>2&&void 0!==r[2]&&r[2],e.setColorSpace("fillColorSpace",2),[4,e.setFillColor(Lt(t),n)];case 1:return[2,o.sent()]}}))})),Zn.apply(this,arguments)}function er(e,t){return tr.apply(this,arguments)}function tr(){return tr=n((function(e,t){var n,r=arguments;return P(this,(function(o){return n=r.length>2&&void 0!==r[2]&&r[2],e.setColorSpace("strokeColorSpace",2),[2,e.setStrokeColor(Lt(t),n)]}))})),tr.apply(this,arguments)}function nr(e,t){return rr.apply(this,arguments)}function rr(){return(rr=n((function(e,t){return P(this,(function(n){return[2,e.changeShadingColor(t)]}))}))).apply(this,arguments)}function or(){return(or=n((function(e){return P(this,(function(t){return[2,e.editReferenceLine()]}))}))).apply(this,arguments)}function ar(e,t){return ir.apply(this,arguments)}function ir(){return(ir=n((function(e,t){return P(this,(function(n){return[2,e.setGradientColorShowRect(t)]}))}))).apply(this,arguments)}function cr(e,t){return lr.apply(this,arguments)}function lr(){return(lr=n((function(e,t){return P(this,(function(n){return[2,e.setGradientCurrentInfo(t)]}))}))).apply(this,arguments)}function sr(e){return ur.apply(this,arguments)}function ur(){return(ur=n((function(e){var t;return P(this,(function(n){switch(n.label){case 0:return[4,e.getEditingObject()];case 1:return t=n.sent(),[2,e.createEditingObjectProxy(t)]}}))}))).apply(this,arguments)}function pr(){return(pr=n((function(e,t,n){return P(this,(function(r){switch(r.label){case 0:return[4,sr(e)];case 1:return[2,r.sent().OnFontNameChanged(t,n)]}}))}))).apply(this,arguments)}function dr(){return(dr=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,sr(e)];case 1:return[2,n.sent().OnFontSizeChanged(t)]}}))}))).apply(this,arguments)}function gr(){return(gr=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,sr(e)];case 1:return[2,n.sent().OnTextColorChanged(Lt(t))]}}))}))).apply(this,arguments)}function hr(){return(hr=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,sr(e)];case 1:return[2,n.sent().OnBoldChanged(t)]}}))}))).apply(this,arguments)}function fr(){return(fr=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,sr(e)];case 1:return[2,n.sent().OnItalicChanged(t)]}}))}))).apply(this,arguments)}function vr(e,t){return mr.apply(this,arguments)}function mr(){return(mr=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,sr(e)];case 1:return[2,n.sent().OnAlignChanged(t)]}}))}))).apply(this,arguments)}function br(){return(br=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,sr(e)];case 1:return[2,n.sent().OnCharSpaceChanged(t)]}}))}))).apply(this,arguments)}function yr(){return(yr=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,sr(e)];case 1:return[2,n.sent().OnWordSpaceChanged(t)]}}))}))).apply(this,arguments)}function Pr(){return(Pr=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,sr(e)];case 1:return[2,n.sent().OnCharHorzScaleChanged(t)]}}))}))).apply(this,arguments)}function Cr(){return(Cr=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,sr(e)];case 1:return[2,n.sent().OnLineLeadingChanged(t)]}}))}))).apply(this,arguments)}function Sr(){return(Sr=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,sr(e)];case 1:return[2,n.sent().OnUnderlineChanged(t)]}}))}))).apply(this,arguments)}function Er(){return(Er=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,sr(e)];case 1:return[2,n.sent().OnCrossChanged(t)]}}))}))).apply(this,arguments)}function wr(e,t){return xr.apply(this,arguments)}function xr(){return(xr=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,sr(e)];case 1:return[2,n.sent().OnSuperScriptChanged(t)]}}))}))).apply(this,arguments)}function kr(e,t){return Ir.apply(this,arguments)}function Ir(){return(Ir=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,sr(e)];case 1:return[2,n.sent().OnSubScriptChanged(t)]}}))}))).apply(this,arguments)}function Ar(e,t){return _r.apply(this,arguments)}function _r(){return(_r=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,sr(e)];case 1:return[2,n.sent().OnWritingDirectionChanged(t)]}}))}))).apply(this,arguments)}function Tr(e,t,n,r,o){return Mr.apply(this,arguments)}function Mr(){return Mr=n((function(e,t,n,r,o){var a,i,c,l,s,u,p,d,g=arguments;return P(this,(function(h){switch(h.label){case 0:switch(a=g.length>5&&void 0!==g[5]&&g[5],c={},e&&(c=e.json,i=c.type),l=o.getComponentByName("edit-properties"),s=l.formatTab,i){case ae.Text:return[3,1];case ae.Path:return[3,3];case ae.Shading:return[3,5];case ae.Image:return[3,7];case ae.Mixed:return[3,9]}return[3,11];case 1:return[4,Or(t,s,e,n,r)];case 2:return h.sent(),[3,15];case 3:return[4,Dr(t,s,e,n,r)];case 4:return h.sent(),[3,15];case 5:return[4,jr(t,s,e,n,r)];case 6:return h.sent(),[3,15];case 7:return[4,Nr(t,s,e,n,r)];case 8:return h.sent(),[3,15];case 9:return[4,Lr(t,s,e,n,r)];case 10:return h.sent(),[3,15];case 11:return[4,t.getEditingObject()];case 12:return(u=h.sent())?u.type!==ie.Text?[3,14]:[4,Hr(t,s,u,n,r)]:[2];case 13:h.sent(),h.label=14;case 14:return[3,15];case 15:return[4,t.getActiveObject()];case 16:return(p=h.sent())?(d=p.json,"arrange-rotate-more-options"===n&&(d.rotateOption=r),function(e,t){qt.apply(this,arguments)}(d,o,a),[2]):[2]}}))})),Mr.apply(this,arguments)}function Or(e,t,n,r,o){return Rr.apply(this,arguments)}function Rr(){return(Rr=n((function(e,t,n,r,o){var a,i,c,l,s;return P(this,(function(u){switch(u.label){case 0:return[4,t];case 1:switch(a=u.sent()&&t.getStates(["fontFamily","fontBold","fontItalic"])||{},i=a.fontFamily,c=a.fontBold,l=a.fontItalic,r){case"font-family":return[3,2];case"font-bold":return[3,4];case"font-italic":return[3,6];case"font-size":return[3,8];case"font-color":return[3,10];case"font-character-spacing":return[3,12];case"paragraph-word-spacing":return[3,14];case"paragraph-character-scale":return[3,16];case"split-merge-text":return[3,18];case"split-remove-kerning":return[3,20];case"split-text":return[3,22];case"split-to-shape":return[3,24]}return[3,26];case 2:return c=void 0===c?n.json.fontIsBold:c,l=void 0===l?n.json.fontIsItalic:l,[4,On(n,o,c,l,0)];case 3:case 5:case 7:case 9:case 11:case 13:case 15:case 17:case 19:case 21:case 23:case 25:return u.sent(),[3,26];case 4:return l=void 0===l?n.json.fontIsItalic:l,0==(s=i||n.json.baseFontName).length?[2]:[4,On(n,s,o,l,1)];case 6:return c=void 0===c?n.json.fontIsBold:c,0==(i||n.json.baseFontName).length?[2]:[4,On(n,i||n.json.baseFontName,c,o,2)];case 8:return[4,wn(n,parseInt(o))];case 10:return[4,Ln(n,o,!0)];case 12:return[4,An(n,parseInt(o))];case 14:return[4,Tn(n,parseInt(o))];case 16:return[4,kn(n,parseInt(o))];case 18:return[4,qr(n,t)];case 20:return[4,Dn(n)];case 22:return[4,Nn(n,o)];case 24:return[4,e.text2Path()];case 26:return[4,$r(e,n,r,o)];case 27:return u.sent(),[4,Wr(e,n,r,o)];case 28:return u.sent(),[2]}}))}))).apply(this,arguments)}function Dr(e,t,n,r,o){return Fr.apply(this,arguments)}function Fr(){return(Fr=n((function(e,t,n,r,o){var a,i,c,l;return P(this,(function(e){switch(e.label){case 0:switch(a=oe.LineCap,i=fe,c=oe.LineJoin,l=ve,r){case"shape-style-color":return[3,1];case"shape-style-line-color":return[3,6];case"shape-style-fill-color":return[3,8];case"shape-style-opacity":return[3,10];case"shape-style-line-width":return[3,12];case"shape-style-dash-type":return[3,14];case"shape-style-line-cap":return[3,16];case"shape-style-line-join":return[3,24];case"shape-style-miter-limit":return[3,32]}return[3,34];case 1:return"string"!=typeof o.borderColor?[3,3]:[4,er(n,o.borderColor)];case 2:e.sent(),e.label=3;case 3:return"string"!=typeof o.backgroundColor?[3,5]:[4,Qn(n,o.backgroundColor)];case 4:e.sent(),e.label=5;case 5:return[3,34];case 6:return[4,er(n,o)];case 7:return e.sent(),[3,34];case 8:return[4,Qn(n,o)];case 9:return e.sent(),[3,34];case 10:return[4,tn(n,parseFloat(o))];case 11:return e.sent(),[3,34];case 12:return[4,Hn(n,parseInt(o))];case 13:return e.sent(),[3,34];case 14:return[4,Yr(n,o)];case 15:return e.sent(),[3,34];case 16:switch(o){case a.ProjectingSquareCap:return[3,17];case a.Round:return[3,19];case a.Butt:return[3,21]}return[3,23];case 17:return[4,Wn(n,i.ProjectingSquareCap)];case 18:return e.sent(),[3,23];case 19:return[4,Wn(n,i.Round)];case 20:return e.sent(),[3,23];case 21:return[4,Wn(n,i.Butt)];case 22:return e.sent(),[3,23];case 23:return[3,34];case 24:switch(o){case c.Miter:return[3,25];case c.Round:return[3,27];case c.Bevel:return[3,29]}return[3,31];case 25:return[4,Yn(n,l.Miter)];case 26:return e.sent(),[3,31];case 27:return[4,Yn(n,l.Round)];case 28:return e.sent(),[3,31];case 29:return[4,Yn(n,l.Bevel)];case 30:return e.sent(),[3,31];case 31:return[3,34];case 32:return[4,$n(n,parseInt(o))];case 33:return e.sent(),[3,34];case 34:return[4,$r(n,n,r,o)];case 35:return e.sent(),[4,Wr(n,n,r,o)];case 36:return e.sent(),[2]}}))}))).apply(this,arguments)}function jr(e,t,n,r,o){return Br.apply(this,arguments)}function Br(){return Br=n((function(e,t,n,r,o){return P(this,(function(t){switch(t.label){case 0:switch(r){case"shading-style-gradient-stops":return[3,1];case"shading-style-color":return[3,5];case"shading-style-reference-line":return[3,9]}return[3,10];case 1:case 5:return[4,ar(n,{left:0,bottom:60,right:225,top:40})];case 2:case 6:return t.sent(),[4,cr(n,Ut(o))];case 3:case 7:return t.sent(),[4,nr(n,!0)];case 4:case 8:return t.sent(),[3,10];case 9:return function(e){or.apply(this,arguments)}(n),[3,10];case 10:return[4,$r(e,n,r,o)];case 11:return t.sent(),[4,Wr(e,n,r,o)];case 12:return t.sent(),[2]}}))})),Br.apply(this,arguments)}function Nr(e,t,n,r,o){return Ur.apply(this,arguments)}function Ur(){return(Ur=n((function(e,t,n,r,o){return P(this,(function(t){switch(t.label){case 0:return[4,$r(e,n,r,o)];case 1:return t.sent(),[4,Wr(e,n,r,o)];case 2:return t.sent(),[2]}}))}))).apply(this,arguments)}function Lr(e,t,n,r,o){return Vr.apply(this,arguments)}function Vr(){return(Vr=n((function(e,t,n,r,o){return P(this,(function(t){switch(t.label){case 0:return[4,$r(e,n,r,o)];case 1:return t.sent(),[4,Wr(e,n,r,o)];case 2:return t.sent(),[2]}}))}))).apply(this,arguments)}function Hr(e,t,n,r,o){return zr.apply(this,arguments)}function zr(){return zr=n((function(e,t,n,r,o){var a;return P(this,(function(n){switch(n.label){case 0:return[4,t];case 1:switch(a=(n.sent()&&t.getStates(["fontBold"])||{}).fontBold,r){case"font-family":a=void 0===a?selection.json.fontIsBold:a,function(e,t,n){pr.apply(this,arguments)}(e,o,a);break;case"font-size":!function(e,t){dr.apply(this,arguments)}(e,parseInt(o));break;case"font-color":!function(e,t){gr.apply(this,arguments)}(e,o);break;case"font-bold":!function(e,t){hr.apply(this,arguments)}(e,o);break;case"font-italic":!function(e,t){fr.apply(this,arguments)}(e,o);break;case"font-underline":!function(e,t){Sr.apply(this,arguments)}(e,o);break;case"font-strikethrough":!function(e,t){Er.apply(this,arguments)}(e,o);break;case"font-super-sub-script":o.indexOf("font-superscript")>=0?(kr(e,!1),wr(e,!0)):o.indexOf("font-subscript")>=0?(wr(e,!1),kr(e,!0)):(kr(e,!1),wr(e,!1));break;case"font-character-spacing":!function(e,t){br.apply(this,arguments)}(e,o);break;case"font-writing-direction":o.indexOf("rtl")>=0?Ar(e,he.Right2Left):o.indexOf("ltr")>=0&&Ar(e,he.Left2Right);break;case"paragraph-align":switch(o){case"left":vr(e,le.Left);break;case"right":vr(e,le.Right);break;case"center":vr(e,le.Center);break;case"justify":vr(e,le.Justify)}break;case"paragraph-word-spacing":!function(e,t){yr.apply(this,arguments)}(e,parseFloat(o));break;case"paragraph-character-scale":!function(e,t){Pr.apply(this,arguments)}(e,parseFloat(o));break;case"paragraph-line-spacing":!function(e,t){Cr.apply(this,arguments)}(e,parseFloat(o))}return[2]}}))})),zr.apply(this,arguments)}function $r(e,t,n,r){return Kr.apply(this,arguments)}function Kr(){return(Kr=n((function(e,t,n,r){return P(this,(function(e){switch(e.label){case 0:switch(n){case"effect-clipping-type1":return[3,1];case"effect-clipping-type2":return[3,3];case"effect-clipping-type3":return[3,5];case"effect-clipping-type4":return[3,7];case"effect-clipping-type5":return[3,9];case"effect-clipping-type6":return[3,11];case"effect-edit-clipping":return[3,13];case"effect-clear-clipping":return[3,15];case"effect-opacity":return[3,17];case"effect-shear":return[3,19]}return[3,21];case 1:return[4,Sn(t,pe.RoundRect)];case 2:case 4:case 6:case 8:case 10:case 12:case 14:case 16:case 18:case 20:return e.sent(),[3,21];case 3:return[4,Sn(t,pe.Ellipse)];case 5:return[4,Sn(t,pe.Rectangle)];case 7:return[4,Sn(t,pe.Polygon)];case 9:return[4,Sn(t,pe.Curve)];case 11:return[4,Sn(t,pe.Freedom)];case 13:return[4,Pn(t)];case 15:return[4,bn(t)];case 17:return[4,tn(t,parseFloat(r))];case 19:return[4,ln(t,parseInt(r))];case 21:return[2]}}))}))).apply(this,arguments)}function Wr(e,t,n,r){return Gr.apply(this,arguments)}function Gr(){return(Gr=n((function(e,t,n,r){return P(this,(function(e){switch(e.label){case 0:switch(n){case"arrange-rotate-clockwise":return[3,1];case"arrange-rotate-counter-clockwise":return[3,2];case"arrange-flip-vertically":return[3,3];case"arrange-flip-horizontally":return[3,4];case"arrange-rotate-more-options":return[3,5];case"arrange-zorder-to-back":return[3,6];case"arrange-zorder-to-front":return[3,8];case"arrange-pagecenter-vertically":return[3,10];case"arrange-pagecenter-horizontally":return[3,11];case"arrange-pagecenter-both":return[3,12];case"arrange-alignment-vertically":return[3,13];case"arrange-alignment-horizontally":return[3,14];case"arrange-alignment-left":return[3,15];case"arrange-alignment-right":return[3,16];case"arrange-alignment-top":return[3,17];case"arrange-alignment-bottom":return[3,18];case"arrange-distribute-vertically":return[3,19];case"arrange-distribute-horizontally":return[3,20]}return[3,21];case 1:return rn(t,-Math.PI/2),[3,21];case 2:return rn(t,Math.PI/2),[3,21];case 3:return an(t,!0),[3,21];case 4:return an(t,!1),[3,21];case 5:return rn(t,-parseFloat(r)/180*Math.PI),[3,21];case 6:return[4,vn(t,ue.Back)];case 7:case 9:return e.sent(),[3,21];case 8:return[4,vn(t,ue.Front)];case 10:return dn(t,se.Vertical),[3,21];case 11:return dn(t,se.Horizontal),[3,21];case 12:return dn(t,se.Both),[3,21];case 13:return un(t,ce.Vertical),[3,21];case 14:return un(t,ce.Horizontal),[3,21];case 15:return un(t,ce.Left),[3,21];case 16:return un(t,ce.Right),[3,21];case 17:return un(t,ce.Top),[3,21];case 18:return un(t,ce.Bottom),[3,21];case 19:return hn(t,!0),[3,21];case 20:return hn(t,!1),[3,21];case 21:return[2]}}))}))).apply(this,arguments)}function Yr(e,t){return Jr.apply(this,arguments)}function Jr(){return(Jr=n((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,qn(e,{1:[],2:[2,2],3:[3,3],4:[4,4],5:[4,3,2,3],6:[4,3,16,3],7:[8,4,4,4]}[t])];case 1:return n.sent(),[2]}}))}))).apply(this,arguments)}function qr(e,t){return Xr.apply(this,arguments)}function Xr(){return(Xr=n((function(e,t){var n;return P(this,(function(r){switch(r.label){case 0:return[4,jn(e)];case 1:return r.sent()||(n=t.pdfUI).alert(n.i18n.t("page-editor:alert.mertTextFaided")),[2]}}))}))).apply(this,arguments)}var Qr="unique_"+Date.now().toString(36),Zr=0;var eo,to=(eo="contextmenu",function(e){return"fv--plugin-".concat(eo,"-").concat(e)});function no(e){var t=e.text,n=e.isEnabled,r=e.submenu,o="";!1===n&&(o=' disabled="true"');var a="";a+="\n      <dropdown".concat(o," separate='false' align='out-right' valign='top' text='").concat(t,"'>");var i=!0,c=!1,l=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var p=s.value;p.submenu?a+=no(p):a+=ro(p)}}catch(e){c=!0,l=e}finally{try{i||null==u.return||u.return()}finally{if(c)throw l}}return a+="\n      </dropdown>"}function ro(e){var t,n=e.type,r=e.text,o=e.isEnabled,a=e.onClickId;if(n&&"default"!==n){if("separator"!==n)return"";t="contextmenu-separator"}else t="contextmenu-item";var i="";!1===o&&(i=' disabled="true"');var c="";return void 0!==a&&(c=" @on.click=\"ctrl.itemClick('".concat(a,"')\"")),"\n      <".concat(t).concat(i).concat(c," class='fv__plugin-contextmenu-item'>").concat(r||"","</").concat(t,">")}function oo(e,t){var n,r=to([n||"",Qr,Zr++].join("_")),o=function(e,t){var n="";n+="<contextmenu name='".concat(t||"","' @controller.alias='ctrl' @on.hide='ctrl.onClose'>");var r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var l=i.value;l.submenu?n+=no(l):n+=ro(l)}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n+"\n    </contextmenu>"}(t,r);return e.rootComponent.append(o,[{target:r,config:{callback:function(t){g(o,t);var n=y(o);function o(){return i(this,o),n.apply(this,arguments)}return l(o,[{key:"itemClick",value:function(t){switch(t){case"PopupMenuItem_e_PopupMenuItemProperties":e.openDialog("pageEditorProps");break;case"PopupMenuItem_e_PopupMenuItemShear":case"PopupMenuItem_e_PopupMenuItemRotateMoreOptions":break;default:e.pdfViewer.currentPDFDoc.pageEditor.triggerPopMenuAction(t)}}},{key:"onClose",value:function(){!function(e,t){var n=e.getComponentByName(t);n.hide()}(e.rootComponent,r)}}]),o}(C.Controller)}}]),r}var ao=["PopupMenuItem_e_PopupMenuItemShear","PopupMenuItem_e_PopupMenuItemRotateMoreOptions"];function io(e,t,n){return co.apply(this,arguments)}function co(){return(co=n((function(e,t,n){var r,o,a,i,c,l,s,u;return P(this,(function(p){switch(p.label){case 0:r=[],o=!0,a=!1,i=void 0,p.label=1;case 1:p.trys.push([1,6,7,8]),c=e[Symbol.iterator](),p.label=2;case 2:return(o=(l=c.next()).done)?[3,5]:[4,lo(l.value,t,n)];case 3:(s=p.sent())&&r.push(s),p.label=4;case 4:return o=!0,[3,2];case 5:return[3,8];case 6:return u=p.sent(),a=!0,i=u,[3,8];case 7:try{o||null==c.return||c.return()}finally{if(a)throw i}return[7];case 8:return[2,r=function(e){for(var t=[],n=0,r=e.length-1,o=0;o<e.length;o++){if("separator"!==e[o].type)break;n++}for(var a=e.length-1;a>=0;a--){if("separator"!==e[a].type)break;r--}if(r<n)return[];for(var i=!1,c=n;c<=r;c++){var l=e[c];if("separator"===l.type){if(i)continue;i=!0}else i=!1;t.push(l)}return t}(r)]}}))}))).apply(this,arguments)}function lo(e,t,n){return so.apply(this,arguments)}function so(){return(so=n((function(e,t,n){var r,o,a,i,c,l,s,u;return P(this,(function(p){switch(p.label){case 0:return(r=t.activeObject)?ao.indexOf(e.name)>=0?[2]:(d=e.name,"separator"===(o="-"===d?"separator":"default")?[2,{type:o}]:(a=me[e.name],i=a?"page-editor:popMenu."+a:"","EditObject"!==a||r.type!==ie.Image?[3,1]:(c=!1,[3,3]))):[2];case 1:return[4,uo(e,t,n)];case 2:c=p.sent(),p.label=3;case 3:return l=e.name,e.subItems?[4,io(e.subItems,t,n)]:[3,5];case 4:s=p.sent(),p.label=5;case 5:return u={text:i,isEnabled:c,onClickId:l},s&&(u.submenu=s),[2,u]}var d}))}))).apply(this,arguments)}function uo(e,t,n){return po.apply(this,arguments)}function po(){return po=n((function(e,t,r){var o,a;function i(e){return c.apply(this,arguments)}function c(){return(c=n((function(e){var n,o,a,i,c,l;return P(this,(function(s){switch(s.label){case 0:n=!0,o=!1,a=void 0,s.label=1;case 1:s.trys.push([1,6,7,8]),i=e[Symbol.iterator](),s.label=2;case 2:return(n=(c=i.next()).done)?[3,5]:[4,uo(c.value,t,r)];case 3:if(s.sent())return[2,!0];s.label=4;case 4:return n=!0,[3,2];case 5:return[3,8];case 6:return l=s.sent(),o=!0,a=l,[3,8];case 7:try{n||null==i.return||i.return()}finally{if(o)throw a}return[7];case 8:return[2,!1]}}))}))).apply(this,arguments)}return P(this,(function(n){switch(n.label){case 0:return o=t.activeObject,a=t.editingObject,0!==Object.keys(o).length||0!==Object.keys(a).length?[3,4]:"PopupMenuItem_e_PopupMenuItemPaste"!==e.name?[3,2]:[4,r.currentPDFDoc.pageEditor.canPaste()];case 1:return[2,n.sent()];case 2:return[2,!1];case 3:return[3,8];case 4:return e.enable||void 0===e.enable?e.subItems?[4,i(e.subItems)]:[3,6]:[2,!1];case 5:return[2,n.sent()];case 6:if(e.enable||void 0===e.enable)return[2,!0];n.label=7;case 7:return[2,!1];case 8:return[2]}}))})),po.apply(this,arguments)}function go(e){jt.addingText=e}var ho,fo=C.vendors.jQuery,vo=C.PDFViewCtrl,mo=vo.shared,bo=mo.debounce,yo=mo.ThrottleAsyncTaskExecutor,Po=C.vendors.Hammer,Co=C.UIEvents,So=Promise.resolve(),Eo=C.PDFViewCtrl,wo=Eo.DeviceInfo,xo=wo.isTouchDevice,ko=wo.isMobile,Io=wo.isTablet,Ao=Eo.shared.createDeferred,_o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"OnKeyDown";return So=So.then((function(n){return St.trigger(t,[e.keyCode,L(e)])}))},To=!0,Mo=0,Oo=navigator.userAgent.toLowerCase(),Ro=/opera|opr/.test(Oo),Do=/msie/.test(Oo),Fo=(/trident/.test(Oo)||Do)&&!Ro&&"msSaveBlob"in navigator,jo=function(e){g(r,e);var t=y(r);function r(e){var n;return i(this,r),(n=t.call(this,e)).destroyHooks=[],n.hasSelection=!1,n.canScroll=!0,n.component=e.viewerUI.rootComponent.getComponentByName("fv--plugin-PageEditor-add-text"),n.disableToggleCaret=!1,window&&(window.PageEditorTrigger=St),n}return l(r,[{key:"goToPage",value:function(e,t,n){if(this.docRender){var r=this.docRender.getPDFPageRender(e);if(r){var o=v(r.getPDFPointFromClientPoint(t,n,!0),2),a=o[0],i=o[1],c=this.docRender.pdfViewer,l=this.uiContainerRect.height||0;c.goToPage(e,i-l/4,a,!1)}}}},{key:"hitTest",value:function(e,t,n){if(!this.docRender)return!1;var r=this.docRender.getPDFPageRender(e);if(!r)return!1;var o=v(r.getPDFPointFromClientPoint(t,n,!1),2),a=o[0],i=o[1];if(!this.selectionText)return!1;var c=this.selectionText,l=c.x,s=c.y,u=c.width,p=c.height;return a>=l&&a<=l+u&&i>=s&&i<=s+p}},{key:"docHandler",value:function(e){var t=this,r=this;this.documentMouseupFinalUpdateCount=0;var o=this.pdfViewer;this.docRender=e;var a=this.doc=e.doc;ho=this;var i=o.viewerUI.loading(),c=this.startPromise=a.startPageEdit(wt(),kt(),At(),Tt()).then((function(e){o.getEventEmitter().emit("pageeditor-started"),i()}));St.setDocRender(this.docRender),this.keyMgr=new N({skipKey:function(e){var t=document.activeElement!==j.getElement()[0];return t?!H[e]&&void 0:t},keydown:function(e){var n=t.handleSystemCommand(e);if([37,38,39,40].indexOf(e.keyCode)>=0&&t.hasSelection&&(e.preventDefault(),e.stopPropagation()),8==e.keyCode&&St.trigger("OnChar",[String.fromCharCode(e.keyCode)]),n)return!1;_o(e).then((function(n){return t.actionFinalUpdate(e)}))},keyup:function(e){13==e.keyCode?St.trigger("OnChar",[String.fromCharCode(e.keyCode)]).then((function(n){return t.actionFinalUpdate(e)})):_o(e,"OnKeyUp").then((function(n){return t.actionFinalUpdate(e)}));var n=document.activeElement===j.getElement()[0];!0!==t.doc.docModified&&n&&t.doc.setDocModified()}}),fo(document).on("focusin",this.focusin=function(e){Re(e,j,Mo,(function(){return t.keyMgr.start()}),(function(){return t.keyMgr.stop()}),(function(){return St.trigger("RestartEdit")}))}),fo(document).on("mouseup",this.cancelDown=function(e){if(!(e.target.classList&&e.target.classList.contains("fv__pdf-doc-handler-container")||fo(e.target).hasClass("icon-btn")||fo(e.target).parents(".icon-btn").length||fo(e.target).parents('[name="fv--plugin-PageEditor-add-shape"]').length||2===e.button||t.documentMouseupFinalUpdateCount>0||fo(e.target).parents(".fv__ui-contextmenu-item").length||fo(e.target).parents(".fv__ui-layer"))){var n=V(e,"Up");return setTimeout((function(){t.docRender&&St.trigger(n,St.getArgs(0,e,0,L(e))).then((function(e){return t.actionFinalUpdate()}))}),200)}}),window.addEventListener("wheel",this.cancelWheel=function(e){t.canScroll||e.preventDefault()},{passive:!1}),this.setEditorNotifier();var l=function(){r.uiContainerRect=e.pdfViewer.$ui[0].parentElement.getBoundingClientRect(),c.then((function(){return gt(o,0,0)}))};this.destroyHooks.push(o.addEventListener("before-zoom-to",(function(){var e=o.getPDFDocRender();if(e){var n=e.$ui.find(".pe_handler_container");["top","left","width","height","right","bottom"].forEach((function(e){n[0].style[e]=null,t.$handler&&(t.$handler[0].style[e]=null)}))}}))),["fitWidthResizeViewport","zoomToSuccess","afterDocumentRotation"].map((function(e){return vo.Events[e]})).forEach((function(e){t.destroyHooks.push(o.addEventListener(e,l))}));var s=function(){var e=["","Text","Path","Image","Shading","XObject","Size"].map((function(e){return o.i18n.t("page-editor:"+e)}));return St.trigger("ChangeLanguage",[e])};this.destroyHooks.push(o.addEventListener("change-language-success",s)),c.then((function(){return s()})).then((function(){l(!1)})),this.destroyHooks.push(o.addEventListener("PageEditor_onStartClick",(function(){t.disableRightPanel=!0})),o.addEventListener("PageEditor_onEndClick",(function(){t.disableRightPanel=!1})),o.addEventListener("editPropertiesAction",(function(e){xo?"font-family"!==e.name&&"paragraph-numbering"!==e.name&&"paragraph-align"!==e.name&&"paragraph-increase"!==e.name&&"paragraph-decrease"!==e.name||(t.disableToggleCaret=!0):Mo+0&&("font-family"===e.name||"font-size"===e.name)&&j.getElement().focus();var n=o.getCurrentPDFDoc();if(n&&"page-editor"===o.getStateHandlerManager().currentStateHandler.getStateName()){var r=n.getPageEditor();r.getActiveObject().then((function(t){Tr(t,r,e.name,e.value,o.viewerUI.rootComponent)}))}})),o.addEventListener("PE-mouseMoveEnd",(function(){var e=t.doc;e&&e.getPageEditor().getActiveObject().then((function(e){if(e){var t=e.json;t.type===ae.Text&&$t(t,o.viewerUI.rootComponent)}}))})),o.addEventListener("pageeditor-notify",(function(e,n){var r=t.doc;if(r){var a,i,c,l=r.getPageEditor();switch(e){case"enterEdit":n===ie.Text&&(j.getElement().focus(),Oe.isIOS&&t.tempInput&&t.tempInput.remove()),function(e,t,n){Ht.apply(this,arguments)}(l,n,o.viewerUI.rootComponent);break;case"exitEdit":go(!1),Xt(o.viewerUI.rootComponent);break;case"selectionChange":l.getActiveObject().then((function(e){JSON.stringify((t.currActiveObject||{}).json)!==JSON.stringify((e||{}).json)&&(!function(e,t,n,r){zt.apply(this,arguments)}(e,l,o.viewerUI.rootComponent,t.disableRightPanel),t.pdfViewer.eventEmitter.emit(Co.objectSelectionChanged,e?e.json:void 0)),t.currActiveObject=e}));break;case"showPopupMenu":l.getActiveObject().then((function(e){var t=Promise.resolve(!0);e||(t=l.getEditingObject().then((function(e){return!!e}))),t.then((function(e){e&&io(n.menu,n,o).then((function(e){var t=oo(o.viewerUI,e),r=n.position,a=r.x,i=r.y;!function(e,t,n,r){var o=document.querySelector(".fv__ui-pdfviewer").getBoundingClientRect(),a=o.x,i=o.y;e.getComponentByName(t).showAt(n+a,r+i)}(o.viewerUI.rootComponent,t,a,i)}))}))}));break;case"caretChange":ko&&Io||j.getElement().focus(),bo(50,Jt((i=(a=n).charProp,c=a.wordProp,{fontName:a.fontName||"Helvetica",fontSize:c.fontSize||18,rtl:i.rtl||!1,charSpace:c.charSpace||0,wordSpace:c.wordSpace||0,fontColor:c.wordColor||"#000000",horzScale:c.horzScale||100,isBold:c.isBold||!1,isItalic:c.isItalic||!1,isCross:c.isCross||!1,isUnderline:c.isUnderline||!1,scriptType:c.scriptType,alignment:i.alignment||le.Left,isAdding:Bt(),lineSpace:i.lineLeading}),o.viewerUI.rootComponent))}}})),o.addEventListener(Co.switchStateHandler,(function(){t.selectionText=null})),xo?o.addEventListener("refocusInput",(function(){t.disableToggleCaret=!1,j.refocusInput()})):function(){});var u=this.$handler=e.$container.siblings(".fv__pdf-doc-handler-container");u.css("z-index",82);var p=u.get(0);Oe.isIOS&&this.destroyHooks.push((function(){t.tempInput&&t.tempInput.parentElement&&t.tempInput.remove()}),(0,Oe.onTap)({target:p,onDoubleTap:function(e){t.triggerDoubleClick(e);var n=St.getPageIndex(e);-1!==n&&t.selectionText&&t.hitTest(n,Ue(e.srcEvent),Le(e.srcEvent))&&(t.tempInput=document.createElement("div"),t.tempInput.contentEditable=!0,t.tempInput.style="pointer-events: none;position:absolute;left:0;top:0;right:0;bottom:0;opacity: 0.001;",p.appendChild(t.tempInput),t.tempInput.focus({preventScroll:!0}))},onSingleTap:function(e){t.triggerClick(e,1).then((function(n){var r=St.getPageIndex(e);-1!==r&&t.doc.getPageEditor().getActiveObject().then((function(n){if(n){t.goToPage(r,Ue(e.srcEvent),Le(e.srcEvent));var o=n.json;o.type===ae.Text?t.selectionText={x:o.xPosition,y:o.yPosition,width:o.width,height:o.height}:t.selectionText=null}}))}))}}));var d,g,h,f=this.hammer=new Po.Manager(p,{recognizers:[[Po.Pan,{direction:Po.DIRECTION_ALL}]],time:150}),v=fo('<div class="pe_handler_container"></div>'),m=fo('<canvas class="pe_handler"></canvas>');v.append(m),u.before(v),u.on("mouseleave",this.mouseleave=function(e){Dt.toggle(!1)}).on("mousemove",this.hover=(d=n((function(e){var t,n;return P(this,(function(r){switch(r.label){case 0:return St.cacheMouseCoord(e),[4,S()];case 1:return t=r.sent(),!To||-1!==t&&b||-1!==(n=St.getPageIndex(e))&&St.trigger("OnHitObjectTest",St.getArgs(n,e,0,-1),0),[2]}}))})),function(e){return d.apply(this,arguments)})).on("mousedown",this.RButtionDown=function(e){if(2==e.button){var n=St.getPageIndex(e);-1!==n&&St.trigger("OnRButtonDown",St.getArgs(n,e,0,L(e)))}else 0===e.button&&t.hasSelection&&(t.canScroll=!1)}).on("mouseup",this.RButtionUp=function(e){if(2==e.button){var n=St.getPageIndex(e);-1!==n&&St.trigger("OnRButtonUp",St.getArgs(n,e,0,L(e)))}else 0===e.button&&(t.canScroll=!0)}).on("mousein",(function(e){t.hasSelection&&(t.canScroll=!1)})).on("mouseout",(function(e){t.canScroll=!0})).on("contextmenu",(function(e){return!1})),this.destroyHooks.push((function(){t.startPromise=null,u.css("z-index",0),fo(document).off("mouseup",t.cancelDown),u.off("mouseleave",t.mouseleave),u.off("mousemove",t.hover),u.off("mousedown",t.RButtionDown),u.off("mouseup",t.RButtionUp),window.removeEventListener("wheel",t.cancelWheel)})),f.add(new Po.Tap({event:"doubletap",taps:2})),f.add(new Po.Tap({event:"singletap"})),f.add(new Po.Press);var b=!1;try{var y=this;f.get("doubletap").recognizeWith("singletap"),f.get("singletap").requireFailure("doubletap"),f.on("hammer.input",(function(e){if(!xo){var t=St.getPageIndex(e);if(-1!==t)return"pointerdown"==e.srcEvent.type?(To=!1,h=Ao(),void(g=setTimeout((function(){e=e.srcEvent;var n=V(e);St.trigger(n,St.getArgs(t,e,0,L(e))).then((function(e){return h&&h.resolve(e)}))}),520))):void("pointerup"==e.srcEvent.type&&(To=!0,h&&h.promise.then((function(n){e=e.srcEvent;var r=V(e,"Up");St.trigger(r,St.getArgs(t,e,0,L(e)))}))))}})),this.triggerClick=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;y.documentMouseupFinalUpdateCount=0,clearTimeout(g),y.component&&y.component.deactive();var n=St.getPageIndex(e);if(-1!==n){h=null,e=e.srcEvent;var r=Promise.resolve();return t&&(r=St.trigger("OnHitObjectTest",St.getArgs(n,e,0,-1),0)),(r=r.then((function(t){return St.trigger(V(e),St.getArgs(n,e,0,L(e)))}))).then((function(t){return St.trigger(V(e,"Up"),St.getArgs(n,e,0,L(e)),2)}))}},this.triggerDoubleClick=function(e){t.documentMouseupFinalUpdateCount=0,clearTimeout(g),h=null,t.triggerClick(e).then((function(){setTimeout((function(){var n=St.getPageIndex(e.srcEvent);-1!==n&&St.trigger("OnLButtonDoubleClick",St.getArgs(n,e.srcEvent,0,0)).then((function(r){xo&&t.goToPage(n,Ue(e.srcEvent),Le(e.srcEvent)),t.actionFinalUpdate()}))}),100)}))},f.on("singletap",(function(e){xo&&!Oe.isIOS&&t.triggerClick(e,1).then((function(n){var r=St.getPageIndex(e);-1!==r&&t.doc.getPageEditor().getActiveObject().then((function(n){n&&t.goToPage(r,Ue(e.srcEvent),Le(e.srcEvent))}))}))})),f.on("panstart",function(){var e=n((function(e){var t;return P(this,(function(n){switch(n.label){case 0:return b=!0,clearTimeout(g),h=null,[4,S()];case 1:return-1===(t=n.sent())&&(t=St.getPageIndex(e.srcEvent)),-1===t?[2]:(xo&&St.trigger("OnHitObjectTest",St.getArgs(t,e.srcEvent,0,-1),0),St.trigger("OnLButtonDown",St.getArgs(t,{clientX:e.srcEvent.clientX-e.deltaX,clientY:e.srcEvent.clientY-e.deltaY},0,L(e))),[2])}}))}));return function(t){return e.apply(this,arguments)}}()),f.on("panmove",function(){var e=n((function(e){var t;return P(this,(function(n){switch(n.label){case 0:return e=e.srcEvent,[4,S()];case 1:return-1===(t=n.sent())&&(t=St.getPageIndex(e)),-1!==t&&St.trigger("OnMouseMove",St.getArgs(t,e,0,L(e)),1),[2]}}))}));return function(t){return e.apply(this,arguments)}}());var C=this;f.on("panend",function(){var e=n((function(e){var t,n;return P(this,(function(r){switch(r.label){case 0:return e=e.srcEvent,t=V(e,"Up"),[4,S()];case 1:return-1===(n=r.sent())&&(n=St.getPageIndex(e)),-1!==n&&St.trigger(t,St.getArgs(n,e,0,L(e)),2).then((function(t){return C.actionFinalUpdate(e)})).finally((function(e){b=!1})),[2]}}))}));return function(t){return e.apply(this,arguments)}}()),f.on("doubletap",(function(e){Oe.isIOS||t.triggerDoubleClick(e)})),f.on("press",(function(e){if(xo){var t=St.getPageIndex(e.srcEvent);-1!==t&&(clearTimeout(g),St.trigger("OnRButtonUp",St.getArgs(t,e.srcEvent,0,L(e.srcEvent))))}}))}catch(e){console.error(e)}var S=function(){var e=n((function(){var e;return P(this,(function(t){switch(t.label){case 0:return a?[4,a.getPageEditor().getActiveObject()]:[2,-1];case 1:return[2,(e=t.sent())?e.json.pageIndex:-1]}}))}));return function(){return e.apply(this,arguments)}}()}},{key:"actionFinalUpdate",value:function(e){return this.pdfViewer.eventEmitter.emit("PE-mouseMoveEnd"),Promise.resolve()}},{key:"setEditorNotifier",value:function(){var e,t=this,n=function(e,n){t.pdfViewer.getEventEmitter().emit("pageeditor-notify",e,n)},r={caretChange:function(e){n("caretChange",e)},propertyChanged:function(e){var n=e.type,r=e.fn,o=e.param,a=function(e){t.pdfViewer.getEventEmitter().emit(Co.objectPropertyChanged,{type:n,properties:e})};"SetGradientCurrentInfo"===r?a({gradientColor:o}):"SetStrokeColor"===r?a({strokeColor:o}):"SetFillColor"===r?a({fillColor:o}):"SetLineWidth"===r?a({lineWidth:o}):"SetLineStyle"===r?a({lineStyle:o}):"SetLineCap"===r?a({lineCap:o}):"SetLineJoin"===r?a({lineJoin:o}):"SetMiterLimit"===r?a({miterLimit:o}):"SetFont"===r?(o.pop(),a({font:o})):"SetFontSize"===r?a({fontSize:o}):"SetOpacity"===r?a({opacity:o}):"Shear"===r?a({shear:o}):"Center"===r?a({center:o}):"Align"===r?a({align:o}):"Distribute"===r?a({distribute:o}):"Rotate"===r?a({rotate:o}):"ChangeRenderingOrder"===r&&a({renderOrder:o})},contentChange:function(e){var n=t.pdfViewer.getPDFDocRender();if(n&&(n.doc.setDocModified(),t.pdfViewer.redraw(1,0),e)){var r=e.type,o=e.graphicsObject,a=e.pageIndex,i=e.stage;o&&o.type&&(0===r?t.pdfViewer.getEventEmitter().emit(Co.objectAdded,{pageIndex:a,graphicsObject:o}):(1===r||2===r&&"end"===i)&&t.pdfViewer.getEventEmitter().emit(Co.objectContentChanged,{pageIndex:a,graphicsObject:o}))}},toggleCaret:function(e){if(!xo||!t.disableToggleCaret)if(e)To=!1,j.startInput((function(e,t){return St.trigger("OnChar",[e]).then((function(e){var n=St.getPageIndex(t);-1!==n&&St.trigger("OnMouseMove",St.getArgs(n,t,0,0))}))})),Mo=3,Oe.isIOS&&t.tempInput&&t.tempInput.remove();else{if(Mo=0,Oe.isIOS)return;j.endInput()}},updateView:function(e){var n=e.bitmapInfo;t.displayImage(n),n.isRedraw&&(t.throttleExecutor||(t.throttleExecutor=new yo(100)),t.throttleExecutor.exec((function(e){return t.pdfViewer.redraw(1,0)})))},moveTip:function(e){var n=t.uiContainerRect,r=n.left,o=n.top,a=devicePixelRatio||1;Dt.css({left:e.x/a+15+r,top:e.y/a+20+o}),j.setPos(e.x+r-20,e.y+o+100)},setTipMsg:function(e){Dt.html(e)},showTipMsg:function(t){Dt.toggle(t),xo&&t&&(e&&clearTimeout(e),e=setTimeout((function(){Dt.toggle(!1),clearTimeout(e)}),500))},showPopupMenu:function(e){3==e.activeObject.type&&e.menu.some((function(e){if("PopupMenuItem_e_PopupMenuItemEditObject"==e.name)return e.enable=!1,!0})),n("showPopupMenu",e)},selectionChange:function(){t.doc.getPageEditor().hasSelection().then((function(e){return t.hasSelection=e})),n("selectionChange")},setClipboardText:function(e){var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),t.remove()},enterEdit:function(e){n("enterEdit",e),t.pdfViewer.redraw(1,0)},exitEdit:function(e){t.selectionText=null,n("exitEdit",e),t.pdfViewer.redraw(1,0)},processEdit:function(e){n("processEdit",e)},cursorChange:function(e){t.$handler&&(7==e?t.$handler.addClass("fv__cursor-rotation"):(t.$handler.removeClass("fv__cursor-rotation"),t.$handler.css("cursor",Mt[e]||"")))},onAddUndo:function(e){n("onAddUndo",e)},editObject:function(){t.pdfViewer.redraw(1,0)}};this.doc.getPageEditor().setNotifier(r)}},{key:"displayImage",value:function(e){var t=this.pdfViewer.getPDFDocRender();if(e&&t.matrixes){var n=e.width,r=e.height,o=e.buffer,a=e.left,i=e.top;if(o&&t){var c=fo('<div class="pe_handler_container"></div>'),l=fo('<canvas class="pe_handler"></canvas>');c.append(l);var s=t.$ui[0].getBoundingClientRect(),u=this.pdfViewer.$ui[0].parentElement;u.getBoundingClientRect();c.css({left:a-s.left+"px",top:i-s.top+"px",width:u.clientWidth+"px",height:u.clientHeight+"px"}),this.$handler&&this.$handler.css({left:a-s.left+"px",top:i-s.top+"px",width:u.clientWidth+"px",height:u.clientHeight+"px",right:"unset",bottom:"unset"});var p=l[0];if(p){p.width=n,p.height=r;var d=p.getContext("2d");d.clearRect(0,0,n,r),Fo&&d.beginPath();var g=new(Uint8ClampedArray||Uint8Array)(o),h=d.createImageData(n,r);h.data.set(g),d.putImageData(h,0,0),xo||!Mo||document.activeElement!==document.body&&document.activeElement!==j.getElement()[0]||j.getElement().focus();var f=t.$ui.find(".pe_handler_container");this.$handler&&this.$handler.before(c),f.hide().remove()}}}}},{key:"handleSystemCommand",value:function(e){var t=null,n=this.doc.getPageEditor(),r=function(e){t=n.getActiveObject().then((function(t){if(!t)return n.getEditingObject();t[e.toLowerCase()]()})).then((function(t){t&&n.createEditingObjectProxy(t)[e]()}))};if(e.ctrlKey||e.metaKey){var o=document.activeElement===j.getElement()[0];switch(e.keyCode){case 67:r("Copy");break;case 86:return o?t:n.getEditingObject().then((function(e){e?n.createEditingObjectProxy(e).Paste():n.paste()}));case 88:r("Cut");break;case 89:n.undoRedo(o,!1);break;case 90:e.shiftKey?n.undoRedo(o,!1):n.undoRedo(o,!0)}}return t}},{key:"pageHandler",value:function(e){this.pageRender=e}},{key:"destroyPageHandler",value:function(){}},{key:"destroyDocHandler",value:function(){this.docRender&&(fo(document).off("focusin",this.focusin),this.doc.endPageEdit(),Mo=0,St.destroy(),this.keyMgr.destroy(),this.hammer&&this.hammer.destroy(),this.destroyHooks.forEach((function(e){return e()})),this.resetHandler(),this.docRender.$ui.find(".pe_handler_container").remove(),Dt.hide(),this.component&&this.component.deactive(),this.docRender=null,this.destroyHooks=null,this.keyMgr=null,this.hasSelection=!1,this.$handler.get(0).style.cssText="",this.$handler=null,this.component=null)}},{key:"out",value:function(){this.destroyDocHandler(),this.destroyPageHandler()}},{key:"resetHandler",value:function(){}}],[{key:"getStateName",value:function(){return"page-editor"}},{key:"setMatrix",value:function(e,t,n){ho.startPromise&&ho.startPromise.then((function(){gt(e,t,n)}))}}]),r}(vo.IStateHandler);const Bo=jo;var No=o(395),Uo=o.n(No),Lo=C.PDFViewCtrl.shared.colorConvertor,Vo=C.PDFViewCtrl.Deps.jQuery,Ho=(C.UIConsts.COMPONENT_EVENTS,PDFViewCtrl.collab.COLLABORATION_ACTION,C.PDFViewCtrl.KeyboardUtils.isMatch),zo=C.PDFViewCtrl.KeyboardUtils.matchers,$o=zo.Enter,Ko=(zo.Escape,{0:[],1:[2,2],2:[3,3],3:[4,4],4:[4,3,2,3],5:[4,3,16,3],6:[8,4,4,4]}),Wo=Object.keys(Ko).map((function(e){return Ko[e].join()})),Go=function(e,t){Object.assign(e,{opacity:100*e.getPEObjectProp("getOpacity",0)|0,positionX:(e.getPEObjectProp("getXPosition",0)/72).toFixed(2)+" "+t,positionY:(e.getPEObjectProp("getYPosition",0)/72).toFixed(2)+" "+t,width:(e.getPEObjectProp("getWidth",0)/72).toFixed(2)+" "+t,height:(e.getPEObjectProp("getHeight",0)/72).toFixed(2)+" "+t,scaleX:"100%",scaleY:"100%",fontSize:e.getPEObjectProp("getFontSize").toFixed(2),horizonScale:e.getPEObjectProp("getHorizontalScale"),charSpace:e.getPEObjectProp("getCharSpace").toFixed(2),wordSpace:e.getPEObjectProp("getWordSpace").toFixed(2),strokeGray:e.getGrayColor("stroke"),fillGray:e.getGrayColor(),lineWidth:e.getPEObjectProp("getLineWidth"),miterLimit:e.getPEObjectProp("getMiterLimit")})},Yo={1:"GRAY",2:"RGB",3:"CMYK"},Jo=function(e,t){if(1==t&&e<=1||!t)return[e];var n=e;if(e<=1){var r=255*(1-e)|0;n=4278190080|r<<16|r<<8|r}var o=Lo(n,Yo[t]);return o.splice(0,1),o},qo=function(e){g(n,e);var t=y(n);function n(e){return i(this,n),t.call(this,e)}return l(n,[{key:"getGrayColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"fill",t=this.obj;if(!t)return 1;var n="fill"==e?"fillColor":"strokeColor";return 1==t.json[n+"Space"]?1-(255&t.json[n])/255:1}},{key:"getPEObjectProp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.obj&&this.obj[e]?this.obj[e]():t}},{key:"setPEObjectProp",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var a;if(!isNaN(t)&&!this.syncingUI&&this.obj&&this.obj[e])return(a=this.obj)[e].apply(a,m(r))}},{key:"forceSyncUI",value:function(){var e=this;return this.pdfUI.pdfViewer.currentPDFDoc.pageEditor.getActiveObject().then((function(t){return e.syncUI(t)}))}},{key:"mounted",value:function(){var e=this,t=this.pdfUI.pdfViewer;t.getEventEmitter().on("pageeditor-notify",(function(t,n){if("selectionChange"===t)e.forceSyncUI().then((function(t){t&&e.getComponentByName("general-tab").active()}))})),t.getEventEmitter().on("PE-mouseMoveEnd",(function(){e.forceSyncUI()})),t.getEventEmitter().on("graphics-updated",(function(){})),this.$width=this.getEle("width"),this.$height=this.getEle("height"),this.bindEvent(),t.currentPDFDoc&&this.forceSyncUI().then((function(t){return e.digest()})),this.watch("ctrl.positionX",(function(t,n){t.length&&!isNaN(t)&&e.setPEObjectProp("setXPosition",t,72*t)})),this.watch("ctrl.positionY",(function(t,n){t.length&&!isNaN(t)&&e.setPEObjectProp("setYPosition",t,72*t)})),this.watch("ctrl.width",this.watchCtrlWidth=function(t,n){if(t.length&&!isNaN(t)&&(e.setPEObjectProp("setWidth",t,72*t),e.$proportion&&e.$proportion.hasClass("lock"))){t=(t/e.constrain).toFixed(2);var r=e.$height,o=[t,t,{target:r[0]}];r.val(t),e.focusInput.apply(e,m(o)),e.blurInput.apply(e,m(o)),e.setPEObjectProp("setHeight",t,72*t)}}),this.watch("ctrl.height",this.watchCtrlHeight=function(t,n){if(t.length&&!isNaN(t)&&(e.setPEObjectProp("setHeight",t,72*t),e.$proportion&&e.$proportion.hasClass("lock"))){t=(e.constrain*t).toFixed(2);var r=e.$width,o=[t,t,{target:r[0]}];r.val(t),e.focusInput.apply(e,m(o)),e.blurInput.apply(e,m(o)),e.setPEObjectProp("setWidth",t,72*t)}}),this.watch("ctrl.opacity",(function(t,n){t.length&&!isNaN(t)&&(t>100&&(t=100),e.setPEObjectProp("setOpacity",t,t/100))})),[["ctrl.fontSize","setFontSize"],["ctrl.horizonScale","setHorizontalScale"],["ctrl.charSpace","setCharSpace"],["ctrl.wordSpace","setWordSpace"],["ctrl.lineWidth","setLineWidth"],["ctrl.miterLimit","setMiterLimit"]].forEach((function(t){var n=v(t,2),r=n[0],o=n[1];e.watch(r,(function(t,n){e.setPEObjectProp(o,t,+t)}))}))}},{key:"blurInput",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[2].target,o=t[0];r.type="","%"==r.postfix?(t[0]="100",this.setPEObjectProp("scale",1,o/100-1,"horizon"==r.dataset.dir)):t[0]=(+t[0]).toFixed(2),r.value=t[0]+r.postfix}},{key:"fontSizeBlur",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[2].target,o=t[0];r.value=Number(o).toFixed(2)}},{key:"focusInput",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=parseFloat(t[0]),o=t[2].target;o.type="number",o.value=r,o.postfix=t[0].replace(""+r,""),"%"!==o.postfix&&(o.postfix=this.pdfUI.i18n.t("sidebar.layers.importDialog.inches"))}},{key:"getEle",value:function(e,t){var n=this.component.getComponentByName(e);return t?n:Vo(n.element)}},{key:"bindEvent",value:function(){var e=this;Vo(this.component.element).find(".rangeLimit").on("keyup",(function(e){var t=Vo(e.target),n=t.val().split(".");n[1]&&n[1].length>2&&t.val(n[0]+"."+n[1].substring(0,2))})),Vo(this.component.element).find('[name="opacity"] input').on("keyup",(function(e){+e.target.value>=100&&(e.target.value="100")})),this.getEle("PE-fontName").on("change",(function(t){e.obj.setFont(t.target.value,e.obj.getFontIsBold(),e.obj.getFontIsItalic(),0).then((function(t){return e.forceSyncUI()}))})),this.getEle("PE-textMode").on("change",(function(t){e.obj.setTextMode({type:"TextMode",value:+t.target.value}).then((function(t){return e.forceSyncUI()}))})),[["PE-textStrokeColor","strokeColor"],["PE-textFillColor","fillColor"],["PE-pathStrokeColor","strokeColor"],["PE-pathFillColor","fillColor"]].forEach((function(t){var n=v(t,2),r=n[0],o=n[1];e.getEle(r).find("select").on("change",(function(t){var n=e.obj,r=+t.target.value,a=o+"Space",i=n.json[o];n.setColorSpace(a,r),n["set"+o[0].toUpperCase()+o.substring(1)](Jo(i,r),!0,i,r).then((function(t){return e.forceSyncUI()}))}))})),this.getEle("PE-lineCap").on("change",(function(t){e.obj.setLineCap(+t.target.value)})),this.getEle("PE-lineJoin").on("change",(function(t){e.obj.setLineJoin(+t.target.value)})),this.component.getComponentByName("PE-lineStyle").on("change",(function(t){e.obj.setLineStyle(Ko[t]).then((function(t){return e.forceSyncUI()}))})),Array.from(["PE-fontSize","PE-horizonScale","PE-charSpace","PE-wordSpace","PE-opacity"]).forEach((function(t){var n=e.component.getComponentByName(t);Vo(n.element).on("input",(function(r){if(!/^-?\d*(\.\d+)?$/.test(r.target.value)||!r.target.value){var o=e.obj.json[t.replace("PE-","")];"PE-opacity"===t&&(o=100*Number(o)),n.setValue(o)}}))})),this.component.querySelectorAll("@slider").forEach((function(t){switch(t.attrs["@model"]){case"ctrl.opacity":t.on("change",(function(t,n,r,o){o.isMoving||e.setPEObjectProp("setOpacity",r,r/100)}));break;case"ctrl.fillGray":t.on("change",(function(t,n,r,o){if(!o.isMoving){var a=e.obj,i=Lo(["G",1-r],"int");a.setFillColor(Jo(1-r,!0,a.json.fillColorSpace),!0,i,!0).then((function(t){return e.forceSyncUI()}))}}));break;case"ctrl.strokeGray":t.on("change",(function(t,n,r,o){if(!o.isMoving){var a=e.obj,i=Lo(["G",1-r],"int");a.setStrokeColor(Jo(1-r,!0,a.json.strokeColorSpace),!0,i,!0).then((function(t){return e.forceSyncUI()}))}}))}})),this.pdfUI.addViewerEventListener("languageChangeFinished",(function(t){Go(e,e.pdfUI.i18n.t("sidebar.layers.importDialog.inches")),e.digest()}));var t=this.$proportion,n=this.getEle("width"),r=this.getEle("height");t&&t.on("click",(function(){if(t.hasClass("lock"))t.removeClass("lock"),t.addClass("unlock");else{t.removeClass("unlock"),t.addClass("lock");var o=parseFloat(n.val()),a=parseFloat(r.val());e.constrain=o/a}}))}},{key:"keyBoardHandler",value:function(e,t){Ho(e,$o)&&this.showCP(t)}},{key:"showCP",value:function(e){var t=this,n=this.getEle(e).find(".color-picker"),r=n.attr("disabled");if(!r||!r.length){var o=this.obj,a=-1!=e.indexOf("StrokeColor"),i=-1!=e.indexOf("path"),c=a?o.getStrokeColor():o.getFillColor(),l=a?"setStrokeColor":"setFillColor",s=a?"strokeColorSpace":"fillColorSpace",u=o.json[s];if(2==u||3==u){var p=this.pdfUI.colorSpectrum;i&&p.showTransparent(!0),p.setDefaultColor(Lo(c,"#")),p.show(n,(function(e){if(0===e)return o.setColorSpace(s,0),void o[l]([0],!0,4278190080,!1).then((function(e){return t.forceSyncUI()}));var n=Lo(e,"int");o[l](Jo(n,u),!0,n).then((function(e){return t.forceSyncUI()}))}))}}}},{key:"isCmpDisabled",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"PE-textStrokeColor",t=this.obj;if(1==t.getType()){var n=t.getTextMode();return"PE-textStrokeColor"==e?1!=n&&2!=n:0!=n&&2!=n}return!1}},{key:"syncUI",value:function(e){var t=this;if(!e)return this.obj=e,this.component.disable(),!0;this.constrain=e.json.width/e.json.height,this.component.enable(),this.syncingUI=!0;var n=!this.obj||e.getType()!==this.obj.getType();this.obj=e,Go(this,this.pdfUI.i18n.t("sidebar.layers.importDialog.inches"));var r,o="disabled",a=function(n){var r=t.getEle(n),a=r.find(".color-picker .color");a.css("background-color","#000");var i=t.getEle(n,!0).querySelector("@slider");if(t.isCmpDisabled(n))r.find("select,.color-picker").attr(o,o),r.find("select").val(1),i.show(),i.lock();else{r.find("select,.color-picker").removeAttr(o),i.unlock();var c=-1!==n.indexOf("StrokeColor")?"strokeColor":"fillColor",l=n.indexOf("path"),s=e.json[c+"Space"];r.find("select").val(s);var u=l&&!s?"#fff":Lo(e.json[c],"#");a.css("background-color",u),1!==s?(a.removeAttr(o),i.hide()):(a.attr(o),i.setValue(t.getGrayColor(c.replace("Color",""))),i.show())}},i="page-editor:";switch(e.getType()){case 1:var c=e.getFontName(),l=this.getEle("PE-fontName");l.find(".external").remove(),l.append("<option class='external'>".concat(c,"</option>")),l.val(c),this.getEle("PE-textMode").val(e.getTextMode()),["PE-textStrokeColor","PE-textFillColor"].forEach((function(e){a(e)})),i+="TextProps";break;case 2:i+="PathProps";var s=e.getLineCap(),u=e.getLineJoin();this.getEle("PE-lineJoin").val(u),this.getEle("PE-lineCap").val(s),["PE-pathStrokeColor","PE-pathFillColor"].forEach((function(e){a(e)}));var p=0==(r=e.getLineStyle()).length?0:Wo.indexOf(r.join()),d=this.component.getComponentByName("PE-lineStyle");d&&d.setValue(p);break;case 3:i+="ImageProps";break;case 4:i+="ShadingProps";break;case 5:i+="MixedProps"}return Vo(this.component.element).find(".fv__ui-layer-header-title").text(this.pdfUI.i18n.t(i)).attr("data-i18n",i),this.component.hasFocus()?(this.syncingUI=!1,!1):(this.digest(),this.syncingUI=!1,n)}},{key:"getActiveType",value:function(){return this.obj?this.obj.getType():0}},{key:"hideDialog",value:function(){this.component.hide()}}],[{key:"getName",value:function(){return"PropsDialogController"}}]),n}(C.Controller),Xo=o(442),Qo=o.n(Xo),Zo=C.PDFViewCtrl.Events,ea=C.PDFViewCtrl.Consts.PDFDocPermission,ta=C.vendors.jQuery,na=(C.PDFViewCtrl.shared.Store,{"home-tab":"home-toolbar-group-list","edit-tab":"edit-toolbar-group-list"}),ra={"home-tab":"edit-object-ribbon-dropdown","edit-tab":"fv--plugin-PageEditor-edit"},oa=function(e){g(r,e);var t=y(r);function r(){return i(this,r),t.apply(this,arguments)}return l(r,[{key:"mounted",value:function(){var e=this;p(u(r.prototype),"mounted",this).call(this),this.eventsHandler(),this.pdfUI.getStore().then((function(t){e.store=t})),this.addDestroyHook(this.getPDFUI().addViewerEventListener(Zo.toolbarTabsClicked,(function(t){t&&["edit-tab","home-tab"].includes(t.name)&&(e.changeBtnStatus(t.name),e.currentTabName=t.name)})))}},{key:"changeBtnStatus",value:function(e){var t=this;return n((function(){var n,r,o,a,i,c,l,s,u;return P(this,(function(p){switch(p.label){case 0:return n=t.getPDFUI().pdfViewer.getStateHandlerManager().currentStateHandler.getStateName(),(r=t.getPDFUI()).activeMainPageTab?(o=e||r.activeMainPageTab.name,(a=ra[o])?(i=na[o],[4,r.getComponentByName(i)]):[2]):[2];case 1:return[4,p.sent().getComponentByName(a)];case 2:return(c=p.sent())&&(t.component=c),[4,r.getCurrentPDFDoc()];case 3:return(l=p.sent())?(s=l.getPageEditor(),(u=Number(s.filter))===ge.None||n!==Bo.getStateName()?(t.component.deactive(),"function"==typeof t.component.getDropdown&&t.component.getDropdown().children().find((function(e){return e.deactive()})),t.removeAllActive()):(t.component.active(),t.setEditType(ge[""+u],e)),[2]):[2]}}))}))()}},{key:"eventsHandler",value:function(){var e,t=this,n=this.getPDFUI();e=function(e){var n,r=t.store.getCurrentValue(Pe);if(e.getStateName()===Bo.getStateName()&&r==be)t.component.active(),"function"==typeof t.component.getDropdown&&(null===(n=t.component.getDropdown())||void 0===n||n.children()[0].active());else if(t.component.deactive(),"function"==typeof t.component.getDropdown){var o,a=null===(o=t.component.getDropdown())||void 0===o?void 0:o.children();null==a||a.find((function(e){return e.deactive()}))}},this.addDestroyHook(n.addViewerEventListener(Zo.beforeSwitchStateHandler,e))}},{key:"removeAllActive",value:function(){ta(this.component.element).find(".fv__ui-dropdown-list li").removeClass("active"),ta(this.component.element).find(".fv__ui-dropdown-list i.fv__ui-property-icon-selected-color-light").removeClass("fv__ui-property-icon-selected-color-light")}},{key:"updateItemFromDropdown",value:function(){var e=this;setTimeout(n((function(){var t,n,r,o,a,i;return P(this,(function(c){switch(c.label){case 0:return[4,e.getPDFUI().getCurrentPDFDoc()];case 1:return t=c.sent(),n=t.getPageEditor(),r=Number(n.filter),o=ge[""+r],a="home-tab"===e.currentTabName?o:"fv--plugin-PageEditor-edit-".concat(o.toLowerCase()),"home-tab"!==e.currentTabName&&e.removeAllActive(),i=ta(e.component.element).find('li[name="'.concat(a,'"]')),ta(e.component.element).find(".fv__ui-dropdown-list li").removeClass("active"),i.addClass("active").find("i").addClass("fv__ui-property-icon-selected-color-light"),[2]}}))})))}},{key:"setEditType",value:function(e,t){var n=this,r=this.getPDFUI();r.getCurrentPDFDoc().then((function(o){o&&r.getStateHandlerManager().then((function(r){n.store.dispatch(Pe,be),r.switchTo(Bo.getStateName()),o.getPageEditor().setObjectFilter(re[e]),n.updateItem(e,t)}))}))}},{key:"updateItem",value:function(e,t){var r=this;return n((function(){var t,n;return P(this,(function(o){switch(o.label){case 0:return(t=r.component.getComponentByName(e))?(ta(t.element).addClass("active").siblings().removeClass("active"),[3,3]):[2];case 1:return[3,3];case 2:n=o.sent(),ta(n.element).addClass("active").siblings().removeClass("active").find("i").removeClass("fv__ui-property-icon-selected-color-light"),ta(n.element).find("i").addClass("fv__ui-property-icon-selected-color-light"),o.label=3;case 3:return[2]}}))}))()}},{key:"handle",value:function(){if("dropdown"===this.component.parent.nodeName)return p(u(r.prototype),"handle",this).call(this);this.setEditType(this.component.getAttribute("edit-type"))}}],[{key:"getName",value:function(){return"EditObjectController"}},{key:"permission",get:function(){return ea.ModifyDocument}}]),r}(C.Controller),aa=C.PDFViewCtrl.Events,ia=C.PDFViewCtrl.Consts.PDFDocPermission,ca=function(e){g(r,e);var t=y(r);function r(){return i(this,r),t.apply(this,arguments)}return l(r,[{key:"mounted",value:function(){var e=this;p(u(r.prototype),"mounted",this).call(this),this.eventsHandler(),this.pdfUI.getStore().then((function(t){e.store=t}))}},{key:"eventsHandler",value:function(){var e=this,t=this.getPDFUI();this.addDestroyHook(t.addViewerEventListener(aa.beforeSwitchStateHandler,(function(t,n){var r=e.store.getCurrentValue(Pe);t.getStateName()===ut.getStateName()&&r==ye?e.component.active():e.component.deactive()})))}},{key:"handle",value:function(){var e=this,t=this.getPDFUI();t.getCurrentPDFDoc().then((function(n){if(n)return t.getStateHandlerManager().then((function(n){e.store.dispatch(Pe,ye);var r=ut.getType();n.switchTo("touch-up-editor"),"touchup"!==r&&"touch-up-editor"===n.currentStateHandler.getStateName()&&e.openRightTextEditPanel(t,0),go(!0),n.getCurrentStates().activateType(t,n.pdfViewer,"touchup",!0)}))}))}},{key:"openRightTextEditPanel",value:function(e,t){return n((function(){var n,r,o;return P(this,(function(a){switch(a.label){case 0:return[4,e.getComponentByName("sidebar-right")];case 1:return(n=a.sent())?(n.show(),[4,e.getComponentByName("sidebar-right-tabs")]):[2];case 2:return(r=a.sent())?(r.openTab("edit-properties-panel"),r.setActivetab("edit-properties-panel"),[4,e.getComponentByName("edit-properties")]):[2];case 3:return o=a.sent(),!t&&o&&(o.setHost({},G.TouchUp),o.disable()),[2]}}))}))()}}],[{key:"getName",value:function(){return"AddTextController"}},{key:"permission",get:function(){return ia.ModifyDocument}}]),r}(C.Controller),la=(C.PDFViewCtrl.Events,C.PDFViewCtrl.Consts.PDFDocPermission),sa=function(e){g(n,e);var t=y(n);function n(){return i(this,n),t.apply(this,arguments)}return l(n,[{key:"mounted",value:function(){var e=this;p(u(n.prototype),"mounted",this).call(this),this.pdfUI.getStore().then((function(t){e.store=t}))}},{key:"handle",value:function(e){var t=this,n=this.getPDFUI(),r=new FileReader;r.readAsArrayBuffer(e),r.onload=function(e){try{n.getCurrentPDFDoc().then((function(r){r&&n.getStateHandlerManager().then((function(o){t.store.dispatch(Pe,be),o.switchTo(Bo.getStateName()),setTimeout((function(){return r.getPageEditor().createImage(e.target.result).then((function(e){e||n.alert({message:"page-editor:alert.createImageFailed",level:"warning"})}))}),0)}))}))}catch(e){n.alert({message:"page-editor:alert.createImageFailed",level:"warning"})}}}}],[{key:"getName",value:function(){return"AddImageAdvController"}},{key:"permission",get:function(){return la.ModifyDocument}}]),n}(C.Controller),ua=o(848),pa=o.n(ua),da=(C.PDFViewCtrl.Events,C.PDFViewCtrl.Consts.PDFDocPermission),ga=(C.vendors.jQuery,function(e){g(n,e);var t=y(n);function n(){return i(this,n),t.apply(this,arguments)}return l(n,[{key:"mounted",value:function(){var e=this;p(u(n.prototype),"mounted",this).call(this),this.pdfUI.getStore().then((function(t){e.store=t}))}},{key:"addPath",value:function(e){var t=this,n=this.getPDFUI();n.getCurrentPDFDoc().then((function(r){r&&n.getStateHandlerManager().then((function(n){t.store.dispatch(Pe,be),n.switchTo(Bo.getStateName()),r.getPageEditor().createPath(ne[e]),t.updateUI("path-".concat(e))}))}))}},{key:"addShading",value:function(e){var t=this,n=this.getPDFUI();n.getCurrentPDFDoc().then((function(r){r&&n.getStateHandlerManager().then((function(n){t.store.dispatch(Pe,be),n.switchTo(Bo.getStateName()),r.getPageEditor().createShading(ne[e]),t.updateUI("shading-".concat(e))}))}))}},{key:"updateUI",value:function(e){var t=this,n=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active",r=e.split("-"),o=t.component.getComponentByName(r[0]).getComponentByName(r[1]);o&&o[n]&&o[n]()};this.activeType&&n(this.activeType,"deactive"),n(e),this.activeType=e}}],[{key:"getName",value:function(){return"AddShapesController"}},{key:"permission",get:function(){return da.ModifyDocument}}]),n}(C.Controller));const ha={annotationUpdated:"annotation-updated",annotationIDUpdated:"annotation-id-updated",annotationAppearanceUpdated:"annotation-appearance-updated",annotationReplyAdd:"annotation-reply-add",annotationReplyAdded:"annotation-reply-add",annotationReviewStateAnnotAdd:"annotation-review-state-annot-add",annotationReviewStateAnnotAdded:"annotation-review-state-annot-add",annotationMarkedStateAnnotAdd:"annotation-marked-state-annot-add",annotationMarkedStateAnnotAdded:"annotation-marked-state-annot-add",annotationStatesCleared:"annotation-states-cleared",annotationRemoved:"annotation-removed",annotationMovedPosition:"annotation-moved-position",annotationPositionMoved:"annotation-moved-position",annotationOrderChanged:"annotation-order-changed",annotationAdded:"annotation-add",annotationAdd:"annotation-add",moveAnnotsToPages:"moveAnnotsToPages",annotationImported:"annotation-imported",annotationImportedEx:"annotation-imported-ex",annotationLoaded:"annotation-loaded",actionUpdated:"action-updated",actionAdd:"action-add",actionAdded:"action-add",actionRemove:"action-remove",actionRemoved:"action-remove",layerVisibleChange:"layer-visible-change",layerVisibleChanged:"layer-visible-change",layerRemoved:"layer-removed",layerMerged:"layer-merged",layerAdded:"layer-added",bookmarkAdded:"bookmark-added",structureBookmarkAdded:"structure-bookmark-added",bookmarkUpdated:"bookmark-updated",bookmarkRemoved:"bookmark-removed",stateAnnotNameUpdated:"state-annot-name-updated",pageInfoChange:"page-info-change",pageInfoChanged:"page-info-change",pageRotationChange:"page-rotation-change",beforePageRotationChanged:"before-page-rotation-changed",pageRotationChanged:"page-rotation-change",imageAdded:"image-added",watermarkAdded:"watermark-added",watermarkRemoved:"watermark-removed",graphicsUpdated:"graphics-updated",permissionChanged:"permission-changed",docPasswordChanged:"doc-password-changed",drmEncryptSuccess:"drm-encrypt-success",drmEncryptSucceeded:"drm-encrypt-success",drmEncryptFailed:"drm-encrypt-failed",removePwdAndPerm:"remove-password-and-permission",pwdAndPermRemoved:"remove-password-and-permission",securityTypeChanged:"security-type-changed",pageMoved:"page-moved",pageRemoved:"page-removed",pageAdded:"page-added",insertPages:"import-pages",pagesInserted:"import-pages",importPages:"import-pages",documentAttachmentAdd:"document-attachment-add",docAttachmentAdded:"document-attachment-add",documentAttachmentModify:"document-attachment-modify",docAttachmentModified:"document-attachment-modify",documentAttachmentRemove:"document-attachment-remove",docAttachmentRemoved:"document-attachment-remove",applyRedaction:"apply-redaction",redactionApplied:"apply-redaction",removeReviewState:"remove-review-state",reviewStateRemoved:"remove-review-state",removeMarkedState:"remove-marked-state",markedStateRemoved:"remove-marked-state",formValueChanged:"form-value-changed",metaDataChanged:"meta-data-changed",docModified:"doc-modified",flattened:"flattened",headerFooterUpdated:"headerFooterUpdated",headerFooterAdded:"headerFooterAdded",COChange:"COChange",COChanged:"COChange",pagesReversed:"pages-reversed",pagesMoved:"pages-moved",pagesRemoved:"pages-removed",pagesRotated:"pages-rotated",pageMeasureScaleRatioChanged:" page-measure-scale-ratio-changed",obtainsPageFromEngine:"obtains-page-from-engine",pagesBoxChange:"pages-box-changed",pagesBoxChanged:"pages-box-changed",pagesLabelChange:"pages-label-change",pagesLabelChanged:"pages-label-change",pagesLabelNeedUpdate:"pages-label-need-change",pagesLabelNeedUpdated:"pages-label-need-change",pagesReplace:"pages-replace",pagesReplaced:"pages-replace",recognitionForm:"recognition-form",removeEmbeddedPageThumbnail:"remove-embedded-page-thumbnail",embeddedPageThumbnailRemoved:"remove-embedded-page-thumbnail",objectStartEdit:"object-start-edit",objectEndEdit:"object-end-edit",objectSelectionChanged:"object-selection-changed",objectAdded:"object-added",objectPropertyChanged:"object-property-changed",objectContentChanged:"object-content-changed",paragraphContentChanged:"paragraph-text-changed",paragraphTextOnActivate:"paragraph-text-on-activate",paragraphTextOnDeactivate:"paragraph-text-on-deactivate",paragraphTextEnterEdit:"paragraph-text-enter-edit",paragraphTextExitEdit:"paragraph-text-exit-edit",paragraphTextOnChar:"paragraph-text-on-char",findSuccess:"find-success",replaceSuccess:"replace-success",replaceAllSuccess:"replace-all-success",articleThreadAdded:"article-thread-added",articleThreadUpdated:"article-thread-updated",articleThreadRemoved:"article-thread-removed",articleBeadAdded:"article-bead-added",articleBeadRemoved:"article-bead-removed",articleBeadUpdated:"article-bead-updated",articleEnterReadMode:"article-enter-read-mode",articleOutReadMode:"article-out-read-mode",invalidRect:"invalidRect",xfaContentChanged:"xfa-content-changed",formReloaded:"formReloaded",formFieldImported:"form-field-imported"};const fa=Object.assign({jrLicenseSuccess:"jr-license-success",srLicenseSuccess:"sr-license-success",beforeOpenFile:"before-open-file",openingFile:"opening-file",beforeLoadPDFDoc:"before-load-pdf-document",openFileSuccess:"open-file-success",openFileFailed:"open-file-failed",willCloseDocument:"will-close-document",renderFileSuccess:"render-file-success",renderFileFailed:"render-file-error",beforeRenderPage:"before-render-page",renderPageSuccess:"render-page-success",updateZoomMode:"update-zoom-mode",beforeZoomTo:"before-zoom-to",zoomToSuccess:"zoom-to-success",zoomToFailed:"zoom-to-failed",startChangeViewMode:"start-change-view-mode",changeViewModeSuccess:"change-view-mode-success",toggleFullScreen:"toggle-full-screen",changeViewModeFailed:"change-view-mode-failed",pagesLayoutRedrawBegin:"pages-layout-redraw-begin",pageLayoutRedraw:"page-layout-redraw",pagesLayoutRedrawEnd:"pages-layout-redraw-end",copyTextSuccess:"copy-text-success",copyTextFailed:"copy-text-failed",tapPage:"tap-page",tapAnnotation:"tap-annotation",pressPage:"press-page",pressAnnotation:"press-annotation",pressText:"press-text",rightClickPage:"right-click-page",rightClickAnnotation:"right-click-annotation",doubleTapPage:"double-tap-page",doubleTapAnnotation:"double-tap-annotation",activeAnnotationBefore:"active-annotation-before",activeAnnotation:"active-annotation",activeAnnotationAfter:"active-annotation-after",panActiveAnnotation:"pan-active-annotation",doubleTapActiveAnnotation:"double-tap-active-annotation",contextMenuActiveAnnotation:"contextmenu-action-annotation",activeMultipleAnnotations:"active-multiple-annotations",unActiveAnnotation:"unactive-annotation",updateActiveAnnotation:"update-action-annotation",updateActionAnnotation:"update-action-annotation",removeActiveAnnotationBefore:"remove-action-annotation-before",removeActionAnnotationBefore:"remove-action-annotation-before",removeActiveAnnotationSuccess:"remove-action-annotation-success",removeActionAnnotationSuccess:"remove-action-annotation-success",removeActiveAnnotationFailed:"remove-action-annotation-failed",removeActionAnnotationFailed:"remove-action-annotation-failed",beforeSwitchStateHandler:"before-switch-state-handler",switchStateHandler:"switch-state-handler",deactiveStateHandler:"deactive-state-handler",redactAnnotAllApplyed:"applyed-all-redaction",redactAnnotApplyed:"applyed-redaction",pageNumberChange:"page-number-change",beforeDocumentRotation:"before-document-rotation",afterDocumentRotation:"after-document-rotation",snapModeChanged:"snap-mode-changed",createPageAreaRenderer:"create-page-area-renderer",destroyPageAreaRenderer:"destroy-page-area-renderer",startUpdatePageAreaRenderer:"start-update-page-area-renderer",createSnapshotArea:"create-snapshot-area",updateSnapshotArea:"update-snapshot-area",stabilizedSnapshotArea:"stabilized-snapshot-area",switchPageAreaRenderer:"switch-page-area-renderer",fitWidthResizeViewport:"fit-width-resize-viewport",signatureFieldMouseLButtonDown:"signature-field-Lbutton-down",signatureFieldMouseLButtonUp:"signature-field-LButton-up",signatureFieldMouseEnter:"signature-field-mouse-enter",signatureFieldMouseExit:"signature-field-mouse-exit",visiblePagesRenderCompleted:"completed-render-visible-pages",marqueeZoomIn:"marquee-zoom-in",marqueeZoomOut:"marquee-zoom-out",inkSignAdded:"inkSign-added",inkSignDeleted:"inkSign-deleted",onlineSignAdded:"onlineSign-added",onlineSignDeleted:"onlineSign-deleted",changeReadSpeed:"changeReadSpeed",changeReadVolume:"changeReadVolume",pageMoved:"page-moved",pageRemoved:"page-removed",pageAdded:"page-added",customDataAdd:"custom-data-add",customDataImported:"custom-data-imported",customDataRemoved:"custom-data-removed",customDataUpdated:"custom-data-updated",distanceAnnotCreationStart:"distance-creation-start",perimeterAnnotCreationStart:"perimeter-creation-start",updateDistanceAnnot:"update-distance-annot",distanceAnnotCreationEnd:"distance-creation-end",distanceAnnotCreationCancel:"distance-creation-cancel",drawingAnnotCreationStart:"drawing-creation-start",drawingAnnotCreationEnd:"drawing-creation-end",drawingAnnotCreationCancel:"drawing-creation-cancel",addEditImage:"add-edit-image",InkImageSelected:"ink-image-selected",OnlineImageSelected:"online-image-selected",checkTheSearch:"check-the-search",activeElementChanged:"active-element-changed",cancelCreatingDistance:"cancel-creating-measurement",completeCreatingDistance:"complete-creating-measurement",eraserSuccess:"eraser-success",addAnnotSuccess:"add-annot-success",cancelAddAnnot:"cancel-add-annot",globalAnnotFlagChanged:"global-annot-flag-changed",toolbarTabsClicked:"toolbar-tabs-clicked",sideBarChanged:"sidebar-changed",showWhatsNew:"show-whats-new",disableScroll:"disable-scroll",enableScroll:"enable-scroll",updateScrollableStatus:"update-scrollable-status",selectText:"select-text",changeEnableJS:"change-enable-js",toggleEngineSr2JrSuccess:"toggle-engine-sr-to-jr-success",iconInited:"iconInited",iconAdded:"iconAdded",iconRemoved:"iconRemoved",annotationPermissionChanged:"annotation-premission-changed",startScrollingPage:"pdfui-start-scrolling-page",scrollingPage:"pdfui-scrolling-page",endScrollingPage:"pdfui-end-scrolling-page",designerAssistantStatusChanged:"form-designer-assistant-status-changed",mouseEnter:"mouse-enter",mouseLeave:"mouse-leave",setFromFieldHighlight:"set_form_field_highlight",AddFontMaps:"set_font_map",thumbnailClicked:"thumbnail-clicked",layerActionActived:"layer-action-actived",redeModeShowSidebar:"rede-mode-show-sidebar",gridToggle:"grid-toggle",snapGridToggle:"snap-grid-toggle",toggleCollaborationMode:"toggleCollaborationMode",findReplaceDialogVisibleChange:"find-replace-dialog-visible-change",showAllComments:"show-all-comments",hideAllComments:"hide-all-comments",focusOnControl:"focus-on-control",blurFromObject:"blur-from-object",documentWillPrint:"document-will-print",documentDidPrint:"document-did-print",documentWillSave:"document-will-save",documentDidSave:"document-did-save",verifyDocSignatureEvent:"verify-doc-signature",verifySignatureEvent:"verify-signature",clearSignatureEvent:"clear-signature",viewSignedVersionDocEvent:"view-signed-version",showFieldPropertiesEvent:"show-field-properties",showSignatureVerifyInfoEvent:"show-signature-tusted-info",compareSignedVersionEvent:"compare-signed-version",showCompareSignedVersionResultEvent:"show-compare-signed-version-result",eSignCnShowAuthPromote:"eSignCnShowAuthPromote",eSignCnShowMultiPageStamp:"eSignCnShowMultiPageStamp",eSignCNAddDateStamp:"eSignCNAddDateStamp",eSignCNCloseStamp:"eSignCNCloseStamp",eSignCNChangePagingSeal:"eSignCNChangePagingSeal",eSignCNOpenProcessSeal:"eSignCNOpenProcessSeal",eSignCnApply:"eSignCnApply",eSignCNShowOfflineResult:"eSignCNShowOfflineResult",eSignCnExit:"eSignCnExit",tapField:"tap-field",tapGraphicsObject:"tap-graphics-object",spawnPageSuccess:" spawn-page-success",progressChanged:"progress-changed",togglePageContextMenu:"toggle-page-contextmenu",beforeRenderingVisiblePages:"before-rerendering-visible-pages",afterRenderingVisiblePages:"after-rerendering-visible-pages"},ha);var va,ma,ba,ya,Pa,Ca,Sa=function(){function e(t,n){i(this,e),s(this,"internalGraphicObject",void 0),s(this,"pdfViewer",void 0),this.internalGraphicObject=t,this.pdfViewer=n}return l(e,[{key:"setProperties",value:function(e){var t=this;return n((function(){var n,o,a,i,c,l,s,u;return P(this,(function(p){switch(p.label){case 0:if(!(n=t.pdfViewer.getCurrentPDFDoc()))throw new Error("Unable to apply property modifications. The document is either not open or has been closed. Please ensure the document is open and accessible for editing.");if("page-editor"!==t.pdfViewer.getStateHandlerManager().currentStateHandler.getStateName())throw new Error("Unable to apply property modifications. Current state handler is not page-editor!");for(c in o=n.getPageEditor(),a=t.resolvePropertiesKeyName(e),i=[],a)i.push(c);l=0,p.label=1;case 1:if(!(l<i.length))return[3,4];if(s=i[l],u=a[s],"shading-style-color"===s&&!r(u,Array))throw new Error("The value of the shading style color shoud be an array!");return[4,Tr(t.internalGraphicObject,o,s,u,t.pdfViewer.viewerUI.rootComponent,!0)];case 2:p.sent(),p.label=3;case 3:return l++,[3,1];case 4:return[2]}}))}))()}},{key:"resolvePropertiesKeyName",value:function(e){var t={};for(var n in["arrangeAlignment","arrangePagecenter","arrangeAlignment","arrangeDistribute","arrangeRotate","arrangeFlip","arrangeZorder"].forEach((function(n){if(n in e){var r=e[n],o=n.replace(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()}))+"-"+r;t[o]=!0,delete e[n]}})),e){var r=n.replace(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()}));t[r]=e[n]}return t}}]),e}(),Ea=function(e){g(n,e);var t=y(n);function n(){return i(this,n),t.apply(this,arguments)}return l(n,[{key:"type",get:function(){return ge[ge.Text]}}]),n}(Sa),wa=function(e){g(n,e);var t=y(n);function n(){return i(this,n),t.apply(this,arguments)}return l(n,[{key:"type",get:function(){return ge[ge.Path]}},{key:"resolvePropertiesKeyName",value:function(e){var t=p(u(n.prototype),"resolvePropertiesKeyName",this).call(this,e),r=e.shapeBorderColor,o=e.shapeBackgroundColor;return(r||o)&&(t["shape-style-color"]={borderColor:r,backgroundColor:o}),delete t["shape-border-color"],delete t["shape-background-color"],t}}]),n}(Sa),xa=(function(e){g(n,e);var t=y(n);function n(){return i(this,n),t.apply(this,arguments)}l(n,[{key:"type",get:function(){return ge[ge.Image]}}])}(Sa),function(e){g(n,e);var t=y(n);function n(){return i(this,n),t.apply(this,arguments)}return l(n,[{key:"type",get:function(){return ge[ge.Shading]}}]),n}(Sa)),ka=function(e){g(n,e);var t=y(n);function n(){return i(this,n),t.apply(this,arguments)}return l(n,[{key:"type",get:function(){return ge[ge.All]}}]),n}(Sa);function Ia(e){return function(t){if(t)return"number"===e.element.getAttribute("type")?t.replace(/\D+$/,""):t}}!function(e){e.VERTICALLY="vertically",e.HORIZONTALLY="horizontally",e.BOTH="both"}(va||(va={})),function(e){e.VERTICALLY="vertically",e.HORIZONTALLY="horizontally",e.LEFT="left",e.RIGHT="right",e.TOP="top",e.BOTTOM="bottom"}(ma||(ma={})),function(e){e.VERTICALLY="vertically",e.HORIZONTALLY="horizontally"}(ba||(ba={})),function(e){e.CLOCKWISE="clockwise",e.COUNTERCLOCKWISE="counter-clockwise"}(ya||(ya={})),function(e){e.VERTICALLY="vertically",e.HORIZONTALLY="horizontally"}(Pa||(Pa={})),function(e){e.TO_BACK="to-back",e.TO_FRONT="to-front"}(Ca||(Ca={}));var Aa,_a,Ta=C.PDFViewCtrl,Ma=Ta.ViewerEvents,Oa=C.vendors.jQuery,Ra=C.UIConsts.COMPONENT_EVENTS,Da=function(e){g(r,e);var t=y(r);function r(){return i(this,r),t.apply(this,arguments)}return l(r,[{key:"changePermission",value:function(e){var t=this;this.getPDFUI().getPDFDocRender().then((function(e){e.getUserPermission().getValue()&t.constructor.permission?t.component.unlock&&t.component.unlock():t.component.lock&&t.component.lock()}))}},{key:"stateIn",value:function(){var e=this.component.parent;e.is("dropdown")&&e.selectable&&(e.select(this.component),e.separate&&e.iconElement.setAttribute("aria-pressed","true"),e.addCSSClass("selected"))}},{key:"stateOut",value:function(){var e=this.component.parent;e.is("dropdown")&&e.selectable&&(e.separate&&e.iconElement.setAttribute("aria-pressed","false"),e.removeCSSClass("selected"))}},{key:"changeBtnState",value:function(){"touch-up-editor"===this.getPDFUI().pdfViewer.getStateHandlerManager().currentStateHandler.getStateName()?(this.component.active(),this.stateIn()):(this.component.deactive(),this.stateOut())}},{key:"mounted",value:function(){var e=this;p(u(r.prototype),"mounted",this).call(this),this.changeBtnState(),this.addDestroyHook(this.getPDFUI().addViewerEventListener(fa.toolbarTabsClicked,(function(t){t&&["edit-tab","home-tab"].includes(t.name)&&e.changeBtnState()})))}},{key:"handle",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,o=this.getPDFUI();o.getStateHandlerManager().then((function(e){if(e.getCurrentStates()===ut){var a=ut.getType();ft(o),"joinSplit"===a?ut.joinSplit2EditText(o,e.pdfViewer):ut.activateType(o,e.pdfViewer,"touchup",!1)}else{var i,c,l;if(n)r.selectedPages.length>=1&&(c=r.selectedPages[0].pageRender,l=r.selectedPages[0].rectArray),(i=[c.index]).push([[l[0].start,l[0].end]]);ut.activateType(o,e.pdfViewer,"touchup",!1,i),e.switchTo(ut.getStateName())}t.changeBtnState()})),n||(this.openRightTextEditPanel(o,n),o.getPDFDocRender().then((function(e){e.$ui.find(".fv__mark-selection-blank").remove()})))}},{key:"openRightTextEditPanel",value:function(e,t){return n((function(){var n,r,o,a;return P(this,(function(i){switch(i.label){case 0:return[4,e.getComponentByName("sidebar-right")];case 1:return(n=i.sent())?[3,3]:[4,e.getComponentByName("edit-properties")];case 2:return(r=i.sent())?(!t&&r&&(r.setHost({},G.TouchUp),r.disable()),[2]):[2];case 3:return n.showRightFormatPanel(G.TouchUp),[4,e.getComponentByName("sidebar-right-tabs")];case 4:return(o=i.sent())?(o.openTab("edit-properties-panel"),o.setActivetab("edit-properties-panel"),[4,e.getComponentByName("edit-properties")]):[2];case 5:return a=i.sent(),!t&&a&&(a.setHost({},G.TouchUp),a.disable()),[2]}}))}))()}},{key:"postlink",value:function(){var e=this;this.addDestroyHook(this.getPDFUI().addViewerEventListener("switch-state-handler",(function(t,n,r){if(ft(e.getPDFUI()),["page-editor","touch-up-editor"].indexOf(t.getStateName())>-1){if(r&&r.disableRightPanel)return;if("findReplace"===ut.getType())return;e.openRightTextEditPanel(e.getPDFUI(),0)}})))}}],[{key:"getName",value:function(){return"EditTextController"}},{key:"permission",get:function(){return C.PDFViewCtrl.Consts.PDFDocPermission.ModifyDocument}}]),r}(C.Controller),Fa=function(e){g(n,e);var t=y(n);function n(){return i(this,n),t.apply(this,arguments)}return l(n,[{key:"changePermission",value:function(e){var t=this;this.getPDFUI().getPDFDocRender().then((function(e){e.getUserPermission().getValue()&t.constructor.permission?t.component.unlock&&t.component.unlock():t.component.lock&&t.component.lock()}))}},{key:"handle",value:function(){var e=this.getPDFUI();e.getStateHandlerManager().then((function(t){t.getCurrentStates()===ut?("touchup"===ut.getType()&&St.trigger("OnDeactivate"),ft(e),ut.activateType(e,t.pdfViewer,"joinSplit")):(ut.activateType(e,t.pdfViewer,"joinSplit"),t.switchTo(ut.getStateName()))}))}}],[{key:"getName",value:function(){return"JoinSplitController"}},{key:"permission",get:function(){return C.PDFViewCtrl.Consts.PDFDocPermission.ModifyDocument}}]),n}(C.Controller),ja=function(e){g(r,e);var t=y(r);function r(){return i(this,r),t.apply(this,arguments)}return l(r,[{key:"destroy",value:function(){ut.prototype.getPDFUI=function(){}}},{key:"init",value:function(e){var t,r=this;this.pdfUI=e,ut.prototype.getPDFUI=function(){return e},e.getPDFViewer().then((function(t){r.viewer=t,t.getStateHandlerManager().register(Bo),t.getStateHandlerManager().register(ut),t.getScrollWrap().addScrollEventListener((function(){return r.updatePageMatrix(100)}));var n=Ne()((function(){switch(e.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()){case"page-editor":case"touch-up-editor":break;default:return}r.updatePageMatrix()}),100);e.getComponentByName("sidebar").then((function(e){e&&(e.on(Ra.RESIZE,n),e.on(Ra.HIDDEN,n))}))})),e.getRootComponent().then((t=n((function(t){var n,r;return P(this,(function(o){switch(o.label){case 0:return[4,t.waitForComponentLifecycle("edit-properties","mounted")];case 1:return n=v.apply(void 0,[o.sent(),1]),(r=n[0])?(Oa(r.element).on("pointerup",".icon-btn[name]",(function(){switch(e.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()){case"page-editor":case"touch-up-editor":break;default:return}j.getElement().focus()})),[2]):[2]}}))})),function(e){return t.apply(this,arguments)}));var o,a=!0;e.addViewerEventListener((s(o={},Ma.zoomToSuccess,(function(){return r.updatePageMatrix(100)})),s(o,Ma.changeViewModeSuccess,(function(){return r.updatePageMatrix(100)})),s(o,Ta.Events.openFileSuccess,(function(e){Dt.hide(),r.textToolStyle&&r.setTextToolStyle(r.textToolStyle),a=!0})),s(o,Ma.switchStateHandler,(function(t,n){["touch-up-editor","page-editor"].includes(t.getStateName())||e.getComponentByName("edit-properties").then((function(t){t&&[G.TextObject,G.PathObject,G.ImageObject,G.ShadingObject,G.FormXObject,G.TouchUp].indexOf(t.hostType)>-1&&e.getComponentByName("sidebar-right-tabs").then((function(e){e&&e.openTabs.length>1&&e.closeTab("edit-properties-panel")}))}))})),s(o,"pageeditor-started",(function(){r.editingObjectToolStyle&&a&&r.setEditingObjectToolStyle(r.editingObjectToolStyle),a=!1})),s(o,"switch-touchup",(function(t){var n=t.type,r=void 0===n?"touchup":n,o=e.pdfViewer.getStateHandlerManager();ut.setType(r),o.getCurrentStates()!==ut&&(ut.activateType(e,o.pdfViewer,r,!1),o.switchTo(ut.getStateName()))})),s(o,Ma.pageAdded,(function(){r.reInitPageEditor()})),s(o,Ma.pageMoved,(function(){r.reInitPageEditor()})),s(o,Ma.pagesMoved,(function(){r.reInitPageEditor()})),s(o,Ma.pageRemoved,(function(){r.reInitPageEditor()})),s(o,Ma.pagesRemoved,(function(){r.reInitPageEditor()})),s(o,Ma.insertPages,(function(){r.reInitPageEditor()})),s(o,Ma.importPages,(function(){r.reInitPageEditor()})),o)),e.registerDialog("pageEditorProps",(function(){if(!r.dialog)return e.getComponentByName("template-container").then((function(e){var t=r.dialog=e.append(Uo()({AdditionalFamilies:C.shared.AdditionalFamilies}),[{target:"PE-lineStyle",config:{selectorClass:"fv__ui-border-style-selector",options:[{value:0,class:"fv__ui-line-style-0",lable:!1},{value:1,class:"fv__ui-line-style-1",lable:!1},{value:2,class:"fv__ui-line-style-2",lable:!1},{value:3,class:"fv__ui-line-style-3",lable:!1},{value:4,class:"fv__ui-line-style-4",lable:!1},{value:5,class:"fv__ui-line-style-5",lable:!1},{value:6,class:"fv__ui-line-style-6",lable:!1}]}}]);t.open(document.body),t.show()}));r.dialog.show()}))}},{key:"reInitPageEditor",value:function(){this.pdfUI.getCurrentPDFDoc().then((function(e){e.api.reInitPageEditor(e.id)}))}},{key:"updatePageMatrix",value:function(e){var t=this.viewer,n=t.getStateHandlerManager().currentStateHandler;switch(n.getStateName()){case"page-editor":n.setMatrix(t,0,e);break;case"touch-up-editor":gt(t,1,e)}}},{key:"beforeMounted",value:function(e){}},{key:"fragments",value:function(){return[]}},{key:"receiveAction",value:function(e,t){var n=this[e];if("function"==typeof n)return n.apply(this,t)}},{key:"getActiveObject",value:function(){var e=this.pdfUI.pdfViewer,t=e.getCurrentPDFDoc();return t?"page-editor"!==e.getStateHandlerManager().currentStateHandler.getStateName()?Promise.resolve():t.getPageEditor().getActiveObject().then((function(t){return t&&function(e,t){switch(e.json.type){case 1:return new Ea(e,t);case 2:return new wa(e,t);case 4:return new xa(e,t);default:return new ka(e,t)}}(t,e)})):Promise.resolve()}},{key:"onClick",value:function(e,t){var n,r=this,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=this.pdfUI.pdfViewer;if(!a.getCurrentPDFDoc())return Promise.resolve();if("page-editor"!==a.getStateHandlerManager().currentStateHandler.getStateName())return Promise.resolve();if(o){var i=a.getPDFPageRender(e);if(!i)return Promise.resolve();n=i.transformPoint({point:t,srcType:"pdf",destType:"PDFViewerPort"})}else n=Promise.resolve(t);return n.then((function(t){var n=devicePixelRatio||1,o=[{type:"EditorPage",value:e},{type:"PointF",value:[t.x*n,t.y*n]}];return a.eventEmitter.emit("PageEditor_onStartClick"),St.trigger("OnHitObjectTest",m(o)).then((function(){return St.trigger("OnLButtonDown",m(o).concat([0])).then((function(){return St.trigger("OnLButtonUp",m(o).concat([0])).then((function(){r.pdfUI.getComponentByName("sidebar-right").then((function(e){e&&e.hide()}))}))}))})).finally((function(){a.eventEmitter.emit("PageEditor_onEndClick")}))}))}},{key:"activate",value:function(e){var t=this;return Promise.all([this.pdfUI.getCurrentPDFDoc(),this.pdfUI.getStore()]).then((function(n){var r=v(n,2),o=r[0],a=r[1];if(o)return t.pdfUI.getStateHandlerManager().then((function(n){return a.dispatch(Pe,be),n.switchTo(Bo.getStateName(),{disableRightPanel:!0}),o.getPageEditor().setObjectFilter(re[e]).then((function(){return t.pdfUI.getComponentByName("sidebar-right").then((function(e){e&&e.hide()})),t.pdfUI.getComponentByName("edit-object-ribbon-dropdown").then((function(t){if(t){var n=t.getComponentByName(e);n&&Oa(n.element).addClass("active").siblings().removeClass("active")}}))}))}))}))}},{key:"deactivate",value:function(){var e=this;return this.pdfUI.getStateHandlerManager().then((function(t){return t.switchTo("hand"),e.pdfUI.getComponentByName("edit-object-ribbon-dropdown").then((function(e){if(e){var t=e.getComponentByName("All");t&&Oa(t.element).removeClass("active").siblings().removeClass("active")}}))}))}},{key:"loadStyleConfigFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"touchup",t=this;return n((function(){var n,r,o;return P(this,(function(a){switch(a.label){case 0:return n=t.pdfUI.pdfViewer,(r=n.getCurrentPDFDoc())?t.advEditorConfigFilebuffer?[3,3]:("assets/advEditor",o=Ta.shared.resolvePath(n.libPath,"assets/advEditor","advedit-interaction-config-default.pdf"),[4,fetch(o)]):[2,Promise.resolve()];case 1:return[4,a.sent().blob()];case 2:t.advEditorConfigFilebuffer=a.sent(),a.label=3;case 3:return[2,r.loadAdvEditorConfigFile(t.advEditorConfigFilebuffer,e)]}}))}))()}},{key:"setTextToolStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return n((function(){var n,r;return P(this,(function(o){switch(o.label){case 0:return n=t.pdfUI.pdfViewer,(r=n.getCurrentPDFDoc())?[4,t.loadStyleConfigFile("touchup")]:[2,Promise.resolve()];case 1:if(!o.sent())throw new Error("Failed to load the text tool style configuration file.");return e.cursor&&(e.editTextCaret=e.cursor),t.textToolStyle=e,[2,r.setAdvEditorTextToolStyle(e)]}}))}))()}},{key:"setEditingObjectToolStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return n((function(){var n,r;return P(this,(function(o){switch(o.label){case 0:return n=t.pdfUI.pdfViewer,(r=n.getCurrentPDFDoc())?[4,t.loadStyleConfigFile("pageEditor")]:[2,Promise.resolve()];case 1:if(!o.sent())throw new Error("Please activate the pageEditor first.");return e.addShapeBox&&(e.editShapeBox=e.addShapeBox),t.editingObjectToolStyle=e,[2,r.setAdvEditorEditingObjectToolStyle(e)]}}))}))()}}],[{key:"getName",value:function(){return"page-editor"}},{key:"getLoader",value:function(){return E()}},{key:"permission",get:function(){return C.PDFViewCtrl.Consts.PDFDocPermission.ModifyDocument}},{key:"initOnLoad",value:function(){var e=C.modular.module("page-editor",[]);e.registerController(Da),e.registerController(Fa),e.registerPreConfiguredComponent("edit-text",{template:'<ribbon-button name="edit-text" icon-class="fv__icon-edit-touch-up" @tooltip text="page-editor:buttons.edit-text"></ribbon-button>',config:[{target:"edit-text",tooltip:{title:"page-editor:buttons.edit-text"},callback:Da}]}),e.registerPreConfiguredComponent("join-split",{template:'<ribbon-button name="join-split" icon-class="fv__icon-edit-join-split" @tooltip text="page-editor:buttons.join-split"></ribbon-button>',config:[{target:"join-split",tooltip:{title:"page-editor:buttons.join-split"},callback:Fa}]}),e.registerPreConfiguredComponent("join",{template:'<ribbon-button name="join-split-join" class="fv__ui-toolbar-show-text-button" icon-class="fv__icon-join-split-join" @tooltip text="page-editor:buttons.join"></ribbon-button>',config:[{target:"join-split-join",tooltip:{title:"page-editor:buttons.join"},callback:function(e){g(n,e);var t=y(n);function n(){return i(this,n),t.apply(this,arguments)}return l(n,[{key:"handle",value:function(){this.getPDFUI().getCurrentPDFDoc().then((function(e){e.getTouchup().handleEvent("JoinBoxes")}))}}],[{key:"getName",value:function(){return"join"}}]),n}(C.Controller)}]}),e.registerPreConfiguredComponent("split",{template:'<ribbon-button name="join-split-split" class="fv__ui-toolbar-show-text-button" icon-class="fv__icon-join-split-split" @tooltip text="page-editor:buttons.split"></ribbon-button>',config:[{target:"join-split-split",tooltip:{title:"page-editor:buttons.split"},callback:function(e){g(n,e);var t=y(n);function n(){return i(this,n),t.apply(this,arguments)}return l(n,[{key:"handle",value:function(){this.getPDFUI().getCurrentPDFDoc().then((function(e){e.getTouchup().handleEvent("SplitBoxes")}))}}],[{key:"getName",value:function(){return"split"}}]),n}(C.Controller)}]}),e.registerPreConfiguredComponent("link",{template:'<ribbon-button name="join-split-link" class="fv__ui-toolbar-show-text-button" icon-class="fv__icon-join-split-link" @tooltip text="page-editor:buttons.link"></ribbon-button>',config:[{target:"join-split-link",tooltip:{title:"page-editor:buttons.link"},callback:function(e){g(n,e);var t=y(n);function n(){return i(this,n),t.apply(this,arguments)}return l(n,[{key:"handle",value:function(){this.getPDFUI().getCurrentPDFDoc().then((function(e){e.getTouchup().handleEvent("LinkBoxes")}))}}],[{key:"getName",value:function(){return"link"}}]),n}(C.Controller)}]}),e.registerPreConfiguredComponent("unlink",{template:'<ribbon-button name="join-split-unlink" class="fv__ui-toolbar-show-text-button" icon-class="fv__icon-join-split-unlink" @tooltip text="page-editor:buttons.unlink"></ribbon-button>',config:[{target:"join-split-unlink",tooltip:{title:"page-editor:buttons.unlink"},callback:function(e){g(n,e);var t=y(n);function n(){return i(this,n),t.apply(this,arguments)}return l(n,[{key:"handle",value:function(){this.getPDFUI().getCurrentPDFDoc().then((function(e){e.getTouchup().handleEvent("UnlinkBoxes")}))}}],[{key:"getName",value:function(){return"unlink"}}]),n}(C.Controller)}]}),e.registerPreConfiguredComponent("select-none",{template:'<ribbon-button name="join-split-select-none" class="fv__ui-toolbar-show-text-button" icon-class="fv__icon-join-split-select-none" @tooltip text="page-editor:buttons.select-none"></ribbon-button>',config:[{target:"join-split-select-none",tooltip:{title:"page-editor:buttons.select-none"},callback:function(e){g(n,e);var t=y(n);function n(){return i(this,n),t.apply(this,arguments)}return l(n,[{key:"handle",value:function(){this.getPDFUI().getCurrentPDFDoc().then((function(e){e.getTouchup().handleEvent("SelectNone")}))}}],[{key:"getName",value:function(){return"select-none"}}]),n}(C.Controller)}]}),e.registerPreConfiguredComponent("close",{template:'<ribbon-button name="join-split-close" class="fv__ui-toolbar-show-text-button" icon-class="fv__icon-join-split-close" @tooltip text="page-editor:buttons.close"></ribbon-button>',config:[{target:"join-split-close",tooltip:{title:"page-editor:buttons.close"},callback:function(e){g(n,e);var t=y(n);function n(){return i(this,n),t.apply(this,arguments)}return l(n,[{key:"handle",value:function(){var e=this;this.getPDFUI().getStateHandlerManager().then((function(t){t.switchTo("hand"),e.getPDFUI().getComponentByName("edit-tab").then((function(e){e.active()}))}))}}],[{key:"getName",value:function(){return"close"}}]),n}(C.Controller)}]}),e.registerController(qo),e.registerController(oa),e.registerPreConfiguredComponent("edit-object-ribbon-dropdown",{template:Qo()()}),e.registerController(ca),e.registerPreConfiguredComponent("add-text-button",{template:'<ribbon-button name="fv--plugin-PageEditor-add-text" icon-class="fv__icon-menu-add-text" @controller="page-editor:AddTextController" @tooltip tooltip-title="page-editor:addText.title">page-editor:addText.title</ribbon-button>'}),e.registerController(sa),e.registerPreConfiguredComponent("add-image-button",{template:'<ribbon-button name="fv--plugin-PageEditor-add-image" icon-class="fv__icon-menu-add-image" @controller="page-editor:AddImageAdvController" @tooltip tooltip-title="page-editor:addImage.title" class="fx-ribbon-hidden-dropdown" @var.self="$component" not-dropdown="true">\n                <dropdown @on.selected="self.select($args[0])" selected="0">\n                    <file-selector ribbon-icon="fx-icon-ribbon_edit_add_images-32" icon-class="fv__icon-edit-add-image" accept=".bmp,.jpg,.jpeg,.jpf,.jpx,.jp2,.j2k,.jpc,.j2c,.png,.tiff,.tif,.exif,.gif" text="page-editor:addImage.title"></file-selector>\n                </dropdown>\n            </ribbon-button>'}),e.registerController(ga),e.registerPreConfiguredComponent("add-shapes-ribbon-dropdown",{template:pa()()}),e.getRegistry().registerPipe("format_number",Ia)}}]),r}(C.UIXAddon);Object.assign(C.addons,{},{page_editor:(Aa=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){s(e,t,n[t])}))}return e}({},e),_a={AddImageAdvController:sa,AddShapesController:ga,AddTextController:ca,EditObjectController:oa,EditTextController:Da,JoinSplitController:Fa},_a=null!=_a?_a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(Aa,Object.getOwnPropertyDescriptors(_a)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(_a)).forEach((function(e){Object.defineProperty(Aa,e,Object.getOwnPropertyDescriptor(_a,e))})),Aa)})})(),a=a.default})()));