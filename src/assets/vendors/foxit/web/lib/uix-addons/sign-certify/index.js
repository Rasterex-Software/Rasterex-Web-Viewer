!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("UIExtension")):"function"==typeof define&&define.amd?define(["UIExtension"],t):"object"==typeof exports?exports.SignDoc=t(require("UIExtension")):e.SignDoc=t(e.UIExtension)}(self,(e=>(()=>{var t={456:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return'<ribbon-button\nname="sign-certify-dropdown"\n@tooltip\ntooltip-title="phantom_online:toolbar.protect.signCertify"\ntext="phantom_online:toolbar.protect.signCertify"\nicon-class="fx-icon-ribbon_protect_sign_certify_certify_with_visible_signature-32"\nnot-immediately="true"\n>\n<dropdown separate="false">\n<dropdown-button\nname="place-signature"\n@tooltip\ntooltip-title="SignDoc:placeSig.tip"\nicon-class="fx-icon-page-sig"\ntext="SignDoc:placeSig.text"\n>SignDoc:placeSig.text\n</dropdown-button>\n<dropdown-button\nname="sign-document"\n@tooltip\ntooltip-title="SignDoc:signDoc.tip"\nicon-class="fx-icon-sign-document"\ntext="SignDoc:signDoc.text"\n>SignDoc:signDoc.text\n</dropdown-button>\n<dropdown-button\nname="certify-with-sig"\n@tooltip\ntooltip-title="SignDoc:certify.visibleDesc"\nicon-class="fx-icon-certify-sig"\ntext="SignDoc:certify.visible"\n>SignDoc:certify.visible\n</dropdown-button>\n<dropdown-button\nname="certify-without-sig"\n@tooltip\ntooltip-title="SignDoc:certify.invisibleDesc"\nicon-class="fx-icon-certify"\ntext="SignDoc:certify.invisible"\n>SignDoc:certify.invisible\n</dropdown-button>\n<li class="fv__ui-dropdown-separator"></li>\n<dropdown-button\nname="digital-ids-btn"\n@tooltip\ntooltip-title="phantom_online:toolbar.protect.digitalIDs"\nicon-class="fx-icon-ribbon_protect_signature_digital_ids-16"\ntext="phantom_online:toolbar.protect.digitalIDs"\n>phantom_online:toolbar.protect.digitalIDs\n</dropdown-button>\n<dropdown-button\nname="trust-certs"\n@tooltip\ntooltip-title="SignDoc:certify.trustCertsDesc"\nicon-class="fx-icon-trust-root"\ntext="SignDoc:certify.trustCerts"\n>SignDoc:certify.trustCerts\n</dropdown-button>\n</dropdown>\n</ribbon-button>\n','<ribbon-button\nname="sign-certify-dropdown"\n@tooltip\ntooltip-title="phantom_online:toolbar.protect.signCertify"\ntext="phantom_online:toolbar.protect.signCertify"\nicon-class="fx-icon-ribbon_protect_sign_certify_certify_with_visible_signature-32"\nnot-immediately="true"\n>\n<dropdown separate="false">\n<dropdown-button\nname="place-signature"\n@tooltip\ntooltip-title="SignDoc:placeSig.tip"\nicon-class="fx-icon-page-sig"\ntext="SignDoc:placeSig.text"\n>SignDoc:placeSig.text\n</dropdown-button>\n<dropdown-button\nname="sign-document"\n@tooltip\ntooltip-title="SignDoc:signDoc.tip"\nicon-class="fx-icon-sign-document"\ntext="SignDoc:signDoc.text"\n>SignDoc:signDoc.text\n</dropdown-button>\n<dropdown-button\nname="certify-with-sig"\n@tooltip\ntooltip-title="SignDoc:certify.visibleDesc"\nicon-class="fx-icon-certify-sig"\ntext="SignDoc:certify.visible"\n>SignDoc:certify.visible\n</dropdown-button>\n<dropdown-button\nname="certify-without-sig"\n@tooltip\ntooltip-title="SignDoc:certify.invisibleDesc"\nicon-class="fx-icon-certify"\ntext="SignDoc:certify.invisible"\n>SignDoc:certify.invisible\n</dropdown-button>\n<li class="fv__ui-dropdown-separator"></li>\n<dropdown-button\nname="digital-ids-btn"\n@tooltip\ntooltip-title="phantom_online:toolbar.protect.digitalIDs"\nicon-class="fx-icon-ribbon_protect_signature_digital_ids-16"\ntext="phantom_online:toolbar.protect.digitalIDs"\n>phantom_online:toolbar.protect.digitalIDs\n</dropdown-button>\n<dropdown-button\nname="trust-certs"\n@tooltip\ntooltip-title="SignDoc:certify.trustCertsDesc"\nicon-class="fx-icon-trust-root"\ntext="SignDoc:certify.trustCerts"\n>SignDoc:certify.trustCerts\n</dropdown-button>\n</dropdown>\n</ribbon-button>\n'}},254:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return'<layer class="center fv__export-cert-dialog" modal @var.self="$component">\n<layer-header class="fv__export-cert-header" @draggable="{type:\'parent\'}" title="SignDoc:exportCert.header" ></layer-header>\n<layer-view>\n<div class="upper">\n<div class="subtitle">SignDoc:exportCert.subtitle</div>\n<div class="certTitle">SignDoc:exportCert.certTitle</div>\n<div class="certInfo">SignDoc:exportCert.certInfo</div>\n</div>\n<div class="lower">\n<div class="optionTitle">SignDoc:exportCert.option.title</div>\n<div class="formatHint">SignDoc:exportCert.option.formatHint</div>\n<div class="input disabled">\n<input type="radio" disabled class="disabled"/>\n<span>SignDoc:exportCert.option.email</span>\n</div>\n<div class="input"><input type="radio" checked="1"/>\n<span>SignDoc:exportCert.option.file</span></div>\n</div>\n<div class="footer">\n<div class="okButton" @on.click="self.onOk()">SignDoc:viewCert.ok</div>\n<div class="closeButton" @on.click="self.hide()">SignDoc:viewCert.cancel</div>\n</div>\n</layer-view>\n</layer>','<layer class="center fv__export-cert-dialog" modal @var.self="$component">\n<layer-header class="fv__export-cert-header" @draggable="{type:\'parent\'}" title="SignDoc:exportCert.header" ></layer-header>\n<layer-view>\n<div class="upper">\n<div class="subtitle">SignDoc:exportCert.subtitle</div>\n<div class="certTitle">SignDoc:exportCert.certTitle</div>\n<div class="certInfo">SignDoc:exportCert.certInfo</div>\n</div>\n<div class="lower">\n<div class="optionTitle">SignDoc:exportCert.option.title</div>\n<div class="formatHint">SignDoc:exportCert.option.formatHint</div>\n<div class="input disabled">\n<input type="radio" disabled class="disabled"/>\n<span>SignDoc:exportCert.option.email</span>\n</div>\n<div class="input"><input type="radio" checked="1"/>\n<span>SignDoc:exportCert.option.file</span></div>\n</div>\n<div class="footer">\n<div class="okButton" @on.click="self.onOk()">SignDoc:viewCert.ok</div>\n<div class="closeButton" @on.click="self.hide()">SignDoc:viewCert.cancel</div>\n</div>\n</layer-view>\n</layer>'}},963:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return'<layer class="center fv__trust-certs-dialog" modal @var.self="$component">\n<layer-header class="fv__trust-certs-header" @draggable="{type:\'parent\'}" title="SignDoc:certify.header" ></layer-header>\n<layer-view>\n<div class="tools">\n<div @on.click="self.onEditCertView()">SignDoc:certify.edit</div>\n<div class="addCert">\n<div>\nSignDoc:certify.add\n</div>\n<input title="" type="file" accept=".p7b,.pbc,.cer" />\n</div>\n<div @on.click="self.onViewTrustCert()">SignDoc:certify.view</div>\n<div @on.click="self.onExportTrustCert()">SignDoc:certify.export</div>\n<div @on.click="self.onDeleteTrustCert()">SignDoc:certify.delete</div>\n</div>\n<div class="cert-list">\n<div class="header">\n<div class="w30p">SignDoc:certify.name</div>\n<div class="w30p">SignDoc:certify.issuedBy</div>\n<div class="w20p">SignDoc:certify.trust</div>\n<div>SignDoc:certify.expiredData</div>\n</div>\n<div class="body" name="cert-body"></div>\n</div>\n<div class="cert-info">\n<div class="subjectName">\n<label>SignDoc:certify.certName</label>\n<div></div>\n</div>\n<div class="issuerName">\n<label>SignDoc:certify.issuer</label>\n<div></div>\n</div>\n<div class="validPeriodFrom">\n<label>SignDoc:certify.validFrom</label>\n<div></div>\n</div>\n<div class="validPeriodTo">\n<label>SignDoc:certify.validTo</label>\n<div></div>\n</div>\n<div class="keyUsageStr">\n<label>SignDoc:certify.intent</label>\n<div></div>\n</div>\n</div>\n<div class="footer">\n<div class="closeButton" @on.click="self.hide()">SignDoc:certify.close</div>\n</div>\n</layer-view>\n</layer>','<layer class="center fv__trust-certs-dialog" modal @var.self="$component">\n<layer-header class="fv__trust-certs-header" @draggable="{type:\'parent\'}" title="SignDoc:certify.header" ></layer-header>\n<layer-view>\n<div class="tools">\n<div @on.click="self.onEditCertView()">SignDoc:certify.edit</div>\n<div class="addCert">\n<div>\nSignDoc:certify.add\n</div>\n<input title="" type="file" accept=".p7b,.pbc,.cer" />\n</div>\n<div @on.click="self.onViewTrustCert()">SignDoc:certify.view</div>\n<div @on.click="self.onExportTrustCert()">SignDoc:certify.export</div>\n<div @on.click="self.onDeleteTrustCert()">SignDoc:certify.delete</div>\n</div>\n<div class="cert-list">\n<div class="header">\n<div class="w30p">SignDoc:certify.name</div>\n<div class="w30p">SignDoc:certify.issuedBy</div>\n<div class="w20p">SignDoc:certify.trust</div>\n<div>SignDoc:certify.expiredData</div>\n</div>\n<div class="body" name="cert-body"></div>\n</div>\n<div class="cert-info">\n<div class="subjectName">\n<label>SignDoc:certify.certName</label>\n<div></div>\n</div>\n<div class="issuerName">\n<label>SignDoc:certify.issuer</label>\n<div></div>\n</div>\n<div class="validPeriodFrom">\n<label>SignDoc:certify.validFrom</label>\n<div></div>\n</div>\n<div class="validPeriodTo">\n<label>SignDoc:certify.validTo</label>\n<div></div>\n</div>\n<div class="keyUsageStr">\n<label>SignDoc:certify.intent</label>\n<div></div>\n</div>\n</div>\n<div class="footer">\n<div class="closeButton" @on.click="self.hide()">SignDoc:certify.close</div>\n</div>\n</layer-view>\n</layer>'}},182:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return'<layer class="center fv__view-certs-dialog" modal @var.self="$component">\n<layer-header\nclass="fv__view-certs-header"\n@draggable="{type:\'parent\'}"\ntitle="SignDoc:viewCert.header"\n></layer-header>\n<layer-view>\n<div class="details">\n<div class="title">SignDoc:viewCert.detailTitle</div>\n<div class="subjectName">\n<label>SignDoc:viewCert.subject</label>\n<div></div>\n</div>\n<div class="issuerName">\n<label>SignDoc:certify.issuer</label>\n<div></div>\n</div>\n<div class="keyUsageStr">\n<label>SignDoc:viewCert.usage</label>\n<div></div>\n</div>\n<div class="validPeriodTo">\n<label>SignDoc:viewCert.expiration</label>\n<div></div>\n</div>\n</div>\n<div class="trust">\n<div class="title">SignDoc:viewCert.trust</div>\n<div class="info">SignDoc:viewCert.trustInfo</div>\n<div class="input">\n<input type="checkbox" id="trustRoot"></input>\n<label type="trustRoot">SignDoc:viewCert.trustRoot</label>\n</div>\n<div class="afterSign">SignDoc:viewCert.afterSign</div>\n<div class="input">\n<input type="checkbox" class="disabled" id="valid"></input>\n<label type="trustRoot">SignDoc:viewCert.valid</label>\n</div>\n<div class="input">\n<input type="checkbox" id="validCert"></input>\n<label type="trustRoot">SignDoc:viewCert.validCert</label>\n</div>\n</div>\n<div class="footer">\n<div class="okButton" @on.click="self.onOk()">SignDoc:viewCert.ok</div>\n<div class="closeButton" @on.click="self.hide()">SignDoc:viewCert.cancel</div>\n</div>\n</layer-view>\n</layer>\n','<layer class="center fv__view-certs-dialog" modal @var.self="$component">\n<layer-header\nclass="fv__view-certs-header"\n@draggable="{type:\'parent\'}"\ntitle="SignDoc:viewCert.header"\n></layer-header>\n<layer-view>\n<div class="details">\n<div class="title">SignDoc:viewCert.detailTitle</div>\n<div class="subjectName">\n<label>SignDoc:viewCert.subject</label>\n<div></div>\n</div>\n<div class="issuerName">\n<label>SignDoc:certify.issuer</label>\n<div></div>\n</div>\n<div class="keyUsageStr">\n<label>SignDoc:viewCert.usage</label>\n<div></div>\n</div>\n<div class="validPeriodTo">\n<label>SignDoc:viewCert.expiration</label>\n<div></div>\n</div>\n</div>\n<div class="trust">\n<div class="title">SignDoc:viewCert.trust</div>\n<div class="info">SignDoc:viewCert.trustInfo</div>\n<div class="input">\n<input type="checkbox" id="trustRoot"></input>\n<label type="trustRoot">SignDoc:viewCert.trustRoot</label>\n</div>\n<div class="afterSign">SignDoc:viewCert.afterSign</div>\n<div class="input">\n<input type="checkbox" class="disabled" id="valid"></input>\n<label type="trustRoot">SignDoc:viewCert.valid</label>\n</div>\n<div class="input">\n<input type="checkbox" id="validCert"></input>\n<label type="trustRoot">SignDoc:viewCert.validCert</label>\n</div>\n</div>\n<div class="footer">\n<div class="okButton" @on.click="self.onOk()">SignDoc:viewCert.ok</div>\n<div class="closeButton" @on.click="self.hide()">SignDoc:viewCert.cancel</div>\n</div>\n</layer-view>\n</layer>\n'}},180:e=>{e.exports=null},585:(e,t,n)=>{"use strict";
/*! art-template@runtime | https://github.com/aui/art-template */var i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},r=Object.create(i),o=/["&'<>]/;function a(e){return"string"!=typeof e&&(e=null==e?"":"function"==typeof e?a(e.call(e)):JSON.stringify(e)),e}r.$escape=function(e){return function(e){var t=""+e,n=o.exec(t);if(!n)return e;var i="",r=void 0,a=void 0,c=void 0;for(r=n.index,a=0;r<t.length;r++){switch(t.charCodeAt(r)){case 34:c="&#34;";break;case 38:c="&#38;";break;case 39:c="&#39;";break;case 60:c="&#60;";break;case 62:c="&#62;";break;default:continue}a!==r&&(i+=t.substring(a,r)),a=r+1,i+=c}return a!==r?i+t.substring(a,r):i}(a(e))},r.$each=function(e,t){if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++)t(e[n],n);else for(var r in e)t(e[r],r)},e.exports=r},779:(e,t,n)=>{"use strict";e.exports=n(585)},616:t=>{"use strict";t.exports=e}},n={};function i(e){var r=n[e];if(void 0!==r)return r.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,i),o.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r={};return(()=>{"use strict";function e(e,t,n,i,r,o,a){try{var c=e[o](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(i,r)}function t(e,n){return null!=n&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](e):t(e,n)}function n(e,n){if(!t(e,n))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function u(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(e){c=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw r}}return o}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function g(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p(e);if(t){var r=p(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return g(this,n)}}i.d(r,{default:()=>M});function b(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&c[0]?i.return:c[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,c[1])).done)return r;switch(i=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,i=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){a.label=c[1];break}if(6===c[0]&&a.label<r[1]){a.label=r[1],r=c;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(c);break}r[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],i=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;var h,m=i(616),S=i(180),D=i.n(S),w=i(456),C=i.n(w);function k(e,t,n){return k="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n||e):r.value}},k(e,t,n||e)}function x(e){return function(e){l(i,e);var t=y(i);function i(e){return n(this,i),t.call(this,e,"square")}return a(i,[{key:"start",value:function(e){k(p(i.prototype),"start",this).call(this,e),Object.assign(this.currentFakeAnnot.annotationInfo,{borderInfo:{width:0,style:1},color:9224925,fillColor:13426668,opacity:.5})}},{key:"end",value:function(){var e=this.currentFakeAnnot;h(e.page.getIndex(),e.pdfRect,e),this.currentFakeAnnot=null}},{key:"destroyPageHandler",value:function(){k(p(i.prototype),"destroyPageHandler",this).call(this),this.currentFakeAnnot&&this.currentFakeAnnot.destroy()}}],[{key:"getStateName",value:function(){return"createRect"}},{key:"setParams",value:function(e){h=e}}]),i}(e.simpleShapeHandler)}var _=i(963),T=i.n(_),I=i(182),N=i.n(I),P=m.vendors.jQuery,R=function(e){l(i,e);var t=y(i);function i(){return n(this,i),t.apply(this,arguments)}return a(i,[{key:"show",value:function(e,t,n){k(p(i.prototype),"show",this).call(this,e),this.updateCert=n,this.cert=t;var r=t.usage,o=t.isCertTrustedRoot;this.certDate={usage:r,isCertTrustedRoot:o};var a=P(this.element);a.find("#trustRoot")[0].checked=o,["subjectName","issuerName","keyUsageStr","validPeriodTo"].map((function(e){a.find("."+e+" div").html(t[e])})),a.find("#valid").addClass("disabled")[0].checked=1,a.find("#validCert")[0].checked=2&r}},{key:"onOk",value:function(){this.updateCert(Object.assign({},this.cert,this.certDate)),this.hide()}},{key:"mounted",value:function(){var e=this;k(p(i.prototype),"mounted",this).call(this),P(this.element).find("input").on("change",(function(t){switch(t.target.id){case"trustRoot":e.certDate.isCertTrustedRoot=t.target.checked;break;case"valid":t.target.checked?e.certDate.usage|=1:e.certDate.usage&=2;break;case"validCert":t.target.checked?e.certDate.usage|=2:e.certDate.usage&=1}}))}}],[{key:"getName",value:function(){return"ViewTrustCertsDialog"}}]),i}(m.SeniorComponentFactory.createSuperClass({template:N()()})),F=i(254),j=i.n(F),B=m.vendors,O=m.vendors.jQuery,A=(m.toolkit.CertUtil,function(e){l(i,e);var t=y(i);function i(){return n(this,i),t.apply(this,arguments)}return a(i,[{key:"show",value:function(e,t){k(p(i.prototype),"show",this).call(this,e),this.cert=t;var n=O(this.element).prev();n.length&&n.hasClass("fv__ui-layer-modal")&&n.css("zIndex",O(this.element).css("zIndex"))}},{key:"onOk",value:function(){B(this.cert.cerFile,this.cert.subjectName+".cer"),this.hide()}}],[{key:"getName",value:function(){return"ExportCertDialog"}}]),i}(m.SeniorComponentFactory.createSuperClass({template:j()()}))),U=m.vendors.jQuery,E=m.toolkit.CertUtil,V=function(e){l(i,e);var t=y(i);function i(){return n(this,i),t.apply(this,arguments)}return a(i,[{key:"mounted",value:function(){var e=this;k(p(i.prototype),"mounted",this).call(this),U(this.element).find(".addCert input").on("change",(function(t){var n=t.target.files[0],i=e.pdfUI;i.getCurrentPDFDoc().then((function(e){return e.engine.getCertificateInfo(n,"")})).then((function(t){t.serial?E.addTrustedCertToCertificateList(t,!1).then((function(n){n.serialNumber=t.serial;var r=U('<div class="cert selected" id="'.concat(n.uniqueSerialNumber,'">\n                    <div class="w30p" title="').concat(n.subjectName,'">').concat(n.subjectName,'</div>\n                <div class="w30p" title="').concat(n.issuerName,'">').concat(n.issuerName,'</div>\n                    <div class="w20p trustRoot">').concat(n.isCertTrustedRoot?i.i18n.t("SignDoc:trustedRoot"):i.i18n.t("SignDoc:nonTrustedRoot"),"</div>\n                    <div>").concat(n.validPeriodTo,"</div></div>"));U(e.element).find(".cert-list .body .selected").removeClass("selected"),U(e.element).find(".cert-list .body").prepend(r),r[0].scrollIntoView(),e.onSelectCert(n.uniqueSerialNumber)})):i.alert({message:"SignDoc:certify.notCert",level:"warning"})})),t.target.value=""})),U(this.element).find(".cert-list .body").on("click",(function(t){U(e.element).find(".cert-list .body .selected").removeClass("selected");var n=t.target,i=n.id;i.length||(i=(n=n.parentElement).id),U(n).addClass("selected"),e.onSelectCert(i)}))}},{key:"show",value:function(e){var t=this;k(p(i.prototype),"show",this).call(this,e);var n=this.pdfUI;E.getTrustedCertificateList(this.pdfUI).then((function(e){var i="",r=0;e.map((function(e,t){e.subjectName&&(i+='<div class="cert '.concat(r?"":"selected",'" id="').concat(e.uniqueSerialNumber,'">\n                    <div class="w30p" title="').concat(e.subjectName,'">').concat(e.subjectName,'</div>\n                <div class="w30p" title="').concat(e.issuerName,'">').concat(e.issuerName,'</div>\n                <div class="w20p trustRoot">').concat(e.isCertTrustedRoot?n.i18n.t("SignDoc:trustedRoot"):n.i18n.t("SignDoc:nonTrustedRoot"),"</div>\n                <div>").concat(e.validPeriodTo,"</div></div>"),r=t+1)})),U(t.element).find(".cert-list .body").empty().append(i),["subjectName","issuerName","validPeriodFrom","validPeriodTo","keyUsageStr"].map((function(n){U(t.element).find(".cert-info ."+n+" div").html(e[r-1][n])}));var o=U(t.element).prev();o.length&&o.hasClass("fv__ui-layer-modal")&&o.css("zIndex",U(t.element).css("zIndex"))}))}},{key:"onEditCertView",value:function(){var e=this,t=this.pdfUI,n=function(n){E.addTrustedCert(n),U(e.element).find(".body .selected .trustRoot").html(n.isCertTrustedRoot?t.i18n.t("SignDoc:trustedRoot"):t.i18n.t("SignDoc:nonTrustedRoot"))};this.getSelectedCert().then((function(i){if(e.viewTrustCertsDialog)e.viewTrustCertsDialog.show(document.body,i,n);else{var r="viewTrustCertsDialog";m.modular.module("certify").registerComponent(R),t.registerDialog(r,(function(){return t.getComponentByName("template-container").then((function(t){t.append('<certify:ViewTrustCertsDialog name="'.concat(r,'"></certify:ViewTrustCertsDialog>'));var o=e.viewTrustCertsDialog=t.getComponentByName(r);return o.show(document.body,i,n),o}))})),t.openDialog(r)}}))}},{key:"onAddTrustCert",value:function(){}},{key:"onViewTrustCert",value:function(){var e=this;this.getSelectedCert().then((function(t){if(e.certViewerDialog)return e.certViewerDialog.show({certificateInfo:t,fromTrustMgr:1},!0),Promise.resolve(e.certViewerDialog);e.certViewerDialog=new m.CertificateViewerComponent(e.pdfUI),e.certViewerDialog.show({certificateInfo:t,fromTrustMgr:1},!0)}))}},{key:"onExportTrustCert",value:function(){this.pdfUI;this.getSelectedCert().then((function(e){saveAs(e.cerFile,e.subjectName+".cer")}))}},{key:"onDeleteTrustCert",value:function(){var e=this;this.getSelectedCert().then((function(t){var n=function(){E.removeTrustedCert(t.uniqueSerialNumber),U(e.element).find(".body .selected").remove();var n=U(e.element).find(".body>div:first-child").addClass("selected");e.onSelectCert(n[0].id)};e.pdfUI.confirm({again:!0,message:"SignDoc:certify.deleteConfirm",level:"prompt",id:"SignDocCertifyDeleteConfirm"}).then(n,n)}))}},{key:"onSelectCert",value:function(e){var t=this;E.getTrustedCertificateList(this.pdfUI).then((function(n){var i=n.find((function(t){return t.uniqueSerialNumber==e}));["subjectName","issuerName","validPeriodFrom","validPeriodTo","keyUsageStr"].map((function(e){U(t.element).find(".cert-info ."+e+" div").html(i[e])}))}))}},{key:"getSelectedCert",value:function(){var e=U(this.element).find(".body .selected")[0].id;return E.getTrustedCertificateList(this.pdfUI).then((function(t){return t.find((function(t){return t.uniqueSerialNumber==e}))}))}}],[{key:"getName",value:function(){return"TrustCertsDialog"}}]),i}(m.SeniorComponentFactory.createSuperClass({template:T()()}));var M=function(t){l(r,t);var i=y(r);function r(){return n(this,r),i.apply(this,arguments)}return a(r,[{key:"signDocWithoutAnnot",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"placeSig",r=this.pdfUI;this.lastMark&&this.lastMark.destroy(),this.lastMark=n,r.signWithoutAnnot(e,t,i,(function(o,a){if(o){var s,l="";if("true"==window.localStorage.getItem("SignLater")&&"certifyInvisibleSig"!=i)return r.$confirm({message:"SignDoc:signLater",level:"prompt",title:"sidebar.signature.dialog.title",id:"signLater",again:!0,customBtns:[{id:"yes",text:"dialog.ok"}]}),r.getStateHandlerManager().then((function(e){return s=e,r.getPDFViewer()})).then((function(n){var i=n.currentPDFDoc,r=n.getPDFPageRender(e),s={mkRotate:((r.rotate/90||0)+r.page.getRotation())%4},l=function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7;n=e.i18n.t("form-designer:prefix."+i);var r="",o=t.countField(i,!1,!1),a="";do{a=n+o,r=t.fieldsNameMap[a],o+=1}while(r);return a}(n,i.PDFForm);o.fieldName=l,delete o.pageIndex;var d=n.getStorage().getItem("SignSetting")||{};return d[i.id]=c({},l,[o,a]),n.getStorage().setItem("SignSetting",d),i.PDFForm.addSignature(e,t,l,s)})).then((function(e){return s.switchTo("select-annotation")}));var d=null;r.getCurrentPDFDoc().then((function(e){d=e,(l=e.getFileName()||"").length<1&&(l="untitled.pdf");var t=JSON.parse(JSON.stringify(o));return t.noCheckRect="certifyInvisibleSig"==i,e.sign(t,o.sign,a)})).then((function(e){var t=r.customs,i=t.autoDownloadAfterSign,o=t.getSignedDocument;return(void 0===i||i)&&saveAs(e,l.replace(".pdf","_signed.pdf")),"function"==typeof o&&o(e),d.docModified=!1,d.otherOptions.disableSavePrompt=!0,n.destroy(),r.openPDFByFile(e,{fileName:l,isOpenNewFileAfterClose:1})}))}else n.destroy()}))}},{key:"updateButton",value:function(e){var t=e.PDFForm,n=e.getPermissionsSync(),i=288==(288&n),r=this.signDocBtn,o=this.placeSigBtn;i&&t.fields.some((function(e){return 7==e.getType()&&e.isSigned&&!e.isSigned()}))?r.enable():r.disable(),256&n||32&n||8&n?o.enable():o.disable(),i&&8&n?t.fields.some((function(e){return 7==e.getType()&&e.isSigned&&e.isSigned()}))?(this.certifyInvisibleSig.disable(),this.certifyVisibleSig.disable()):(this.certifyInvisibleSig.enable(),this.certifyVisibleSig.enable()):(this.certifyInvisibleSig.disable(),this.certifyVisibleSig.disable())}},{key:"initOnload",value:function(e){var t=this,n="exportCertDialog";m.modular.module("certify",[]).registerComponent(A),e.registerDialog(n,(function(i,r){return e.getComponentByName("template-container").then((function(e){t.exportCertDialog&&t.exportCertDialog.show(document.body,r),e.append('<certify:ExportCertDialog name="'.concat(n,'"></certify:ExportCertDialog>'));var i=t.exportCertDialog=e.getComponentByName(n);return i.show(document.body,r),i}))}))}},{key:"registerPlaceSigStateHandler",value:function(e){e.getStateHandlerManager().register(x(e))}},{key:"init",value:function(t){var n=this;this.pdfUI=t,t.getRootComponent().then((function(i){var r,o,a=n;i.on("lazy-content",(r=function(e){var n;return b(this,(function(i){return"fv--protect-tab-paddle"==e.name&&(t.getComponentByName("sign-group").then((function(e){e.insertTemplate(C()(),1,[{target:"sign-document",config:{callback:function(){t.customs.sendGAEvent({eventKey:"sign_document",label:"protect_tab"}),t.getCurrentPDFDoc().then((function(e){var n=e.PDFForm.fields.filter((function(e){return 7==e.getType()&&!e.isSigned()}));n.length>1?pdfui.confirm({message:"SignDoc:moreSigns",level:"prompt"}).then((function(e){t.signatureClick(n[0].controls[0])})):t.signatureClick(n[0].controls[0])}))}}},{target:"place-signature",config:{callback:function(){t.customs.sendGAEvent({eventKey:"place_signature",label:"protect_tab"}),t.getStateHandlerManager().then((function(e){"hand"===e.get("createRect").getStateName()&&e.register(x(e.pdfViewer)),e.switchTo("createRect",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.signDocWithoutAnnot.apply(a,v(t))}))}))}}},{target:"certify-with-sig",config:{callback:function(){return a.onCertifyWithSig()}}},{target:"certify-without-sig",config:{callback:function(){return a.onCertifyWithoutSig()}}},{target:"trust-certs",config:{callback:function(){return a.onShowTrusts()}}}]),t.getCurrentPDFDoc().then((function(n){n&&(a.signDocBtn=e.getComponentByName("sign-document"),a.placeSigBtn=e.getComponentByName("place-signature"),a.certifyVisibleSig=e.getComponentByName("certify-with-sig"),a.certifyInvisibleSig=e.getComponentByName("certify-without-sig"),t.customs.proxyComponent(e.getComponentByName("digital-ids-btn")),a.updateButton(n))}))})),t.addViewerEventListener((c(n={},m.UIEvents.willCloseDocument,(function(){t.pdfViewer.getDeprecatedStorage().setItem("SignSetting",{})})),c(n,m.UIEvents.renderFileSuccess,(function(e){a.updateButton(e)})),c(n,"fieldAdded",(function(e){return a.updateButton(e.doc)})),c(n,"annotation-add",(function(e,t){return a.updateButton(t.doc)})),n))),[2]}))},o=function(){var t=this,n=arguments;return new Promise((function(i,o){var a=r.apply(t,n);function c(t){e(a,i,o,c,s,"next",t)}function s(t){e(a,i,o,c,s,"throw",t)}c(void 0)}))},function(e){return o.apply(this,arguments)}))}))}},{key:"receiveAction",value:function(e,t){var n=f(t,5),i=n[0],r=n[1],o=n[2],a=n[3],c=n[4];if("signMultipleFiles"===e)return Promise.all(o.map((function(e){var t=e.pdfDoc;return t.loadPDFForm().then((function(){var n=i.fieldName;return n&&!t.PDFForm.getField(n)?{msg:"NoSignature",error:1,name:e.file.name}:i.pageIndex<0||i.pageIndex>=t.getPageCount()?{msg:"NoPage",error:1,name:e.file.name}:("certifyInvisibleSig"==c&&(i.rect={left:0,right:0,top:0,bottom:0},i.noCheckRect=1),t.sign(i,i.sign,r).then((function(e){var n=t.getFileName()||"";return n.length<1&&(n="untitled.pdf"),n=n.toLowerCase(),"string"==typeof e?{msg:e,error:1,name:n}:(2==a.namingType&&(n=a.insertBefore+n.replace(".pdf",a.insertAfter+".pdf")),{file:e,name:n,error:0})})))}))}))).then((function(e){return o.map((function(e){return e.pdfDoc.destroy()})),e}))}},{key:"fragments",value:function(){return[]}},{key:"onCertifyWithSig",value:function(){var e=this;this.pdfUI.getStateHandlerManager().then((function(t){var n=e;"hand"===t.get("createRect").getStateName()&&t.register(x(t.pdfViewer)),t.switchTo("createRect",(function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n.signDocWithoutAnnot.apply(n,v(t).concat(["certifyVisibleSig"]))}))}))}},{key:"onCertifyWithoutSig",value:function(){var e=this;this.pdfUI.getPDFDocRender().then((function(t){e.signDocWithoutAnnot(t.getCurrentPageIndex(),{left:0,right:0,top:0,bottom:0},{destroy:function(){}},"certifyInvisibleSig")}))}},{key:"onShowTrusts",value:function(e){var t,n=this,i=this.pdfUI,r=m.toolkit.CertUtil;if(this.trustCertsDialog)return this.trustCertsDialog.show(document.body),e&&e(),Promise.resolve(this.trustCertsDialog);i.loading().then((function(e){return t=e,r.getTrustedCertificateList(n.pdfUI)})).then((function(){t.hide();var r="trustCertsDialog";m.modular.module("certify").registerComponent(V),i.registerDialog(r,(function(){return i.getComponentByName("template-container").then((function(e){e.append('<certify:TrustCertsDialog name="'.concat(r,'"></certify:TrustCertsDialog>'));var t=n.trustCertsDialog=e.getComponentByName(r);return t.open(document.body),t}))})),i.openDialog(r),e&&e()}))}}],[{key:"getName",value:function(){return"SignDoc"}},{key:"getLoader",value:function(){return D()}}]),r}(m.UIXAddon)})(),r=r.default})()));